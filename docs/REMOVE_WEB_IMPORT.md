# Saber-Translator å‘ç‰ˆæµç¨‹

æœ¬æ–‡æ¡£æè¿°äº†å¦‚ä½•ä½¿ç”¨ GitHub Actions è‡ªåŠ¨åŒ–æ„å»ºå’Œå‘å¸ƒæ–°ç‰ˆæœ¬ã€‚

## åˆ†æ”¯ç­–ç•¥

| åˆ†æ”¯ | ç”¨é€” |
|------|------|
| `main` | å¼€å‘åˆ†æ”¯ï¼ŒåŒ…å«å®Œæ•´åŠŸèƒ½ï¼ˆåŒ…æ‹¬ç½‘é¡µå¯¼å…¥ç­‰ï¼‰ |
| `release` | å‘å¸ƒåˆ†æ”¯ï¼Œç²¾ç®€ç‰ˆï¼ˆå·²åˆ é™¤ç½‘é¡µå¯¼å…¥åŠŸèƒ½ï¼‰ |

## å‘ç‰ˆæµç¨‹æ¦‚è¿°

```
main åˆ†æ”¯ï¼ˆå¼€å‘ï¼‰
    â”‚
    â”‚ å¼€å‘å®Œæˆï¼Œæäº¤æ¨é€
    â†“
release åˆ†æ”¯ï¼ˆå‘å¸ƒï¼‰
    â”‚
    â”‚ åˆå¹¶ mainï¼Œå¤„ç†å†²çªï¼Œæ„å»ºå‰ç«¯
    â†“
æ‰“ Tagï¼ˆå¦‚ v3.4.0ï¼‰
    â”‚
    â†“
CI è‡ªåŠ¨æ„å»ºï¼ˆçº¦ 1-2 å°æ—¶ï¼‰
    â”‚
    â”‚ CPU ç‰ˆæœ¬ âœ…
    â”‚ GPU ç‰ˆæœ¬ âœ…
    â”‚ æ¨¡å‹æ–‡ä»¶ âœ…
    â†“
Draft Release åˆ›å»ºå®Œæˆ
    â”‚
    â”‚ ç¼–è¾‘æ›´æ–°æ—¥å¿—
    â†“
ç‚¹å‡» Publish â†’ å‘å¸ƒå®Œæˆ ğŸ‰
```

---

## è¯¦ç»†æ“ä½œæ­¥éª¤

### æ­¥éª¤ 1ï¼šåœ¨ main åˆ†æ”¯å®Œæˆå¼€å‘

ç¡®ä¿æ‰€æœ‰æ›´æ”¹å·²æäº¤å¹¶æ¨é€åˆ° main åˆ†æ”¯ï¼š

```bash
git checkout main
git add .
git commit -m "feat: æ–°åŠŸèƒ½æè¿°"
git push Saber-Translator main
```

**VS Code æ“ä½œ**ï¼š
1. åœ¨æºä»£ç ç®¡ç†é¢æ¿å¡«å†™æäº¤ä¿¡æ¯
2. ç‚¹å‡» âœ“ æäº¤
3. ç‚¹å‡»åŒæ­¥/æ¨é€

---

### æ­¥éª¤ 2ï¼šåˆ‡æ¢åˆ° release åˆ†æ”¯

```bash
git checkout release
```

**VS Code æ“ä½œ**ï¼šç‚¹å‡»å·¦ä¸‹è§’åˆ†æ”¯å â†’ é€‰æ‹© `release`

---

### æ­¥éª¤ 3ï¼šè®© release å®Œå…¨åŒæ­¥åˆ° main

**ä½¿ç”¨ç¡¬é‡ç½®**ï¼Œè®© release åˆ†æ”¯å®Œå…¨å˜æˆ main çš„çŠ¶æ€ï¼ˆåŒ…å«ç½‘é¡µå¯¼å…¥åŠŸèƒ½ï¼‰ï¼š

```bash
# å®Œå…¨é‡ç½®ä¸º main çš„çŠ¶æ€
git reset --hard main

# å¼ºåˆ¶æ¨é€ï¼ˆå› ä¸ºæ˜¯é‡ç½®ï¼Œéœ€è¦ -fï¼‰
git push -f Saber-Translator release
```

**VS Code æ“ä½œ**ï¼š
1. æ‰“å¼€ç»ˆç«¯ï¼ˆ`` Ctrl + ` ``ï¼‰
2. æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤

**å®Œæˆå release åˆ†æ”¯å°±å’Œ main å®Œå…¨ä¸€æ ·äº†ã€‚**

---

### æ­¥éª¤ 4ï¼šæ‰‹åŠ¨åˆ é™¤ç½‘é¡µå¯¼å…¥åŠŸèƒ½

åˆ é™¤ä»¥ä¸‹æ–‡ä»¶/ä»£ç ï¼š

**åç«¯æ–‡ä»¶**ï¼š
- `src/app/api/web_import_api.py`

**å‰ç«¯æ–‡ä»¶**ï¼š
- `vue-frontend/src/api/webImport.ts`
- `vue-frontend/src/views/WebImportView.vue`
- `vue-frontend/src/stores/webImport.ts`

**å‰ç«¯è·¯ç”±å’Œå¯¼èˆª**ï¼š
- ç¼–è¾‘ `vue-frontend/src/router/index.ts`ï¼Œåˆ é™¤ç½‘é¡µå¯¼å…¥è·¯ç”±
- ç¼–è¾‘å¯¼èˆªèœå•ç»„ä»¶ï¼Œåˆ é™¤ç½‘é¡µå¯¼å…¥èœå•é¡¹

---

### æ­¥éª¤ 5ï¼šæ„å»ºå‰ç«¯ï¼ˆå¦‚æœ‰å‰ç«¯æ›´æ”¹ï¼‰

```bash
cd vue-frontend
npm run build
cd ..
```

æ„å»ºè¾“å‡ºä¼šè‡ªåŠ¨æ”¾åˆ° `src/app/static/vue/` ç›®å½•ã€‚

---

### æ­¥éª¤ 6ï¼šæäº¤åˆ é™¤ç½‘é¡µå¯¼å…¥çš„æ›´æ”¹

```bash
git add .
git commit -m "remove web import feature for v3.4.0"
git push Saber-Translator release
```

**VS Code æ“ä½œ**ï¼š
1. åœ¨æºä»£ç ç®¡ç†é¢æ¿å¡«å†™æäº¤ä¿¡æ¯
2. ç‚¹å‡» âœ“ æäº¤
3. ç‚¹å‡»åŒæ­¥/æ¨é€

---

### æ­¥éª¤ 7ï¼šåˆ›å»ºå¹¶æ¨é€ Tag

```bash
git tag v3.4.0
git push Saber-Translator v3.4.0
```

**VS Code æ“ä½œ**ï¼š
1. æŒ‰ `Ctrl + Shift + P` â†’ è¾“å…¥ `create tag` â†’ é€‰æ‹© `Git: Create Tag`
2. è¾“å…¥ç‰ˆæœ¬å·ï¼š`v3.4.0`
3. æŒ‰ `Ctrl + Shift + P` â†’ è¾“å…¥ `push tags` â†’ é€‰æ‹© `Git: Push Tags`

---

### æ­¥éª¤ 8ï¼šç­‰å¾… CI å®Œæˆ

1. æ‰“å¼€ GitHub Actions é¡µé¢ï¼šhttps://github.com/MashiroSaber03/Saber-Translator/actions
2. æŸ¥çœ‹ "Build and Release" å·¥ä½œæµè¿è¡ŒçŠ¶æ€
3. ç­‰å¾…çº¦ 1-2 å°æ—¶ï¼ˆæœ€é«˜å‹ç¼©éœ€è¦è¾ƒé•¿æ—¶é—´ï¼‰

---

### æ­¥éª¤ 9ï¼šç¼–è¾‘å¹¶å‘å¸ƒ Release

1. æ‰“å¼€ GitHub Releases é¡µé¢ï¼šhttps://github.com/MashiroSaber03/Saber-Translator/releases
2. æ‰¾åˆ° Draft çŠ¶æ€çš„ Releaseï¼ˆå¦‚ v3.4.0ï¼‰
3. ç‚¹å‡»ç¼–è¾‘
4. åˆ é™¤æ¨¡æ¿æç¤ºï¼Œå¡«å†™æ›´æ–°æ—¥å¿—ï¼š

```markdown
## æ›´æ–°æ—¥å¿—

### âœ¨ æ–°åŠŸèƒ½
- ...

### ğŸ› Bug ä¿®å¤
- ...

### ğŸ“ å…¶ä»–
- ...

---

æ¬¢è¿åŠ å…¥ç¿»è¯‘å™¨äº¤æµç¾¤ï¼š536706173
```

5. ç‚¹å‡» **Publish release**

---

## Release æœ€ç»ˆäº§ç‰©

æ¯ä¸ªç‰ˆæœ¬çš„ Release åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `Saber-Translator-x.x.x-cpu.z01` | CPU ç‰ˆæœ¬åˆ†å· 1 |
| `Saber-Translator-x.x.x-cpu.zip` | CPU ç‰ˆæœ¬åˆ†å· 2ï¼ˆè§£å‹æ­¤æ–‡ä»¶ï¼‰ |
| `Saber-Translator-x.x.x-gpu.z01` | GPU ç‰ˆæœ¬åˆ†å· 1 |
| `Saber-Translator-x.x.x-gpu.zip` | GPU ç‰ˆæœ¬åˆ†å· 2ï¼ˆè§£å‹æ­¤æ–‡ä»¶ï¼‰ |
| `models.z01` | æ¨¡å‹æ–‡ä»¶åˆ†å· 1 |
| `models.zip` | æ¨¡å‹æ–‡ä»¶åˆ†å· 2 |

---

## ç”¨æˆ·ä¸‹è½½è¯´æ˜

### æ™®é€šç”¨æˆ·ï¼ˆå¼€ç®±å³ç”¨ï¼‰

1. ä¸‹è½½æ‰€éœ€ç‰ˆæœ¬çš„æ‰€æœ‰åˆ†å·æ–‡ä»¶ï¼ˆå¦‚ CPU ç‰ˆæœ¬çš„ `.z01` å’Œ `.zip`ï¼‰
2. å°†æ‰€æœ‰åˆ†å·æ”¾åœ¨åŒä¸€ç›®å½•
3. è§£å‹ `.zip` æ–‡ä»¶ï¼ˆä¼šè‡ªåŠ¨åˆå¹¶åˆ†å·ï¼‰
4. è¿è¡Œ `Saber-Translator.exe`

### æºç éƒ¨ç½²ç”¨æˆ·

1. å…‹éš†ä»£ç ä»“åº“
2. ä¸‹è½½ `models.z01` å’Œ `models.zip`
3. è§£å‹åˆ°é¡¹ç›®æ ¹ç›®å½•çš„ `models/` æ–‡ä»¶å¤¹
4. å®‰è£…ä¾èµ–å¹¶è¿è¡Œ

---

## å¸¸è§é—®é¢˜

### Q: åˆå¹¶å†²çªå¤ªå¤šæ€ä¹ˆåŠï¼Ÿ

å¦‚æœå†²çªå¾ˆå¤šï¼Œå¯ä»¥è€ƒè™‘ï¼š
1. ä½¿ç”¨ `git checkout --theirs <file>` æ¥å— main çš„æ›´æ”¹
2. ä½¿ç”¨ `git checkout --ours <file>` ä¿æŒ release çš„æ›´æ”¹
3. æ‰‹åŠ¨é€ä¸ªå¤„ç†é‡è¦æ–‡ä»¶

### Q: CI æ„å»ºå¤±è´¥æ€ä¹ˆåŠï¼Ÿ

1. æŸ¥çœ‹ GitHub Actions æ—¥å¿—ï¼Œæ‰¾åˆ°é”™è¯¯ä¿¡æ¯
2. å¸¸è§é—®é¢˜ï¼š
   - ç¼–ç é—®é¢˜ï¼šç¡®ä¿ `app.spec` ä¸­æ²¡æœ‰ä¸­æ–‡ print è¯­å¥
   - ä¾èµ–é—®é¢˜ï¼šæ£€æŸ¥ `requirements-cpu.txt` å’Œ `requirements-gpu.txt`
3. ä¿®å¤åé‡æ–°æ¨é€ï¼Œåˆ é™¤æ—§ tag å¹¶é‡æ–°åˆ›å»º

### Q: å¦‚ä½•åˆ é™¤å¹¶é‡æ–°åˆ›å»º Tagï¼Ÿ

```bash
# åˆ é™¤è¿œç¨‹ tag
git push Saber-Translator --delete v3.4.0

# åˆ é™¤æœ¬åœ° tag
git tag -d v3.4.0

# é‡æ–°åˆ›å»ºå¹¶æ¨é€
git tag v3.4.0
git push Saber-Translator v3.4.0
```

### Q: æ¨¡å‹æ–‡ä»¶æ›´æ–°äº†æ€ä¹ˆåŠï¼Ÿ

1. å°†æ–°çš„æ¨¡å‹æ–‡ä»¶å‹ç¼©ä¸ºåˆ†å·ï¼ˆ`models.z01` å’Œ `models.zip`ï¼‰
2. æ›´æ–° `models-storage` Release ä¸­çš„æ–‡ä»¶
3. æ–°ç‰ˆæœ¬æ„å»ºæ—¶ä¼šè‡ªåŠ¨ä½¿ç”¨æœ€æ–°æ¨¡å‹

---

## ç‰ˆæœ¬å·è§„èŒƒ

- æ ¼å¼ï¼š`vX.Y.Z`ï¼ˆå¦‚ `v3.4.0`ï¼‰
- Xï¼šä¸»ç‰ˆæœ¬å·ï¼ˆé‡å¤§æ›´æ–°ï¼‰
- Yï¼šæ¬¡ç‰ˆæœ¬å·ï¼ˆæ–°åŠŸèƒ½ï¼‰
- Zï¼šä¿®è®¢å·ï¼ˆBug ä¿®å¤ï¼‰
- é¢„å‘å¸ƒï¼š`v3.4.0-beta`ã€`v3.4.0-rc1`

---

## ç›¸å…³é“¾æ¥

- GitHub ä»“åº“ï¼šhttps://github.com/MashiroSaber03/Saber-Translator
- Actionsï¼šhttps://github.com/MashiroSaber03/Saber-Translator/actions
- Releasesï¼šhttps://github.com/MashiroSaber03/Saber-Translator/releases
