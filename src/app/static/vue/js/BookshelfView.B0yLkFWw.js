const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/bookshelf.CDzdK045.js","js/client.Bht704G-.js","js/utils-vendor.B9ygI19o.js"])))=>i.map(i=>d[i]);
import{_ as X,s as r,a as $e}from"./index.71kVCBu7.js";import{u as le,_ as xe}from"./bookshelfStore.fm3KUtmx.js";import{a as Y,c as L,i as u,h as s,n as ue,v as E,e,k as se,t as M,F as Q,j,x as Z,r as p,y as G,z as W,A as ae,l as fe,b as N,w as re,B as ne,g as me,C as Be,D as De,o as Te,f as we,E as Ie,u as _e}from"./vue-vendor.BU3zOQRA.js";import"./client.Bht704G-.js";import{g as Ee}from"./system.CmjDD-4C.js";import{B as Me}from"./BaseModal._UcugYoc.js";import{getBookDetail as Ae}from"./bookshelf.CDzdK045.js";import"./utils-vendor.B9ygI19o.js";const Se="/static/vue/pic/github.jpg",Le=["checked"],Re={class:"book-cover"},Ve=["src","alt"],qe={key:1,class:"book-cover-placeholder"},Ue={class:"book-info"},Fe=["title"],Oe={class:"book-chapter-count"},ze={key:0,class:"book-tags"},Ne=Y({__name:"BookCard",props:{book:{},selected:{type:Boolean,default:!1},batchMode:{type:Boolean,default:!1}},emits:["click","edit","select","contextMenu"],setup($,{emit:q}){const a=$,k=q,v=le(),y=L(()=>v.tags);function b(){a.batchMode?k("select"):k("click")}function f(i){i.preventDefault(),k("contextMenu",i)}function l(i){return y.value.find(w=>w.name===i)?.color||"#667eea"}function x(){return!!a.book.cover&&a.book.cover.length>0}function A(i){const C=i.target;if(C.parentElement){C.style.display="none";const w=document.createElement("div");w.className="book-cover-placeholder",w.textContent="ğŸ“–",C.parentElement.appendChild(w)}}return(i,C)=>(s(),u("div",{class:ue(["book-card",{selected:$.selected,"batch-mode":$.batchMode}]),onClick:b,onContextmenu:f},[$.batchMode?(s(),u("div",{key:0,class:"book-checkbox",onClick:C[2]||(C[2]=se(w=>k("select"),["stop"]))},[e("input",{type:"checkbox",checked:$.selected,onClick:C[0]||(C[0]=se(()=>{},["stop"])),onChange:C[1]||(C[1]=w=>k("select"))},null,40,Le)])):E("",!0),e("div",Re,[x()?(s(),u("img",{key:0,src:$.book.cover,alt:$.book.title,onError:A},null,40,Ve)):(s(),u("div",qe,"ğŸ“–"))]),e("div",Ue,[e("h3",{class:"book-title",title:$.book.title},M($.book.title),9,Fe),e("p",Oe,M($.book.chapter_count||$.book.chapters?.length||0)+" ç« èŠ‚",1),$.book.tags&&$.book.tags.length>0?(s(),u("div",ze,[(s(!0),u(Q,null,j($.book.tags,w=>(s(),u("span",{key:w,class:"book-tag",style:Z({background:l(w)})},M(w),5))),128))])):E("",!0)])],34))}}),Pe=X(Ne,[["__scopeId","data-v-a50985d9"]]),Ke={class:"filter-bar"},Qe={class:"search-box"},je={key:0,class:"tag-filter"},Ge={class:"tag-chips"},We=["onClick"],He=Y({__name:"BookSearch",props:{tags:{}},emits:["search","filterTag"],setup($,{emit:q}){const a=q,k=le(),v=p(""),y=L(()=>v.value.length>0);function b(){a("search",v.value)}function f(){v.value="",a("search","")}let l;function x(){clearTimeout(l),l=setTimeout(()=>{b()},300)}function A(C){a("filterTag",C)}function i(C){return k.selectedTagIds.includes(C)}return(C,w)=>(s(),u("div",Ke,[e("div",Qe,[G(e("input",{"onUpdate:modelValue":w[0]||(w[0]=I=>v.value=I),type:"text",placeholder:"æœç´¢ä¹¦ç±åç§°æˆ–æ ‡ç­¾...",autocomplete:"off",onInput:x,onKeypress:ae(b,["enter"])},null,544),[[W,v.value]]),e("button",{class:"search-btn",onClick:b},"ğŸ”"),y.value?(s(),u("button",{key:0,class:"clear-search-btn",onClick:f}," âœ• ")):E("",!0)]),$.tags.length>0?(s(),u("div",je,[w[1]||(w[1]=e("span",{class:"filter-label"},"æ ‡ç­¾ç­›é€‰:",-1)),e("div",Ge,[(s(!0),u(Q,null,j($.tags,I=>(s(),u("span",{key:I.id,class:ue(["tag-chip",{active:i(I.name)}]),style:Z(I.color?{"--tag-color":I.color,backgroundColor:i(I.name)?I.color:""}:{}),onClick:D=>A(I.name)},M(I.name),15,We))),128))])])):E("",!0)]))}}),Xe=X(He,[["__scopeId","data-v-dd828b80"]]),Ye={class:"form-group"},Je={class:"form-group"},Ze={class:"cover-preview"},et=["src"],tt={key:1,class:"cover-placeholder"},ot={class:"form-group"},st={class:"tag-input-container"},nt={class:"selected-tags"},at=["onClick"],lt={class:"tag-dropdown"},it=["onKeypress"],rt={key:0,class:"tag-suggestions"},ut=["onClick"],ct=Y({__name:"BookModal",props:{bookId:{default:null}},emits:["close","saved"],setup($,{emit:q}){const a=$,k=q,v=le(),y=p(""),b=p(null),f=p([]),l=p(""),x=p(!1),A=L(()=>!!a.bookId),i=L(()=>A.value?"ç¼–è¾‘ä¹¦ç±":"æ–°å»ºä¹¦ç±"),C=L(()=>v.tags),w=L(()=>{if(!l.value)return C.value;const h=l.value.toLowerCase();return C.value.filter(c=>c.name.toLowerCase().includes(h)&&!f.value.includes(c.id))});fe(()=>{if(a.bookId){const h=v.books.find(c=>c.id===a.bookId);h&&(y.value=h.title,b.value=h.cover||null,h.tags&&h.tags.length>0&&(f.value=h.tags.map(c=>C.value.find(F=>F.name===c)?.id).filter(c=>!!c)))}});function I(h){const g=h.target.files?.[0];if(!g)return;if(!g.type.startsWith("image/")){r("è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶","error");return}const F=new FileReader;F.onload=te=>{b.value=te.target?.result},F.readAsDataURL(g)}function D(h){h.preventDefault();const c=h.dataTransfer?.files[0];if(!c||!c.type.startsWith("image/"))return;const g=new FileReader;g.onload=F=>{b.value=F.target?.result},g.readAsDataURL(c)}function B(h){f.value.includes(h)||f.value.push(h),l.value="",x.value=!1}async function _(){const h=l.value.trim();if(!h)return;const c=C.value.find(g=>g.name===h);if(c){B(c.id);return}try{const g=await v.createTag(h);g&&B(g.id)}catch{r("åˆ›å»ºæ ‡ç­¾å¤±è´¥","error")}}function O(h){f.value=f.value.filter(c=>c!==h)}function ee(h){return C.value.find(g=>g.id===h)?.name||h}async function J(){if(!y.value.trim()){r("è¯·è¾“å…¥ä¹¦ç±åç§°","warning");return}const h=f.value.map(c=>ee(c));try{A.value&&a.bookId?await v.updateBookApi(a.bookId,{title:y.value.trim(),cover:b.value||void 0})?(v.updateBook(a.bookId,{tags:h}),r("ä¹¦ç±æ›´æ–°æˆåŠŸ","success"),k("saved")):r("æ›´æ–°å¤±è´¥","error"):await v.createBook(y.value.trim(),void 0,b.value||void 0,h.length>0?h:void 0)?(r("ä¹¦ç±åˆ›å»ºæˆåŠŸ","success"),k("saved")):r("åˆ›å»ºå¤±è´¥","error")}catch{r(A.value?"æ›´æ–°å¤±è´¥":"åˆ›å»ºå¤±è´¥","error")}}return(h,c)=>(s(),N(Me,{title:i.value,onClose:c[6]||(c[6]=g=>k("close"))},{footer:re(()=>[e("button",{type:"button",class:"btn btn-secondary",onClick:c[5]||(c[5]=g=>k("close"))},"å–æ¶ˆ"),e("button",{type:"button",class:"btn btn-primary",onClick:J},"ä¿å­˜")]),default:re(()=>[e("form",{onSubmit:se(J,["prevent"])},[e("div",Ye,[c[7]||(c[7]=e("label",{for:"bookTitle"},[ne("ä¹¦ç±åç§° "),e("span",{class:"required"},"*")],-1)),G(e("input",{id:"bookTitle","onUpdate:modelValue":c[0]||(c[0]=g=>y.value=g),type:"text",placeholder:"è¯·è¾“å…¥ä¹¦ç±åç§°",required:""},null,512),[[W,y.value]])]),e("div",Je,[c[9]||(c[9]=e("label",null,"å°é¢å›¾ç‰‡",-1)),e("div",{class:"cover-upload-area",onDragover:c[1]||(c[1]=se(()=>{},["prevent"])),onDrop:D,onClick:c[2]||(c[2]=g=>h.$refs.coverInput.click())},[e("input",{ref:"coverInput",type:"file",accept:"image/*",hidden:"",onChange:I},null,544),e("div",Ze,[b.value?(s(),u("img",{key:0,src:b.value,alt:"å°é¢é¢„è§ˆ"},null,8,et)):(s(),u("div",tt,[...c[8]||(c[8]=[e("span",{class:"upload-icon"},"ğŸ“·",-1),e("span",null,"ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ å°é¢",-1)])]))])],32),c[10]||(c[10]=e("p",{class:"form-hint"},"æ”¯æŒ JPGã€PNGã€WebP æ ¼å¼ï¼Œå»ºè®®æ¯”ä¾‹ 3:4",-1))]),e("div",ot,[c[11]||(c[11]=e("label",null,"æ ‡ç­¾",-1)),e("div",st,[e("div",nt,[(s(!0),u(Q,null,j(f.value,g=>(s(),u("span",{key:g,class:"selected-tag"},[ne(M(ee(g))+" ",1),e("button",{type:"button",class:"remove-tag",onClick:F=>O(g)},"Ã—",8,at)]))),128))]),e("div",lt,[G(e("input",{"onUpdate:modelValue":c[3]||(c[3]=g=>l.value=g),type:"text",placeholder:"è¾“å…¥æ ‡ç­¾åç§°...",autocomplete:"off",onFocus:c[4]||(c[4]=g=>x.value=!0),onKeypress:ae(se(_,["prevent"]),["enter"])},null,40,it),[[W,l.value]]),x.value&&w.value.length>0?(s(),u("div",rt,[(s(!0),u(Q,null,j(w.value,g=>(s(),u("button",{key:g.id,type:"button",class:"tag-suggestion",onClick:F=>B(g.id)},M(g.name),9,ut))),128))])):E("",!0)])]),c[12]||(c[12]=e("p",{class:"form-hint"},"è¾“å…¥åæŒ‰å›è½¦æ·»åŠ æ–°æ ‡ç­¾ï¼Œæˆ–ä»å·²æœ‰æ ‡ç­¾ä¸­é€‰æ‹©",-1))])],32)]),_:1},8,["title"]))}}),dt=X(ct,[["__scopeId","data-v-087929e9"]]),vt={class:"modal active"},mt={class:"modal-content modal-large"},ft={class:"modal-header"},pt={class:"modal-body"},kt={key:0,class:"book-detail-container"},bt={class:"book-info-section"},gt={class:"book-cover-large"},ht=["src"],yt={key:1,class:"book-cover-placeholder"},Ct={class:"book-meta"},_t={class:"meta-item"},$t={key:0,class:"detail-tags"},Tt=["onClick"],wt={key:1,class:"no-tags-hint"},Bt={class:"meta-item"},Mt={class:"meta-item"},xt={class:"meta-item"},Dt={class:"chapters-section"},It={key:0,class:"chapters-list"},Et=["onDragstart","onDragover","onDrop"],At={class:"chapter-info"},St={class:"chapter-order"},Lt={class:"chapter-title"},Rt={class:"chapter-meta"},Vt={class:"chapter-actions"},qt=["onClick"],Ut=["disabled","onClick"],Ft=["onClick"],Ot=["onClick"],zt={key:1,class:"empty-state-small"},Nt={key:0,class:"modal active"},Pt={class:"modal-content modal-small"},Kt={class:"modal-header"},Qt={class:"modal-body"},jt={class:"form-group"},Gt={class:"modal-footer"},Wt={key:0,class:"modal active"},Ht={class:"modal-content modal-small"},Xt={class:"modal-body"},Yt={class:"quick-tag-input-wrapper"},Jt={class:"quick-tag-list"},Zt=["onClick"],eo={class:"quick-tag-name"},to={key:1,class:"no-tags-hint"},oo={key:0,class:"modal active"},so={class:"modal-content modal-small"},no={class:"modal-header"},ao={class:"modal-body"},lo={class:"modal-footer"},io=Y({__name:"BookDetailModal",emits:["close","edit"],setup($,{emit:q}){const a=q,k=Be(),v=le(),y=p(!1),b=p(null),f=p(""),l=p(!1),x=p("book"),A=p(null),i=L(()=>v.currentBook),C=L(()=>i.value?.chapters||[]),w=L(()=>v.tags);function I(n){return n?new Date(n).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}function D(n){return w.value.find(d=>d.name===n)?.color||"#667eea"}function B(){i.value&&(a("edit",i.value.id),a("close"))}function _(){x.value="book",l.value=!0}async function O(){try{x.value==="book"&&i.value?await v.deleteBookApi(i.value.id)?(r("ä¹¦ç±å·²åˆ é™¤","success"),a("close")):r("åˆ é™¤å¤±è´¥","error"):x.value==="chapter"&&A.value&&i.value&&(await v.deleteChapterApi(i.value.id,A.value)?r("ç« èŠ‚å·²åˆ é™¤","success"):r("åˆ é™¤å¤±è´¥","error"))}catch{r("åˆ é™¤å¤±è´¥","error")}l.value=!1,A.value=null}function ee(){b.value=null,f.value="",y.value=!0}function J(n){const t=C.value.find(d=>d.id===n);t&&(b.value=n,f.value=t.title,y.value=!0)}async function h(){if(!f.value.trim()||!i.value){r("è¯·è¾“å…¥ç« èŠ‚åç§°","warning");return}try{b.value?await v.updateChapterApi(i.value.id,b.value,f.value.trim())?(r("ç« èŠ‚æ›´æ–°æˆåŠŸ","success"),y.value=!1):r("æ›´æ–°å¤±è´¥","error"):await v.createChapterApi(i.value.id,f.value.trim())?(r("ç« èŠ‚åˆ›å»ºæˆåŠŸ","success"),y.value=!1):r("åˆ›å»ºå¤±è´¥","error")}catch{r("ä¿å­˜å¤±è´¥","error")}}function c(n){x.value="chapter",A.value=n,l.value=!0}function g(n){i.value&&k.push({path:"/translate",query:{book:i.value.id,chapter:n}})}function F(n){i.value&&k.push({path:"/reader",query:{book:i.value.id,chapter:n}})}function te(){i.value&&k.push({path:"/insight",query:{book:i.value.id}})}async function ce(n){if(!i.value)return!1;try{return await v.reorderChaptersApi(i.value.id,n)?(r("ç« èŠ‚æ’åºå·²æ›´æ–°","success"),!0):(r("æ’åºä¿å­˜å¤±è´¥","error"),await oe(),!1)}catch{return r("æ’åºä¿å­˜å¤±è´¥","error"),await oe(),!1}}async function oe(){if(i.value)try{const n=await Ae(i.value.id);n.success&&n.book&&v.updateBook(i.value.id,n.book)}catch(n){console.error("åˆ·æ–°ä¹¦ç±è¯¦æƒ…å¤±è´¥:",n)}}const P=p(null),H=p(null);function pe(n,t){P.value=t,n.dataTransfer&&(n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/plain",t.toString()))}function ke(n,t){n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect="move"),H.value=t}function be(){H.value=null}async function ge(n,t){if(n.preventDefault(),P.value===null||P.value===t||!i.value){P.value=null,H.value=null;return}const d=[...C.value],[U]=d.splice(P.value,1);if(!U)return;d.splice(t,0,U);const V=d.map(Ce=>Ce.id);await ce(V),P.value=null,H.value=null}function he(){P.value=null,H.value=null}const K=p(!1),S=p(""),R=p(null),de=L(()=>{const n=i.value?.tags||[],t=S.value.trim().toLowerCase();return w.value.filter(d=>!n.includes(d.name)&&(t===""||d.name.toLowerCase().includes(t)))}),ve=L(()=>{const n=S.value.trim();return n?!w.value.some(t=>t.name.toLowerCase()===n.toLowerCase()):!1});function ye(){S.value="",K.value=!0,De(()=>{R.value?.focus()})}function ie(){K.value=!1,S.value=""}async function m(){const n=S.value.trim();n&&(await T(n),S.value="")}const o=p(!1);async function z(n){if(!(!i.value||o.value)){o.value=!0;try{const{batchRemoveTags:t}=await $e(async()=>{const{batchRemoveTags:U}=await import("./bookshelf.CDzdK045.js");return{batchRemoveTags:U}},__vite__mapDeps([0,1,2]));(await t([i.value.id],[n])).success?(v.removeTagFromBook(i.value.id,n),r("æ ‡ç­¾å·²ç§»é™¤","success")):r("ç§»é™¤æ ‡ç­¾å¤±è´¥","error")}catch(t){r("æ“ä½œå¤±è´¥","error"),console.error("ç§»é™¤æ ‡ç­¾å¤±è´¥:",t)}finally{o.value=!1}}}async function T(n){if(!(!i.value||!n||o.value)){if(i.value.tags?.includes(n)){r("è¯¥æ ‡ç­¾å·²å­˜åœ¨","info");return}o.value=!0;try{const{createTag:t,batchAddTags:d}=await $e(async()=>{const{createTag:V,batchAddTags:Ce}=await import("./bookshelf.CDzdK045.js");return{createTag:V,batchAddTags:Ce}},__vite__mapDeps([0,1,2]));if(!w.value.some(V=>V.name===n))if((await t(n)).success)await v.loadTags();else{r("åˆ›å»ºæ ‡ç­¾å¤±è´¥","error");return}(await d([i.value.id],[n])).success?(v.addTagToBook(i.value.id,n),r("æ ‡ç­¾å·²æ·»åŠ ","success"),await v.loadBooks()):r("æ·»åŠ æ ‡ç­¾å¤±è´¥","error")}catch(t){r("æ“ä½œå¤±è´¥","error"),console.error("å¿«é€Ÿæ·»åŠ æ ‡ç­¾å¤±è´¥:",t)}finally{o.value=!1}}}return(n,t)=>(s(),u(Q,null,[e("div",vt,[e("div",{class:"modal-overlay",onClick:t[0]||(t[0]=d=>a("close"))}),e("div",mt,[e("div",ft,[t[11]||(t[11]=e("h2",null,"ä¹¦ç±è¯¦æƒ…",-1)),e("button",{class:"modal-close",onClick:t[1]||(t[1]=d=>a("close"))},"Ã—")]),e("div",pt,[i.value?(s(),u("div",kt,[e("div",bt,[e("div",gt,[i.value.cover?(s(),u("img",{key:0,src:i.value.cover,alt:"å°é¢"},null,8,ht)):(s(),u("div",yt,"ğŸ“–"))]),e("div",Ct,[e("h3",null,M(i.value.title),1),e("p",_t,[t[12]||(t[12]=e("span",null,"æ ‡ç­¾ï¼š",-1)),i.value.tags&&i.value.tags.length>0?(s(),u("span",$t,[(s(!0),u(Q,null,j(i.value.tags,d=>(s(),u("span",{key:d,class:"detail-tag",style:Z({background:D(d)})},[ne(M(d)+" ",1),e("span",{class:"remove-detail-tag",onClick:se(U=>z(d),["stop"])},"Ã—",8,Tt)],4))),128))])):(s(),u("span",wt,"æš‚æ— æ ‡ç­¾")),e("button",{class:"btn-add-tag",title:"æ·»åŠ æ ‡ç­¾",onClick:ye},"+")]),e("p",Bt,[t[13]||(t[13]=e("span",null,"ç« èŠ‚æ•°ï¼š",-1)),e("span",null,M(C.value.length),1)]),e("p",Mt,[t[14]||(t[14]=e("span",null,"åˆ›å»ºæ—¶é—´ï¼š",-1)),e("span",null,M(I(i.value.created_at||i.value.createdAt)),1)]),e("p",xt,[t[15]||(t[15]=e("span",null,"æœ€åæ›´æ–°ï¼š",-1)),e("span",null,M(I(i.value.updated_at||i.value.updatedAt)),1)]),e("div",{class:"book-actions"},[e("button",{class:"btn btn-sm btn-primary",onClick:te},"â— æ¼«ç”»åˆ†æ"),e("button",{class:"btn btn-sm btn-secondary",onClick:B},"ç¼–è¾‘ä¹¦ç±"),e("button",{class:"btn btn-sm btn-danger",onClick:_},"åˆ é™¤ä¹¦ç±")])])]),e("div",Dt,[e("div",{class:"section-header"},[t[17]||(t[17]=e("h3",null,"ç« èŠ‚åˆ—è¡¨",-1)),e("button",{class:"btn btn-sm btn-primary",onClick:ee},[...t[16]||(t[16]=[e("span",{class:"btn-icon"},"+",-1),ne(" æ–°å»ºç« èŠ‚ ",-1)])])]),C.value.length>0?(s(),u("div",It,[(s(!0),u(Q,null,j(C.value,(d,U)=>(s(),u("div",{key:d.id,class:ue(["chapter-item",{dragging:P.value===U,"drag-over":H.value===U&&P.value!==U}]),draggable:"true",onDragstart:V=>pe(V,U),onDragover:V=>ke(V,U),onDragleave:be,onDrop:V=>ge(V,U),onDragend:he},[t[18]||(t[18]=e("div",{class:"chapter-drag-handle",title:"æ‹–æ‹½æ’åº"},"â‹®â‹®",-1)),e("div",At,[e("span",St,"#"+M(U+1),1),e("span",Lt,M(d.title),1),e("span",Rt,M(d.image_count||d.imageCount||0)+" å¼ å›¾ç‰‡",1)]),e("div",Vt,[e("button",{class:"chapter-action-btn chapter-enter-btn",onClick:V=>g(d.id)}," è¿›å…¥ç¿»è¯‘ ",8,qt),e("button",{class:"chapter-action-btn chapter-read-btn",disabled:(d.image_count||d.imageCount||0)===0,onClick:V=>F(d.id)}," è¿›å…¥é˜…è¯» ",8,Ut),e("button",{class:"chapter-action-btn",onClick:V=>J(d.id)}," ç¼–è¾‘ ",8,Ft),e("button",{class:"chapter-action-btn danger",onClick:V=>c(d.id)}," åˆ é™¤ ",8,Ot)])],42,Et))),128))])):(s(),u("div",zt,[...t[19]||(t[19]=[e("p",null,"æš‚æ— ç« èŠ‚ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®åˆ›å»º",-1)])]))])])):E("",!0)])])]),(s(),N(me,{to:"body"},[y.value?(s(),u("div",Nt,[e("div",{class:"modal-overlay",onClick:t[2]||(t[2]=d=>y.value=!1)}),e("div",Pt,[e("div",Kt,[e("h2",null,M(b.value?"ç¼–è¾‘ç« èŠ‚":"æ–°å»ºç« èŠ‚"),1),e("button",{class:"modal-close",onClick:t[3]||(t[3]=d=>y.value=!1)},"Ã—")]),e("div",Qt,[e("div",jt,[t[20]||(t[20]=e("label",{for:"chapterTitleInput"},[ne("ç« èŠ‚åç§° "),e("span",{class:"required"},"*")],-1)),G(e("input",{id:"chapterTitleInput","onUpdate:modelValue":t[4]||(t[4]=d=>f.value=d),type:"text",placeholder:"ä¾‹å¦‚ï¼šç¬¬1è¯ã€åºç« ",onKeypress:ae(h,["enter"])},null,544),[[W,f.value]])])]),e("div",Gt,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[5]||(t[5]=d=>y.value=!1)},"å–æ¶ˆ"),e("button",{type:"button",class:"btn btn-primary",onClick:h},"ä¿å­˜")])])])):E("",!0)])),(s(),N(me,{to:"body"},[K.value?(s(),u("div",Wt,[e("div",{class:"modal-overlay",onClick:ie}),e("div",Ht,[e("div",{class:"modal-header"},[t[21]||(t[21]=e("h2",null,"å¿«é€Ÿæ·»åŠ æ ‡ç­¾",-1)),e("button",{class:"modal-close",onClick:ie},"Ã—")]),e("div",Xt,[e("div",Yt,[G(e("input",{ref_key:"quickTagInputRef",ref:R,"onUpdate:modelValue":t[6]||(t[6]=d=>S.value=d),type:"text",class:"quick-tag-input",placeholder:"è¾“å…¥æ ‡ç­¾åç§°è¿›è¡Œæœç´¢æˆ–åˆ›å»º...",onKeypress:ae(m,["enter"])},null,544),[[W,S.value]])]),e("div",Jt,[(s(!0),u(Q,null,j(de.value,d=>(s(),u("div",{key:d.id||d.name,class:"quick-tag-item",onClick:U=>T(d.name)},[e("span",{class:"tag-color-dot",style:Z({background:d.color||"#667eea"})},null,4),e("span",eo,M(d.name),1),t[22]||(t[22]=e("span",{class:"tag-add-icon"},"+",-1))],8,Zt))),128)),ve.value?(s(),u("div",{key:0,class:"quick-tag-item new-tag",onClick:t[7]||(t[7]=d=>T(S.value.trim()))},[t[23]||(t[23]=e("span",{class:"tag-icon"},"+",-1)),e("span",null,'åˆ›å»ºå¹¶æ·»åŠ  "'+M(S.value.trim())+'"',1)])):E("",!0),de.value.length===0&&!ve.value?(s(),u("p",to,M(S.value?"æœªæ‰¾åˆ°åŒ¹é…çš„æ ‡ç­¾":"æ‰€æœ‰æ ‡ç­¾å·²æ·»åŠ æˆ–æš‚æ— æ ‡ç­¾"),1)):E("",!0)])]),e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary",onClick:ie},"å…³é—­")])])])):E("",!0)])),(s(),N(me,{to:"body"},[l.value?(s(),u("div",oo,[e("div",{class:"modal-overlay",onClick:t[8]||(t[8]=d=>l.value=!1)}),e("div",so,[e("div",no,[t[24]||(t[24]=e("h2",null,"ç¡®è®¤åˆ é™¤",-1)),e("button",{class:"modal-close",onClick:t[9]||(t[9]=d=>l.value=!1)},"Ã—")]),e("div",ao,[e("p",null,M(x.value==="book"?"ç¡®å®šè¦åˆ é™¤è¿™æœ¬ä¹¦ç±å—ï¼Ÿæ‰€æœ‰ç« èŠ‚æ•°æ®å°†ä¸€å¹¶åˆ é™¤ï¼Œæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚":"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç« èŠ‚å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚"),1)]),e("div",lo,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[10]||(t[10]=d=>l.value=!1)},"å–æ¶ˆ"),e("button",{type:"button",class:"btn btn-danger",onClick:O},"åˆ é™¤")])])])):E("",!0)]))],64))}}),ro=X(io,[["__scopeId","data-v-fad511a8"]]),uo={class:"tag-manage-form"},co={class:"form-row"},vo={class:"tag-list"},mo={key:0,class:"empty-hint"},fo={key:0,class:"tag-view-mode"},po={class:"tag-name"},ko={class:"tag-book-count"},bo=["onClick"],go=["onClick"],ho={key:1,class:"tag-edit-mode"},yo=Y({__name:"TagManageModal",emits:["close"],setup($,{emit:q}){const a=q,k=le(),v=p(""),y=p("#667eea"),b=p(null),f=p(""),l=p(""),x=L(()=>k.tags);async function A(){const D=v.value.trim();if(!D){r("è¯·è¾“å…¥æ ‡ç­¾åç§°","warning");return}if(x.value.some(B=>B.name===D)){r("æ ‡ç­¾å·²å­˜åœ¨","warning");return}try{await k.createTag(D,y.value),r("æ ‡ç­¾åˆ›å»ºæˆåŠŸ","success"),v.value="",y.value="#667eea"}catch{r("åˆ›å»ºå¤±è´¥","error")}}function i(D){b.value=D.name,f.value=D.name,l.value=D.color||"#667eea"}function C(){b.value=null,f.value="",l.value=""}async function w(){if(!b.value)return;const D=f.value.trim();if(!D){r("æ ‡ç­¾åç§°ä¸èƒ½ä¸ºç©º","warning");return}const B=b.value;if(D!==B&&x.value.some(_=>_.name===D)){r("æ ‡ç­¾åç§°å·²å­˜åœ¨","warning");return}try{await k.updateTagApi(B,D,l.value)?(r("æ ‡ç­¾æ›´æ–°æˆåŠŸ","success"),C()):r("æ›´æ–°å¤±è´¥","error")}catch(_){r("æ›´æ–°å¤±è´¥","error"),console.error("æ›´æ–°æ ‡ç­¾å¤±è´¥:",_)}}async function I(D){try{await k.deleteTagApi(D)?r("æ ‡ç­¾å·²åˆ é™¤","success"):r("åˆ é™¤å¤±è´¥","error")}catch{r("åˆ é™¤å¤±è´¥","error")}}return(D,B)=>(s(),N(Me,{title:"æ ‡ç­¾ç®¡ç†",onClose:B[5]||(B[5]=_=>a("close"))},{footer:re(()=>[e("button",{class:"btn btn-secondary",onClick:B[4]||(B[4]=_=>a("close"))},"å…³é—­")]),default:re(()=>[e("div",uo,[e("div",co,[G(e("input",{"onUpdate:modelValue":B[0]||(B[0]=_=>v.value=_),type:"text",placeholder:"è¾“å…¥æ–°æ ‡ç­¾åç§°...",onKeypress:ae(A,["enter"])},null,544),[[W,v.value]]),G(e("input",{"onUpdate:modelValue":B[1]||(B[1]=_=>y.value=_),type:"color",title:"é€‰æ‹©é¢œè‰²"},null,512),[[W,y.value]]),e("button",{class:"btn btn-primary btn-sm",onClick:A},"æ·»åŠ ")])]),e("div",vo,[x.value.length===0?(s(),u("div",mo," æš‚æ— æ ‡ç­¾ï¼Œè¯·åœ¨ä¸Šæ–¹æ·»åŠ  ")):E("",!0),(s(!0),u(Q,null,j(x.value,_=>(s(),u("div",{key:_.name,class:"tag-manage-item"},[b.value!==_.name?(s(),u("div",fo,[e("span",{class:"tag-color-dot",style:Z({backgroundColor:_.color||"#667eea"})},null,4),e("span",po,M(_.name),1),e("span",ko,M(_.book_count||0)+" æœ¬",1),e("button",{class:"tag-edit-btn",onClick:O=>i(_)}," ç¼–è¾‘ ",8,bo),e("button",{class:"tag-delete-btn",onClick:O=>I(_.name)}," åˆ é™¤ ",8,go)])):E("",!0),b.value===_.name?(s(),u("div",ho,[G(e("input",{"onUpdate:modelValue":B[2]||(B[2]=O=>l.value=O),type:"color",class:"edit-color-input",title:"é€‰æ‹©é¢œè‰²"},null,512),[[W,l.value]]),G(e("input",{"onUpdate:modelValue":B[3]||(B[3]=O=>f.value=O),type:"text",class:"edit-name-input",placeholder:"æ ‡ç­¾åç§°",onKeypress:ae(w,["enter"])},null,544),[[W,f.value]]),e("button",{class:"tag-save-btn",onClick:w}," ä¿å­˜ "),e("button",{class:"tag-cancel-btn",onClick:C}," å–æ¶ˆ ")])):E("",!0)]))),128))])]),_:1}))}}),Co=X(yo,[["__scopeId","data-v-20ab6eb1"]]),_o=Y({__name:"BookContextMenu",props:{x:{},y:{},bookId:{}},emits:["close","openDetail","edit","delete","manageTags","enterBatchMode"],setup($,{emit:q}){const a=$,k=q,v=p(null);function y(f){v.value&&!v.value.contains(f.target)&&k("close")}function b(f){switch(f){case"detail":k("openDetail",a.bookId);break;case"edit":k("edit",a.bookId);break;case"delete":k("delete",a.bookId);break;case"tags":k("manageTags",a.bookId);break;case"batch":k("enterBatchMode");break}k("close")}return fe(()=>{setTimeout(()=>{document.addEventListener("click",y)},0)}),Te(()=>{document.removeEventListener("click",y)}),(f,l)=>(s(),u("div",{ref_key:"menuRef",ref:v,class:"context-menu",style:Z({left:`${$.x}px`,top:`${$.y}px`})},[e("button",{class:"menu-item",onClick:l[0]||(l[0]=x=>b("detail"))},[...l[5]||(l[5]=[e("span",{class:"menu-icon"},"ğŸ“–",-1),e("span",null,"æ‰“å¼€è¯¦æƒ…",-1)])]),e("button",{class:"menu-item",onClick:l[1]||(l[1]=x=>b("edit"))},[...l[6]||(l[6]=[e("span",{class:"menu-icon"},"âœï¸",-1),e("span",null,"ç¼–è¾‘ä¹¦ç±",-1)])]),e("button",{class:"menu-item",onClick:l[2]||(l[2]=x=>b("tags"))},[...l[7]||(l[7]=[e("span",{class:"menu-icon"},"ğŸ·ï¸",-1),e("span",null,"ç®¡ç†æ ‡ç­¾",-1)])]),l[10]||(l[10]=e("div",{class:"menu-divider"},null,-1)),e("button",{class:"menu-item",onClick:l[3]||(l[3]=x=>b("batch"))},[...l[8]||(l[8]=[e("span",{class:"menu-icon"},"â˜‘ï¸",-1),e("span",null,"æ‰¹é‡æ“ä½œ",-1)])]),l[11]||(l[11]=e("div",{class:"menu-divider"},null,-1)),e("button",{class:"menu-item menu-item-danger",onClick:l[4]||(l[4]=x=>b("delete"))},[...l[9]||(l[9]=[e("span",{class:"menu-icon"},"ğŸ—‘ï¸",-1),e("span",null,"åˆ é™¤ä¹¦ç±",-1)])])],4))}}),$o=X(_o,[["__scopeId","data-v-fe06f690"]]),To={class:"modal-content confirm-modal-content"},wo={class:"modal-header"},Bo={class:"modal-title"},Mo={class:"modal-body confirm-modal-body"},xo={class:"confirm-message"},Do={class:"modal-footer confirm-modal-footer"},Io=Y({__name:"ConfirmModal",props:{message:{},title:{default:"ç¡®è®¤æ“ä½œ"},confirmText:{default:"ç¡®å®š"},cancelText:{default:"å–æ¶ˆ"},confirmType:{default:"primary"}},emits:["confirm","cancel"],setup($,{emit:q}){const a=q,k=p(null);function v(){a("confirm")}function y(){a("cancel")}function b(l){l.target===l.currentTarget&&a("cancel")}function f(l){l.key==="Escape"?a("cancel"):l.key==="Enter"&&a("confirm")}return fe(()=>{document.addEventListener("keydown",f),k.value?.focus()}),Te(()=>{document.removeEventListener("keydown",f)}),(l,x)=>(s(),u("div",{ref_key:"modalRef",ref:k,class:"modal-overlay confirm-modal-overlay",tabindex:"-1",onClick:b},[e("div",To,[e("div",wo,[e("h3",Bo,M($.title),1),e("button",{class:"modal-close-btn",onClick:y,title:"å…³é—­"},"Ã—")]),e("div",Mo,[e("p",xo,M($.message),1)]),e("div",Do,[e("button",{class:"btn btn-secondary",onClick:y},M($.cancelText),1),e("button",{class:ue(["btn",$.confirmType==="danger"?"btn-danger":"btn-primary"]),onClick:v},M($.confirmText),3)])])],512))}}),Eo=X(Io,[["__scopeId","data-v-f6f7303a"]]),Ao={class:"bookshelf-page"},So={class:"app-header"},Lo={class:"header-content"},Ro={class:"logo-container"},Vo={class:"header-links"},qo={class:"lan-access-info",title:"å…¶ä»–è®¾å¤‡å¯é€šè¿‡æ­¤åœ°å€è®¿é—®"},Uo={id:"lanUrl"},Fo={class:"bookshelf-main"},Oo={key:0,class:"batch-toolbar"},zo={class:"batch-info"},No=["checked"],Po={class:"books-container"},Ko={key:0,class:"books-grid"},Qo={key:1,class:"empty-state"},jo={key:2,class:"empty-state"},Go={key:0,class:"modal active"},Wo={class:"modal-content modal-small"},Ho={class:"modal-header"},Xo={class:"modal-body"},Yo={class:"batch-tag-hint"},Jo={key:0,class:"tag-select-list"},Zo=["onClick"],es={class:"tag-name"},ts={key:0,class:"tag-check"},os={key:1,class:"empty-state-small"},ss={class:"modal-footer"},ns=["disabled"],as=Y({__name:"BookshelfView",setup($){const q=Be(),a=le(),k=p("è·å–ä¸­..."),v=p(!1),y=p(!1),b=p(!1),f=p(!1),l=p(null),x=p(""),A=p(null),i=p(!1),C=p(0),w=p(0),I=p(null),D=L(()=>a.filteredBooks),B=L(()=>a.tags),_=L(()=>a.selectedBooks),O=L(()=>a.batchMode),ee=L(()=>D.value.length===0&&!a.searchQuery);function J(m){m.persisted&&(console.log("[BookshelfView] é¡µé¢ä» BFCache æ¢å¤ï¼Œåˆ·æ–°æ•°æ®"),a.loadBooks(),a.loadTags(),y.value&&a.currentBook&&F(a.currentBook.id))}fe(async()=>{await Promise.all([a.loadBooks(),a.loadTags()]);try{const m=await Ee();m.success&&m.lan_url&&(k.value=m.lan_url)}catch(m){console.error("è·å–æœåŠ¡å™¨ä¿¡æ¯å¤±è´¥:",m),k.value="è·å–å¤±è´¥"}window.addEventListener("pageshow",J)}),Te(()=>{window.removeEventListener("pageshow",J)});async function h(){try{await navigator.clipboard.writeText(k.value),r("å±€åŸŸç½‘åœ°å€å·²å¤åˆ¶ï¼","success")}catch{const m=document.createElement("textarea");m.value=k.value,document.body.appendChild(m),m.select(),document.execCommand("copy"),document.body.removeChild(m),r("å±€åŸŸç½‘åœ°å€å·²å¤åˆ¶ï¼","success")}}function c(){l.value=null,v.value=!0}function g(m){l.value=m,v.value=!0}async function F(m){try{const o=await fetch(`/api/bookshelf/books/${m}`);if(!o.ok)throw new Error(`HTTP ${o.status}`);const z=await o.json();if(!z.success)throw new Error(z.error||"åŠ è½½å¤±è´¥");z.book&&a.updateBook(m,z.book),a.setCurrentBook(m),y.value=!0}catch(o){const z=o instanceof Error?o.message:"æœªçŸ¥é”™è¯¯";console.error("åŠ è½½ä¹¦ç±è¯¦æƒ…å¤±è´¥:",o),r(`åŠ è½½ä¹¦ç±è¯¦æƒ…å¤±è´¥: ${z}`,"error")}}function te(){b.value=!0}function ce(){a.enterBatchMode()}function oe(){a.exitBatchMode()}function P(){_.value.size===D.value.length?a.clearSelection():D.value.forEach(m=>{a.selectBook(m.id)})}function H(){if(_.value.size===0){r("è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„ä¹¦ç±","warning");return}x.value=`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${_.value.size} æœ¬ä¹¦ç±å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`,A.value=async()=>{try{const m=await a.batchDeleteBooksApi(Array.from(_.value));m>=0?(r(`æˆåŠŸåˆ é™¤ ${m} æœ¬ä¹¦ç±`,"success"),oe(),await a.loadBooks(),await a.loadTags()):r("åˆ é™¤å¤±è´¥","error")}catch{r("åˆ é™¤å¤±è´¥","error")}},f.value=!0}function pe(){q.push("/translate")}function ke(){r("ğŸŒ™ è¯¥åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼","info")}function be(m,o){m.preventDefault(),O.value?(C.value=m.clientX,w.value=m.clientY,I.value=o,i.value=!0):(ce(),a.toggleBookSelection(o))}function ge(){i.value=!1,I.value=null}function he(m){x.value="ç¡®å®šè¦åˆ é™¤è¿™æœ¬ä¹¦ç±å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚",A.value=async()=>{try{await a.deleteBookApi(m),r("åˆ é™¤æˆåŠŸ","success")}catch{r("åˆ é™¤å¤±è´¥","error")}},f.value=!0}const K=p(!1),S=p("add"),R=p([]);function de(){if(_.value.size===0){r("è¯·å…ˆé€‰æ‹©è¦æ“ä½œçš„ä¹¦ç±","warning");return}S.value="add",R.value=[],K.value=!0}function ve(){if(_.value.size===0){r("è¯·å…ˆé€‰æ‹©è¦æ“ä½œçš„ä¹¦ç±","warning");return}S.value="remove",R.value=[],K.value=!0}function ye(m){const o=R.value.indexOf(m);o>=0?R.value.splice(o,1):R.value.push(m)}async function ie(){if(R.value.length===0){r("è¯·é€‰æ‹©è‡³å°‘ä¸€ä¸ªæ ‡ç­¾","warning");return}const m=Array.from(_.value);try{const{batchAddTags:o,batchRemoveTags:z}=await $e(async()=>{const{batchAddTags:T,batchRemoveTags:n}=await import("./bookshelf.CDzdK045.js");return{batchAddTags:T,batchRemoveTags:n}},__vite__mapDeps([0,1,2]));if(S.value==="add")if((await o(m,R.value)).success){for(const n of m)for(const t of R.value)a.addTagToBook(n,t);r(`å·²ä¸º ${m.length} æœ¬ä¹¦æ·»åŠ æ ‡ç­¾`,"success")}else r("æ·»åŠ æ ‡ç­¾å¤±è´¥","error");else if((await z(m,R.value)).success){for(const n of m)for(const t of R.value)a.removeTagFromBook(n,t);r(`å·²ä» ${m.length} æœ¬ä¹¦ç§»é™¤æ ‡ç­¾`,"success")}else r("ç§»é™¤æ ‡ç­¾å¤±è´¥","error");K.value=!1,oe()}catch(o){r("æ“ä½œå¤±è´¥","error"),console.error("æ‰¹é‡æ ‡ç­¾æ“ä½œå¤±è´¥:",o)}}return(m,o)=>{const z=Ie("router-link");return s(),u("div",Ao,[e("header",So,[e("div",Lo,[e("div",Ro,[we(z,{to:"/",title:"ä¹¦æ¶é¦–é¡µ"},{default:re(()=>[...o[9]||(o[9]=[e("img",{src:xe,alt:"Saber-Translator Logo",class:"app-logo"},null,-1),e("span",{class:"app-name"},"Saber-Translator",-1)])]),_:1})]),e("div",Vo,[e("span",qo,[o[10]||(o[10]=e("span",{class:"lan-icon"},"ğŸŒå±€åŸŸç½‘è®¾å¤‡å¯é€šè¿‡è¯¥ç½‘å€è®¿é—®",-1)),e("span",Uo,M(k.value),1),e("button",{class:"copy-btn",title:"å¤åˆ¶åœ°å€",onClick:h},"ğŸ“‹")]),o[12]||(o[12]=e("a",{href:"http://www.mashirosaber.top",target:"_blank",class:"tutorial-link"},"ä½¿ç”¨æ•™ç¨‹",-1)),o[13]||(o[13]=e("a",{href:"https://github.com/MashiroSaber03/Saber-Translator",target:"_blank",class:"github-link"},[e("img",{src:Se,alt:"GitHub",class:"github-icon"})],-1)),e("button",{class:"theme-toggle",title:"åŠŸèƒ½å¼€å‘ä¸­",onClick:ke},[...o[11]||(o[11]=[e("span",{class:"theme-icon"},"â˜€ï¸",-1)])])])])]),e("main",Fo,[e("div",{class:"bookshelf-toolbar"},[o[17]||(o[17]=e("h1",{class:"page-title"},"æˆ‘çš„ä¹¦æ¶",-1)),e("div",{class:"toolbar-actions"},[e("button",{class:"btn btn-primary",onClick:c},[...o[14]||(o[14]=[e("span",{class:"btn-icon"},"+",-1),e("span",null,"æ–°å»ºä¹¦ç±",-1)])]),e("button",{class:"btn btn-secondary",onClick:te},[...o[15]||(o[15]=[e("span",null,"ğŸ·ï¸ ç®¡ç†æ ‡ç­¾",-1)])]),e("button",{class:"btn btn-secondary",onClick:pe},[...o[16]||(o[16]=[e("span",null,"å¿«é€Ÿç¿»è¯‘",-1)])])])]),we(Xe,{tags:B.value,onSearch:_e(a).setSearchQuery,onFilterTag:_e(a).toggleTagFilter},null,8,["tags","onSearch","onFilterTag"]),O.value?(s(),u("div",Oo,[e("div",zo,[e("input",{type:"checkbox",checked:_.value.size===D.value.length&&D.value.length>0,onChange:P},null,40,No),e("span",null,M(_.value.size),1),o[18]||(o[18]=ne(" æœ¬å·²é€‰ä¸­ ",-1))]),e("div",{class:"batch-actions"},[e("button",{class:"btn btn-sm btn-secondary",onClick:de},"ğŸ·ï¸ æ·»åŠ æ ‡ç­¾"),e("button",{class:"btn btn-sm btn-secondary",onClick:ve},"â– ç§»é™¤æ ‡ç­¾"),e("button",{class:"btn btn-sm btn-danger",onClick:H},"ğŸ—‘ï¸ æ‰¹é‡åˆ é™¤"),e("button",{class:"btn btn-sm btn-secondary",onClick:oe},"å–æ¶ˆ")])])):E("",!0),e("div",Po,[D.value.length>0?(s(),u("div",Ko,[(s(!0),u(Q,null,j(D.value,T=>(s(),N(Pe,{key:T.id,book:T,selected:_.value.has(T.id),"batch-mode":O.value,onClick:n=>F(T.id),onEdit:n=>g(T.id),onSelect:n=>_e(a).toggleBookSelection(T.id),onContextmenu:n=>be(n,T.id)},null,8,["book","selected","batch-mode","onClick","onEdit","onSelect","onContextmenu"]))),128))])):ee.value?(s(),u("div",Qo,[o[20]||(o[20]=e("div",{class:"empty-icon"},"ğŸ“š",-1)),o[21]||(o[21]=e("h2",null,"ä¹¦æ¶ç©ºç©ºå¦‚ä¹Ÿ",-1)),o[22]||(o[22]=e("p",null,'ç‚¹å‡»"æ–°å»ºä¹¦ç±"å¼€å§‹ä½ çš„ç¿»è¯‘ä¹‹æ—…',-1)),e("button",{class:"btn btn-primary",onClick:c},[...o[19]||(o[19]=[e("span",{class:"btn-icon"},"+",-1),e("span",null,"æ–°å»ºç¬¬ä¸€æœ¬ä¹¦",-1)])])])):(s(),u("div",jo,[...o[23]||(o[23]=[e("div",{class:"empty-icon"},"ğŸ”",-1),e("h2",null,"æœªæ‰¾åˆ°åŒ¹é…çš„ä¹¦ç±",-1),e("p",null,"å°è¯•è°ƒæ•´æœç´¢æ¡ä»¶æˆ–æ ‡ç­¾ç­›é€‰",-1)])]))])]),v.value?(s(),N(dt,{key:0,"book-id":l.value,onClose:o[0]||(o[0]=T=>v.value=!1),onSaved:o[1]||(o[1]=T=>v.value=!1)},null,8,["book-id"])):E("",!0),y.value?(s(),N(ro,{key:1,onClose:o[2]||(o[2]=T=>y.value=!1),onEdit:g})):E("",!0),b.value?(s(),N(Co,{key:2,onClose:o[3]||(o[3]=T=>b.value=!1)})):E("",!0),f.value?(s(),N(Eo,{key:3,message:x.value,onConfirm:o[4]||(o[4]=T=>{A.value?.(),f.value=!1}),onCancel:o[5]||(o[5]=T=>f.value=!1)},null,8,["message"])):E("",!0),i.value&&I.value?(s(),N($o,{key:4,x:C.value,y:w.value,"book-id":I.value,onClose:ge,onOpenDetail:F,onEdit:g,onDelete:he,onManageTags:te,onEnterBatchMode:ce},null,8,["x","y","book-id"])):E("",!0),(s(),N(me,{to:"body"},[K.value?(s(),u("div",Go,[e("div",{class:"modal-overlay",onClick:o[6]||(o[6]=T=>K.value=!1)}),e("div",Wo,[e("div",Ho,[e("h2",null,M(S.value==="add"?"æ‰¹é‡æ·»åŠ æ ‡ç­¾":"æ‰¹é‡ç§»é™¤æ ‡ç­¾"),1),e("button",{class:"modal-close",onClick:o[7]||(o[7]=T=>K.value=!1)},"Ã—")]),e("div",Xo,[e("p",Yo,M(S.value==="add"?"é€‰æ‹©è¦æ·»åŠ åˆ°é€‰ä¸­ä¹¦ç±çš„æ ‡ç­¾ï¼š":"é€‰æ‹©è¦ä»é€‰ä¸­ä¹¦ç±ç§»é™¤çš„æ ‡ç­¾ï¼š"),1),B.value.length>0?(s(),u("div",Jo,[(s(!0),u(Q,null,j(B.value,T=>(s(),u("div",{key:T.id,class:ue(["tag-select-item",{selected:R.value.includes(T.name)}]),onClick:n=>ye(T.name)},[e("span",{class:"tag-color",style:Z({background:T.color||"#667eea"})},null,4),e("span",es,M(T.name),1),R.value.includes(T.name)?(s(),u("span",ts,"âœ“")):E("",!0)],10,Zo))),128))])):(s(),u("div",os,[...o[24]||(o[24]=[e("p",null,'æš‚æ— æ ‡ç­¾ï¼Œè¯·å…ˆåœ¨"ç®¡ç†æ ‡ç­¾"ä¸­åˆ›å»º',-1)])]))]),e("div",ss,[e("button",{type:"button",class:"btn btn-secondary",onClick:o[8]||(o[8]=T=>K.value=!1)},"å–æ¶ˆ"),e("button",{type:"button",class:"btn btn-primary",disabled:R.value.length===0,onClick:ie}," ç¡®å®š ",8,ns)])])])):E("",!0)]))])}}}),fs=X(as,[["__scopeId","data-v-4eeebd94"]]);export{fs as default};
