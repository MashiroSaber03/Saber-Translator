const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/config.CwRcCkM9.js","js/client.Bht704G-.js","js/utils-vendor.B9ygI19o.js","js/BookshelfView.DwSOaSgZ.js","js/bookshelfStore.Cp4MihB-.js","js/vue-vendor.DIYfje1l.js","js/bookshelf.B4ums9uK.js","js/system.CycOVeYh.js","js/BaseModal.f0YVaCL-.js","assets/BaseModal.CgStYIKv.css","assets/BookshelfView.97AEaXQ0.css","js/TranslateView.BFz5KsgO.js","js/CustomSelect.vue_vue_type_style_index_0_lang.BbTiIb--.js","assets/CustomSelect.CoWnC2Ju.css","assets/TranslateView.MPLdeij_.css","js/ReaderView.DbBchV0Y.js","assets/ReaderView.DUeMDiK1.css","js/InsightView.DMWqRhxw.js","assets/InsightView.S94ca7xo.css"])))=>i.map(i=>d[i]);
import{c as q,r as V,d as me,a as X,b as de,g as pe,f as j,l as J,E as fe,m as ve,T as he,k as S,e as L,F as W,j as ge,D as Z,n as Te,t as Oe,p as Pe,o as xe,R as Re,G as _e,H as Me,I as Se,J as Ee}from"./vue-vendor.DIYfje1l.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))d(m);new MutationObserver(m=>{for(const p of m)if(p.type==="childList")for(const g of p.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&d(g)}).observe(document,{childList:!0,subtree:!0});function i(m){const p={};return m.integrity&&(p.integrity=m.integrity),m.referrerPolicy&&(p.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?p.credentials="include":m.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function d(m){if(m.ep)return;m.ep=!0;const p=i(m);fetch(m.href,p)}})();const qe="modulepreload",ye=function(e){return"/"+e},$={},E=function(a,i,d){let m=Promise.resolve();if(i&&i.length>0){let f=function(v){return Promise.all(v.map(O=>Promise.resolve(O).then(r=>({status:"fulfilled",value:r}),r=>({status:"rejected",reason:r}))))};document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),P=g?.nonce||g?.getAttribute("nonce");m=f(i.map(v=>{if(v=ye(v),v in $)return;$[v]=!0;const O=v.endsWith(".css"),r=O?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${r}`))return;const t=document.createElement("link");if(t.rel=O?"stylesheet":qe,O||(t.as="script"),t.crossOrigin="",t.href=v,P&&t.setAttribute("nonce",P),document.head.appendChild(t),O)return new Promise((u,M)=>{t.addEventListener("load",u),t.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${v}`)))})}))}function p(g){const P=new Event("vite:preloadError",{cancelable:!0});if(P.payload=g,window.dispatchEvent(P),!P.defaultPrevented)throw g}return m.then(g=>{for(const P of g||[])P.status==="rejected"&&p(P.reason);return a().catch(p)})},Le="fonts/思源黑体SourceHanSansK-Bold.TTF",Ae="#FFFFFF",Q=`你是一个ocr助手，你需要将我发送给你的图片中的文字提取出来并返回给我，要求：
1、完整识别：我发送给你的图片中的文字都是需要识别的内容
2、非贪婪输出：不要返回任何其他解释和说明。`,k=`忽略之前的所有指令，仅遵循以下定义。

## 角色：专业漫画翻译师
你是一个专业的漫画翻译引擎，擅长将外语漫画翻译成中文。

## 翻译方法
1. 直译阶段：
- 对每一行文本进行精确的逐词翻译
- 尽可能保持原文的句子结构
- 保留所有原始标记和表达方式
- 对模糊的内容保持原样，不做过度解读

2. 分析与意译阶段：
- 捕捉核心含义、情感基调和文化内涵
- 识别碎片化文本段落之间的逻辑联系
- 分析直译的不足之处和需要改进的地方

3. 润色阶段：
- 调整翻译使其在中文中听起来自然流畅，同时保持原意
- 保留适合漫画和宅文化的情感基调和强度
- 确保角色语气和术语的一致性
- 根据上下文推断合适的人称代词（他/她/我/你/你们），不要添加原文中不存在的代词
- 根据第二步的结论进行最终润色

## 翻译规则
- 逐行翻译，保持准确性和真实性，忠实再现原文及其情感意图
- 保留原文中的拟声词或音效词，不进行翻译
- 每个翻译段落必须带有编号前缀（严格使用 <|数字|> 格式），只输出翻译结果，不要输出原文
- 只翻译内容，不要添加任何解释或评论

请将以下外语文本翻译成中文：`,Ne=`忽略之前的所有指令，仅遵循以下定义。

## 角色：专业漫画翻译师
你是一个专业的漫画翻译引擎，擅长将外语漫画翻译成中文。

## 翻译方法
1. 直译阶段：对每一行文本进行精确的逐词翻译
2. 分析与意译阶段：捕捉核心含义、情感基调和文化内涵
3. 润色阶段：调整翻译使其在中文中听起来自然流畅

## 翻译规则
- 逐行翻译，保持准确性和真实性
- 保留原文中的拟声词或音效词，不进行翻译
- 只翻译内容，不要添加任何解释或评论

## 输出格式
请严格按照以下 JSON 格式返回翻译结果，不要添加任何额外文字：
{
  "translations": [
    {"id": 1, "text": "翻译内容1"},
    {"id": 2, "text": "翻译内容2"}
  ]
}

请将以下外语文本翻译成中文：`,Ve=`你是一个OCR助手。请将我发送给你的图片中的所有文字提取出来。
当文本中包含特殊字符（如大括号{}、引号""、反斜杠\\等）时，请在输出中保留它们但不要将它们视为JSON语法的一部分。如果需要，你可以使用转义字符\\来表示这些特殊字符。
请严格按照以下 JSON 格式返回结果，不要添加任何额外的解释或对话:
{
  "extracted_text": "[这里放入所有识别到的文字，可以包含换行符以大致保留原始分段，但不要包含任何其他非文本内容]"
}`,Ie=`你是一个漫画翻译助手，我会提供原始漫画图片和导出的只含原文不含译文JSON翻译文件，帮我将原文翻译成中文
翻译要求：
1.仅修改JSON中的"translated"译文，保持其他所有结构和字段不变。
2.json中的"imagelndex"序号是每张图片的页码，在翻译前先根据json文件中每页图片的原文内容和所有漫画图片对我给你的所有图片进行排序，在进行上下文对比时要严格按照"imagelndex"序号进行对比，你在翻译时要按照"imagelndex"的顺序进行顺序翻译，从而使得每句翻译足够连贯，上下文不会突兀
3.通过json中每页图片的"original"原文内容和所有的漫画图片明确每句话在那页图的哪个位置，并结合漫画图像和上下文语境，让翻译更加连贯自然，符合角色语气和场景
4.json中的"bubblelndex"标号可能不正确，你需要根据图片自行判断每句话的正确顺序，从而输出符合上下文连贯的翻译，但在输出翻译时不要修改原本的"bubblelndex"标号
5.保留原文的表达意图和情感，但使用更地道、流畅的表达方式
6.注意专有名词和术语的一致性翻译
7.如遇幽默、双关语或文化特定内容，请尽量找到目标语言中恰当的表达
8.不要添加原文中不存在的信息或解释
9.保持简洁明了，符合气泡空间限制
10.译文字数尽量不要超过原文
11.你需要直接返回修改后的完整JSON文件，无需解释每处修改原因。`,Ro=`你是一个专业的漫画校对助手，请帮我校对漫画翻译结果。我会给你漫画未经翻译的原图、由漫画原文和已有的翻译文本组成的JSON文件，请根据图片内容和上下文关系，检查并改进翻译质量。
校对要点：
1. json中的"imagelndex"序号是每张图片的页码，在翻译前先根据json文件中每页图片的原文内容和所有漫画图片对我给你的所有图片进行排序，在进行上下文对比时要严格按照"imagelndex"序号进行对比，你在翻译时要按照"imagelndex"的顺序进行顺序翻译，从而使得每句翻译足够连贯，上下文不会突兀
2. 通过json中每页图片的"original"原文内容和所有的漫画图片明确每句话在那页图的哪个位置，并结合漫画图像和上下文语境，让翻译更加连贯自然，符合角色语气和场景
3. json中的"bubblelndex"标号可能不正确，你需要根据图片自行判断每句话的正确顺序，从而输出符合上下文连贯的翻译，但在输出翻译时不要修改原本的"bubblelndex"标号
4. 针对特殊术语或专有名词的翻译进行统一
5. 重点关注易错点的人称和语气词
6. 修正任何语法或表达错误
请直接返回修改后的JSON数据，保持原有格式，只需更新"translated"字段的内容。`,U=0,B=0,A=32,be=!0,Ue="#FFFFFF",Be=3,_o=[16,20,24,28,32,36,40,48,56,64],Mo=2,So=10,Eo=100,D=3,F=2,N=2,qo=5,yo=200,Lo=30,Ao="edit_mode_layout",w="translationSettings",G="providerConfigs",Y="modelHistory",No="webImportSettings",Vo=`你是一个专业的漫画数据提取助手。请针对当前网页执行以下提取任务:

## 1. 交互行为
- 请模拟用户行为，缓慢向下滚动页面至底部，以触发所有采用"懒加载"技术的漫画图片。
- 在滚动过程中，请确保等待图片加载完成，识别并提取真实的漫画内容图片。

## 2. 提取逻辑
- **图片过滤**: 忽略所有加载占位图（如 loading.gif、spacer.gif）、广告图或图标，仅提取属于漫画正文的图片。
- **属性识别**: 优先提取 \`data-src\`、\`data-original\`、\`original\` 或 \`file\` 等包含真实高清原图地址的属性。如果这些属性不存在，再提取 \`src\` 属性。
- **元数据**: 提取漫画的名称（comic_title）和当前章节的名称（chapter_title）。

## 3. 数据结构
- 必须按图片在页面中显示的先后顺序提取，并为每张图片分配一个从 1 开始的 \`page_number\`（页码序号）。
- 最终结果以 JSON 格式输出，包含漫画名称、章节名以及包含序号和图片链接的列表。

## 4. 输出格式 (Valid JSON Only)
严格按照以下 JSON 格式输出，不要包含 Markdown 代码块标记（如 \\\`\\\`\\\`json）：

{
  "comic_title": "漫画名称",
  "chapter_title": "第X话 章节标题",
  "pages": [
    {"page_number": 1, "image_url": "https://..."},
    {"page_number": 2, "image_url": "https://..."}
  ],
  "total_pages": 1
}`,Io=[{value:"openai",label:"OpenAI"},{value:"siliconflow",label:"SiliconFlow"},{value:"deepseek",label:"DeepSeek"},{value:"volcano",label:"火山引擎"},{value:"gemini",label:"Google Gemini"},{value:"custom_openai",label:"自定义 OpenAI 兼容服务"}],De={fontSize:25,autoFontSize:!1,fontFamily:Le,layoutDirection:"auto",textColor:"#000000",fillColor:Ae,strokeEnabled:be,strokeColor:Ue,strokeWidth:Be,inpaintMethod:"solid",useAutoTextColor:!1},Fe={apiKey:"",secretKey:"",version:"standard",sourceLanguage:"JAP"},Ce={sourceLanguage:"japanese"},Ke={provider:"gemini",apiKey:"",modelName:"",prompt:Q,rpmLimit:B,customBaseUrl:"",isJsonMode:!1,minImageSize:A},we={provider:"siliconflow",apiKey:"",modelName:"",customBaseUrl:"",rpmLimit:U,maxRetries:D,isJsonMode:!1},Je={provider:"siliconflow",apiKey:"",modelName:"",customBaseUrl:"",batchSize:3,sessionReset:20,rpmLimit:7,maxRetries:F,lowReasoning:!1,noThinkingMethod:"gemini",forceJsonOutput:!0,useStream:!1,prompt:Ie},ze={enabled:!1,rounds:[],maxRetries:N},He={ratio:0,top:0,bottom:0,left:0,right:0},je={enabled:!0,dilateSize:10,boxExpandRatio:20},$e={enabled:!1,deepLearningLockSize:1};function b(){return{textStyle:{...De},ocrEngine:"manga_ocr",sourceLanguage:"japanese",textDetector:"default",baiduOcr:{...Fe},paddleOcrVl:{...Ce},aiVisionOcr:{...Ke},translation:{...we},targetLanguage:"zh",translatePrompt:k,useTextboxPrompt:!1,textboxPrompt:"",hqTranslation:{...Je},proofreading:{...ze},boxExpand:{...He},preciseMask:{...je},pdfProcessingMethod:"backend",showDetectionDebug:!1,parallel:{...$e},autoSaveInBookshelfMode:!1}}function Ge(e,a,i,d){const m=q(()=>e.value.ocrEngine),p=q(()=>e.value.sourceLanguage);function g(h){e.value.ocrEngine=h,i(),console.log(`OCR引擎已设置为: ${h}`)}function P(h){e.value.sourceLanguage=h,i(),console.log(`源语言已设置为: ${h}`)}function f(h){Object.assign(e.value.baiduOcr,h),i()}function v(h){Object.assign(e.value.paddleOcrVl,h),i()}function O(h){Object.assign(e.value.aiVisionOcr,h),i()}function r(h){const T=e.value.aiVisionOcr.provider;T!==h&&(u(T),e.value.aiVisionOcr.provider=h,M(h),i(),console.log(`AI视觉OCR服务商已切换为: ${h}`))}function t(h){e.value.aiVisionOcr.isJsonMode=h;const T=h?Ve:Q;e.value.aiVisionOcr.prompt=T,i(),console.log(`AI视觉OCR提示词模式已切换为: ${h?"JSON格式":"普通模式"}`)}function u(h){if(!h)return;const T={apiKey:e.value.aiVisionOcr.apiKey,modelName:e.value.aiVisionOcr.modelName,customBaseUrl:e.value.aiVisionOcr.customBaseUrl,prompt:e.value.aiVisionOcr.prompt,rpmLimit:e.value.aiVisionOcr.rpmLimit,isJsonMode:e.value.aiVisionOcr.isJsonMode,minImageSize:e.value.aiVisionOcr.minImageSize};a.value.aiVisionOcr[h]=T,d(),console.log(`[Settings] 保存AI视觉OCR服务商配置: ${h}`,T)}function M(h){if(!h)return;const T=a.value.aiVisionOcr[h];T?(T.apiKey!==void 0&&(e.value.aiVisionOcr.apiKey=T.apiKey),T.modelName!==void 0&&(e.value.aiVisionOcr.modelName=T.modelName),T.customBaseUrl!==void 0&&(e.value.aiVisionOcr.customBaseUrl=T.customBaseUrl),T.prompt!==void 0&&(e.value.aiVisionOcr.prompt=T.prompt),T.rpmLimit!==void 0&&(e.value.aiVisionOcr.rpmLimit=T.rpmLimit),T.isJsonMode!==void 0&&(e.value.aiVisionOcr.isJsonMode=T.isJsonMode),T.minImageSize!==void 0&&(e.value.aiVisionOcr.minImageSize=T.minImageSize),console.log(`[Settings] 恢复AI视觉OCR服务商配置: ${h}`,T)):(e.value.aiVisionOcr.apiKey="",e.value.aiVisionOcr.modelName="",e.value.aiVisionOcr.customBaseUrl="",console.log(`[Settings] ${h} 无缓存配置，使用默认值`))}return{ocrEngine:m,sourceLanguage:p,setOcrEngine:g,setSourceLanguage:P,updateBaiduOcr:f,updatePaddleOcrVl:v,updateAiVisionOcr:O,setAiVisionOcrProvider:r,setAiVisionOcrPromptMode:t,saveAiVisionOcrProviderConfig:u,restoreAiVisionOcrProviderConfig:M}}function Ye(e,a,i,d){const m=q(()=>e.value.translation.provider);function p(r){const t=e.value.translation.provider;t!==r&&(v(t),e.value.translation.provider=r,O(r),i())}function g(r){Object.assign(e.value.translation,r),i()}function P(r){e.value.translatePrompt=r,i()}function f(r){e.value.translation.isJsonMode=r;const t=r?Ne:k;e.value.translatePrompt=t,i(),console.log(`翻译提示词模式已切换为: ${r?"JSON格式":"普通模式"}`)}function v(r){if(!r)return;const t={apiKey:e.value.translation.apiKey,modelName:e.value.translation.modelName,customBaseUrl:e.value.translation.customBaseUrl,rpmLimit:e.value.translation.rpmLimit,maxRetries:e.value.translation.maxRetries,isJsonMode:e.value.translation.isJsonMode};a.value.translation[r]=t,d(),console.log(`[Settings] 保存翻译服务商配置: ${r}`,t)}function O(r){if(!r)return;const t=a.value.translation[r];t?(t.apiKey!==void 0&&(e.value.translation.apiKey=t.apiKey),t.modelName!==void 0&&(e.value.translation.modelName=t.modelName),t.customBaseUrl!==void 0&&(e.value.translation.customBaseUrl=t.customBaseUrl),t.rpmLimit!==void 0&&(e.value.translation.rpmLimit=t.rpmLimit),t.maxRetries!==void 0&&(e.value.translation.maxRetries=t.maxRetries),t.isJsonMode!==void 0&&(e.value.translation.isJsonMode=t.isJsonMode),console.log(`[Settings] 恢复翻译服务商配置: ${r}`,t)):(e.value.translation.apiKey="",e.value.translation.modelName="",e.value.translation.customBaseUrl="",console.log(`[Settings] ${r} 无缓存配置，使用默认值`))}return{translationProvider:m,setTranslationProvider:p,updateTranslationService:g,setTranslatePrompt:P,setTranslatePromptMode:f,saveTranslationProviderConfig:v,restoreTranslationProviderConfig:O}}function Xe(e,a){function i(p){e.value.textDetector=p,a(),console.log(`文本检测器已设置为: ${p}`)}function d(p){Object.assign(e.value.boxExpand,p),a()}function m(p){Object.assign(e.value.preciseMask,p),a()}return{setTextDetector:i,updateBoxExpand:d,updatePreciseMask:m}}function We(e,a,i,d){const m=q(()=>e.value.hqTranslation.provider);function p(t){const u=e.value.hqTranslation.provider;u!==t&&(O(u),e.value.hqTranslation.provider=t,r(t),i(),console.log(`高质量翻译服务商已切换为: ${t}`))}function g(t){Object.assign(e.value.hqTranslation,t),i()}function P(t){e.value.hqTranslation.useStream=t,i()}function f(t){e.value.hqTranslation.noThinkingMethod=t,i()}function v(t){e.value.hqTranslation.forceJsonOutput=t,i()}function O(t){if(!t)return;const u={apiKey:e.value.hqTranslation.apiKey,modelName:e.value.hqTranslation.modelName,customBaseUrl:e.value.hqTranslation.customBaseUrl,batchSize:e.value.hqTranslation.batchSize,sessionReset:e.value.hqTranslation.sessionReset,rpmLimit:e.value.hqTranslation.rpmLimit,maxRetries:e.value.hqTranslation.maxRetries,lowReasoning:e.value.hqTranslation.lowReasoning,noThinkingMethod:e.value.hqTranslation.noThinkingMethod,forceJsonOutput:e.value.hqTranslation.forceJsonOutput,useStream:e.value.hqTranslation.useStream,prompt:e.value.hqTranslation.prompt};a.value.hqTranslation[t]=u,d(),console.log(`[Settings] 保存高质量翻译服务商配置: ${t}`,u)}function r(t){if(!t)return;const u=a.value.hqTranslation[t];u?(u.apiKey!==void 0&&(e.value.hqTranslation.apiKey=u.apiKey),u.modelName!==void 0&&(e.value.hqTranslation.modelName=u.modelName),u.customBaseUrl!==void 0&&(e.value.hqTranslation.customBaseUrl=u.customBaseUrl),u.batchSize!==void 0&&(e.value.hqTranslation.batchSize=u.batchSize),u.sessionReset!==void 0&&(e.value.hqTranslation.sessionReset=u.sessionReset),u.rpmLimit!==void 0&&(e.value.hqTranslation.rpmLimit=u.rpmLimit),u.maxRetries!==void 0&&(e.value.hqTranslation.maxRetries=u.maxRetries),u.lowReasoning!==void 0&&(e.value.hqTranslation.lowReasoning=u.lowReasoning),u.noThinkingMethod!==void 0&&(e.value.hqTranslation.noThinkingMethod=u.noThinkingMethod),u.forceJsonOutput!==void 0&&(e.value.hqTranslation.forceJsonOutput=u.forceJsonOutput),u.useStream!==void 0&&(e.value.hqTranslation.useStream=u.useStream),u.prompt!==void 0&&(e.value.hqTranslation.prompt=u.prompt),console.log(`[Settings] 恢复高质量翻译服务商配置: ${t}`,u)):(e.value.hqTranslation.apiKey="",e.value.hqTranslation.modelName="",e.value.hqTranslation.customBaseUrl="",console.log(`[Settings] ${t} 无缓存配置，使用默认值`))}return{hqProvider:m,setHqProvider:p,updateHqTranslation:g,setHqUseStream:P,setHqNoThinkingMethod:f,setHqForceJsonOutput:v,saveHqProviderConfig:O,restoreHqProviderConfig:r}}function Ze(e,a){const i=q(()=>e.value.proofreading.enabled);function d(f){e.value.proofreading.enabled=f,a(),console.log(`AI校对已${f?"启用":"禁用"}`)}function m(f){e.value.proofreading.rounds.push(f),a(),console.log(`已添加校对轮次: ${f.name}`)}function p(f,v){if(f>=0&&f<e.value.proofreading.rounds.length){const O=e.value.proofreading.rounds[f];O&&(Object.assign(O,v),a())}}function g(f){if(f>=0&&f<e.value.proofreading.rounds.length){const v=e.value.proofreading.rounds.splice(f,1);a(),console.log(`已删除校对轮次: ${v[0]?.name}`)}}function P(f){e.value.proofreading.maxRetries=f,a()}return{isProofreadingEnabled:i,setProofreadingEnabled:d,addProofreadingRound:m,updateProofreadingRound:p,removeProofreadingRound:g,setProofreadingMaxRetries:P}}function Qe(e,a){function i(m){e.value.textboxPrompt=m,a()}function d(m){e.value.useTextboxPrompt=m,a()}return{setTextboxPrompt:i,setUseTextboxPrompt:d}}function ke(e,a){const i=q(()=>e.value.textStyle);function d(f){Object.assign(e.value,f),a()}function m(f){Object.assign(e.value.textStyle,f)}function p(f){e.value.pdfProcessingMethod=f,a(),console.log(`PDF处理方式已设置为: ${f}`)}function g(f){e.value.showDetectionDebug=f,a()}function P(f){e.value.autoSaveInBookshelfMode=f,a(),console.log(`书架模式自动保存已${f?"启用":"禁用"}`)}return{textStyle:i,updateSettings:d,updateTextStyle:m,setPdfProcessingMethod:p,setShowDetectionDebug:g,setAutoSaveInBookshelfMode:P}}function eo(){const e=V({}),a=V([]);function i(r,t){if(!r||!t)return;e.value[r]||(e.value[r]=[]);const u=e.value[r].indexOf(t);u!==-1&&e.value[r].splice(u,1),e.value[r].unshift(t),e.value[r].length>20&&(e.value[r]=e.value[r].slice(0,20)),P(),console.log(`[Settings] 添加模型到历史: ${r} -> ${t}`)}function d(r){return e.value[r]||[]}function m(r){e.value[r]&&(delete e.value[r],P(),console.log(`[Settings] 清除模型历史: ${r}`))}function p(r){a.value.includes(r)||(a.value.push(r),a.value.sort((t,u)=>t-u),v(),console.log(`已添加自定义字号预设: ${r}`))}function g(r){const t=a.value.indexOf(r);t!==-1&&(a.value.splice(t,1),v(),console.log(`已删除自定义字号预设: ${r}`))}function P(){try{const r=JSON.stringify(e.value);localStorage.setItem(Y,r)}catch(r){console.error("保存模型历史记录失败:",r)}}function f(){try{const r=localStorage.getItem(Y);r&&(e.value=JSON.parse(r),console.log("已从 localStorage 加载模型历史记录"))}catch(r){console.error("加载模型历史记录失败:",r)}}function v(){try{const r=JSON.stringify(a.value);localStorage.setItem("customFontSizePresets",r)}catch(r){console.error("保存自定义字号预设失败:",r)}}function O(){try{const r=localStorage.getItem("customFontSizePresets");r&&(a.value=JSON.parse(r))}catch(r){console.error("加载自定义字号预设失败:",r)}}return{modelHistory:e,customFontPresets:a,addModelToHistory:i,getModelHistory:d,clearModelHistory:m,addCustomFontPreset:p,removeCustomFontPreset:g,saveModelHistoryToStorage:P,loadModelHistoryFromStorage:f,saveCustomFontPresetsToStorage:v,loadCustomFontPresetsFromStorage:O}}const oo=me("settings",()=>{const e=V(b()),a=V({translation:{},hqTranslation:{},aiVisionOcr:{}});function i(){try{const o=JSON.stringify(e.value);localStorage.setItem(w,o)}catch(o){console.error("保存设置到 localStorage 失败:",o)}}function d(){try{const o=JSON.stringify(a.value);localStorage.setItem(G,o)}catch(o){console.error("保存服务商配置缓存失败:",o)}}const m="saber_translator_settings";function p(){try{let o=localStorage.getItem(w);if(!o){const s=localStorage.getItem(m);s&&(console.log("[Settings] 检测到原版设置，正在迁移..."),o=s,localStorage.setItem(w,s),console.log("[Settings] 原版设置已迁移到新存储键"))}if(o){const s=JSON.parse(o),c=b();e.value=f(c,s),P(),e.value.textStyle={...c.textStyle},console.log("已从 localStorage 加载设置（textStyle 使用默认值）")}}catch(o){console.error("从 localStorage 加载设置失败:",o)}}function g(){try{const o=localStorage.getItem(G);if(o){const s=JSON.parse(o);a.value={translation:s.translation||{},hqTranslation:s.hqTranslation||{},aiVisionOcr:s.aiVisionOcr||{}},console.log("已从 localStorage 加载服务商配置缓存")}}catch(o){console.error("加载服务商配置缓存失败:",o)}}function P(){const o=e.value.boxExpand;o.ratio=Number(o.ratio)||1,o.top=Number(o.top)||0,o.bottom=Number(o.bottom)||0,o.left=Number(o.left)||0,o.right=Number(o.right)||0;const s=e.value.preciseMask;s.dilateSize=Number(s.dilateSize)||5,s.boxExpandRatio=Number(s.boxExpandRatio)||1;const c=e.value.translation;c.rpmLimit=Number(c.rpmLimit)||U,c.maxRetries=Number(c.maxRetries)||D;const l=e.value.hqTranslation;l.batchSize=Number(l.batchSize)||10,l.sessionReset=Number(l.sessionReset)||50,l.rpmLimit=Number(l.rpmLimit)||60,l.maxRetries=Number(l.maxRetries)||F;const n=e.value.aiVisionOcr;n.rpmLimit=Number(n.rpmLimit)||B,n.minImageSize===void 0||n.minImageSize===null||isNaN(Number(n.minImageSize))?n.minImageSize=A:n.minImageSize=Number(n.minImageSize);const _=e.value.proofreading;_.maxRetries=Number(_.maxRetries)||N,c.provider==="baidu"&&(c.provider="baidu_translate"),c.provider==="youdao"&&(c.provider="youdao_translate"),a.value.translation.baidu&&(a.value.translation.baidu_translate={...a.value.translation.baidu},delete a.value.translation.baidu),a.value.translation.youdao&&(a.value.translation.youdao_translate={...a.value.translation.youdao},delete a.value.translation.youdao)}function f(o,s){const c={...o};for(const l in s)if(Object.prototype.hasOwnProperty.call(s,l)){const n=l,_=s[n],I=c[n];_!=null&&typeof _=="object"&&!Array.isArray(_)&&I!==null&&typeof I=="object"&&!Array.isArray(I)?c[n]={...I,..._}:_!==void 0&&(c[n]=_)}return c}const v=Ge(e,a,i,d),O=Ye(e,a,i,d),r=Xe(e,i),t=We(e,a,i,d),u=Ze(e,i),M=Qe(e,i),h=ke(e,i),T=eo();function ae(o,s){o==="translation"?O.saveTranslationProviderConfig(s):o==="hqTranslation"?t.saveHqProviderConfig(s):o==="aiVisionOcr"&&v.saveAiVisionOcrProviderConfig(s)}function ie(o,s){o==="translation"?O.restoreTranslationProviderConfig(s):o==="hqTranslation"?t.restoreHqProviderConfig(s):o==="aiVisionOcr"&&v.restoreAiVisionOcrProviderConfig(s)}function re(){try{localStorage.removeItem("theme"),typeof document<"u"&&(document.documentElement.setAttribute("data-theme","light"),document.body.setAttribute("data-theme","light"))}catch(o){console.warn("清理旧版主题设置失败:",o)}}function te(){re(),p(),T.loadCustomFontPresetsFromStorage(),g(),T.loadModelHistoryFromStorage()}function ne(){e.value=b(),i(),console.log("设置已重置为默认值")}async function se(){try{console.log("[Settings] 开始从后端加载设置...");const{getUserSettings:o}=await E(async()=>{const{getUserSettings:c}=await import("./config.CwRcCkM9.js");return{getUserSettings:c}},__vite__mapDeps([0,1,2])),s=await o();if(s.success&&s.settings){const c=s.settings;console.log("[Settings] 从后端加载设置:",c),le(c);const l=b();return e.value.textStyle={...l.textStyle},i(),d(),console.log("[Settings] 后端设置已应用（textStyle 使用默认值）"),!0}else return console.warn("[Settings] 后端无设置数据，使用 localStorage 或默认值"),!1}catch(o){return console.error("[Settings] 从后端加载设置失败:",o),!1}}function le(o){const s=(c,l)=>{if(c==null||c==="")return l;const n=typeof c=="string"?parseFloat(c):Number(c);return isNaN(n)?l:n};if(o.ocrEngine&&(e.value.ocrEngine=o.ocrEngine),o.sourceLanguage&&(e.value.sourceLanguage=o.sourceLanguage),o.textDetector&&(e.value.textDetector=o.textDetector),o.baiduApiKey&&(e.value.baiduOcr.apiKey=o.baiduApiKey),o.baiduSecretKey&&(e.value.baiduOcr.secretKey=o.baiduSecretKey),o.baiduVersion&&(e.value.baiduOcr.version=o.baiduVersion),o.baiduSourceLanguage&&(e.value.baiduOcr.sourceLanguage=o.baiduSourceLanguage),o.paddleOcrVlSourceLanguage&&(e.value.paddleOcrVl.sourceLanguage=o.paddleOcrVlSourceLanguage),o.aiVisionProvider&&(e.value.aiVisionOcr.provider=o.aiVisionProvider),o.aiVisionApiKey&&(e.value.aiVisionOcr.apiKey=o.aiVisionApiKey),o.aiVisionModelName&&(e.value.aiVisionOcr.modelName=o.aiVisionModelName),o.aiVisionOcrPrompt&&(e.value.aiVisionOcr.prompt=o.aiVisionOcrPrompt),o.customAiVisionBaseUrl&&(e.value.aiVisionOcr.customBaseUrl=o.customAiVisionBaseUrl),o.rpmAiVisionOcr!==void 0&&(e.value.aiVisionOcr.rpmLimit=s(o.rpmAiVisionOcr,B)),o.aiVisionPromptModeSelect==="json"&&(e.value.aiVisionOcr.isJsonMode=!0),o.aiVisionMinImageSize!==void 0&&(e.value.aiVisionOcr.minImageSize=s(o.aiVisionMinImageSize,A)),o.modelProvider&&(e.value.translation.provider=o.modelProvider),o.apiKey&&(e.value.translation.apiKey=o.apiKey),o.modelName&&(e.value.translation.modelName=o.modelName),o.customBaseUrl&&(e.value.translation.customBaseUrl=o.customBaseUrl),o.rpmTranslation!==void 0&&(e.value.translation.rpmLimit=s(o.rpmTranslation,U)),o.translationMaxRetries!==void 0&&(e.value.translation.maxRetries=s(o.translationMaxRetries,D)),o.translatePromptModeSelect==="json"&&(e.value.translation.isJsonMode=!0),o.targetLanguage&&(e.value.targetLanguage=o.targetLanguage),o.promptContent&&(e.value.translatePrompt=o.promptContent),o.enableTextboxPrompt!==void 0&&(e.value.useTextboxPrompt=o.enableTextboxPrompt),o.textboxPromptContent&&(e.value.textboxPrompt=o.textboxPromptContent),o.hqTranslateProvider&&(e.value.hqTranslation.provider=o.hqTranslateProvider),o.hqApiKey&&(e.value.hqTranslation.apiKey=o.hqApiKey),o.hqModelName&&(e.value.hqTranslation.modelName=o.hqModelName),o.hqCustomBaseUrl&&(e.value.hqTranslation.customBaseUrl=o.hqCustomBaseUrl),o.hqBatchSize!==void 0&&(e.value.hqTranslation.batchSize=s(o.hqBatchSize,3)),o.hqSessionReset!==void 0&&(e.value.hqTranslation.sessionReset=s(o.hqSessionReset,20)),o.hqRpmLimit!==void 0&&(e.value.hqTranslation.rpmLimit=s(o.hqRpmLimit,7)),o.hqMaxRetries!==void 0&&(e.value.hqTranslation.maxRetries=s(o.hqMaxRetries,F)),o.hqPrompt&&(e.value.hqTranslation.prompt=o.hqPrompt),o.hqLowReasoning!==void 0&&(e.value.hqTranslation.lowReasoning=o.hqLowReasoning),o.hqNoThinkingMethod&&(e.value.hqTranslation.noThinkingMethod=o.hqNoThinkingMethod),o.hqForceJsonOutput!==void 0&&(e.value.hqTranslation.forceJsonOutput=o.hqForceJsonOutput),o.hqUseStream!==void 0&&(e.value.hqTranslation.useStream=o.hqUseStream),o.proofreadingEnabled!==void 0&&(e.value.proofreading.enabled=o.proofreadingEnabled),o.proofreadingMaxRetries!==void 0&&(e.value.proofreading.maxRetries=s(o.proofreadingMaxRetries,N)),o.proofreading&&typeof o.proofreading=="object"){const c=o.proofreading;c.enabled!==void 0&&(e.value.proofreading.enabled=c.enabled),c.maxRetries!==void 0&&(e.value.proofreading.maxRetries=s(c.maxRetries,N)),Array.isArray(c.rounds)&&(e.value.proofreading.rounds=c.rounds.map(l=>({name:l.name||"轮次",provider:l.provider||"siliconflow",apiKey:l.apiKey||"",modelName:l.modelName||"",customBaseUrl:l.customBaseUrl||"",prompt:l.prompt||"",batchSize:s(l.batchSize,3),sessionReset:s(l.sessionReset,20),rpmLimit:s(l.rpmLimit,7),maxRetries:s(l.maxRetries,N),lowReasoning:l.lowReasoning||!1,noThinkingMethod:l.noThinkingMethod||"gemini",forceJsonOutput:l.forceJsonOutput||!1})))}if(o.boxExpandRatio!==void 0&&(e.value.boxExpand.ratio=s(o.boxExpandRatio,0)),o.boxExpandTop!==void 0&&(e.value.boxExpand.top=s(o.boxExpandTop,0)),o.boxExpandBottom!==void 0&&(e.value.boxExpand.bottom=s(o.boxExpandBottom,0)),o.boxExpandLeft!==void 0&&(e.value.boxExpand.left=s(o.boxExpandLeft,0)),o.boxExpandRight!==void 0&&(e.value.boxExpand.right=s(o.boxExpandRight,0)),o.usePreciseMask!==void 0&&(e.value.preciseMask.enabled=o.usePreciseMask),o.maskDilateSize!==void 0&&(e.value.preciseMask.dilateSize=s(o.maskDilateSize,5)),o.maskBoxExpandRatio!==void 0&&(e.value.preciseMask.boxExpandRatio=s(o.maskBoxExpandRatio,0)),o.pdfProcessingMethod&&(e.value.pdfProcessingMethod=o.pdfProcessingMethod),o.showDetectionDebug!==void 0&&(e.value.showDetectionDebug=o.showDetectionDebug),o.parallelEnabled!==void 0&&(e.value.parallel.enabled=o.parallelEnabled),o.parallelDeepLearningLockSize!==void 0&&(e.value.parallel.deepLearningLockSize=s(o.parallelDeepLearningLockSize,1)),o.autoSaveInBookshelfMode!==void 0&&(e.value.autoSaveInBookshelfMode=o.autoSaveInBookshelfMode),o.providerSettings&&typeof o.providerSettings=="object"){const c=o.providerSettings;if(c.modelProvider)for(const[l,n]of Object.entries(c.modelProvider))a.value.translation[l]={apiKey:n.apiKey,modelName:n.modelName,customBaseUrl:n.customBaseUrl,rpmLimit:s(n.rpmTranslation,U),maxRetries:s(n.translationMaxRetries,D)};if(c.hqTranslateProvider)for(const[l,n]of Object.entries(c.hqTranslateProvider))a.value.hqTranslation[l]={apiKey:n.hqApiKey,modelName:n.hqModelName,customBaseUrl:n.hqCustomBaseUrl,batchSize:s(n.hqBatchSize,3),sessionReset:s(n.hqSessionReset,20),rpmLimit:s(n.hqRpmLimit,7),maxRetries:s(n.hqMaxRetries,F),lowReasoning:n.hqLowReasoning,noThinkingMethod:n.hqNoThinkingMethod||"gemini",forceJsonOutput:n.hqForceJsonOutput,useStream:n.hqUseStream,prompt:n.hqPrompt};if(c.aiVisionProvider)for(const[l,n]of Object.entries(c.aiVisionProvider))a.value.aiVisionOcr[l]={apiKey:n.aiVisionApiKey,modelName:n.aiVisionModelName,customBaseUrl:n.customAiVisionBaseUrl,prompt:n.aiVisionOcrPrompt,rpmLimit:s(n.rpmAiVisionOcr,B),isJsonMode:n.aiVisionPromptModeSelect==="json",minImageSize:s(n.aiVisionMinImageSize,A)}}console.log("[Settings] 后端设置映射完成")}function ue(){const o={},s={},c={};for(const[l,n]of Object.entries(a.value.translation))o[l]={apiKey:n.apiKey||"",modelName:n.modelName||"",customBaseUrl:n.customBaseUrl||"",rpmTranslation:String(n.rpmLimit||0),translationMaxRetries:String(n.maxRetries||3)};for(const[l,n]of Object.entries(a.value.hqTranslation))s[l]={hqApiKey:n.apiKey||"",hqModelName:n.modelName||"",hqCustomBaseUrl:n.customBaseUrl||"",hqBatchSize:String(n.batchSize||3),hqSessionReset:String(n.sessionReset||20),hqRpmLimit:String(n.rpmLimit||7),hqMaxRetries:String(n.maxRetries||2),hqLowReasoning:n.lowReasoning||!1,hqNoThinkingMethod:n.noThinkingMethod||"gemini",hqForceJsonOutput:n.forceJsonOutput??!0,hqUseStream:n.useStream||!1,hqPrompt:n.prompt||""};for(const[l,n]of Object.entries(a.value.aiVisionOcr))c[l]={aiVisionApiKey:n.apiKey||"",aiVisionModelName:n.modelName||"",customAiVisionBaseUrl:n.customBaseUrl||"",aiVisionOcrPrompt:n.prompt||"",rpmAiVisionOcr:String(n.rpmLimit||0),aiVisionPromptModeSelect:n.isJsonMode?"json":"normal",aiVisionMinImageSize:String(n.minImageSize??A)};return{ocrEngine:{},aiVisionProvider:c,modelProvider:o,hqTranslateProvider:s}}async function ce(){try{const{saveUserSettings:o}=await E(async()=>{const{saveUserSettings:l}=await import("./config.CwRcCkM9.js");return{saveUserSettings:l}},__vite__mapDeps([0,1,2]));O.saveTranslationProviderConfig(e.value.translation.provider),t.saveHqProviderConfig(e.value.hqTranslation.provider),v.saveAiVisionOcrProviderConfig(e.value.aiVisionOcr.provider);const s={ocrEngine:e.value.ocrEngine,sourceLanguage:e.value.sourceLanguage,textDetector:e.value.textDetector,baiduApiKey:e.value.baiduOcr.apiKey,baiduSecretKey:e.value.baiduOcr.secretKey,baiduVersion:e.value.baiduOcr.version,baiduSourceLanguage:e.value.baiduOcr.sourceLanguage,paddleOcrVlSourceLanguage:e.value.paddleOcrVl.sourceLanguage,aiVisionProvider:e.value.aiVisionOcr.provider,aiVisionApiKey:e.value.aiVisionOcr.apiKey,aiVisionModelName:e.value.aiVisionOcr.modelName,aiVisionOcrPrompt:e.value.aiVisionOcr.prompt,customAiVisionBaseUrl:e.value.aiVisionOcr.customBaseUrl,rpmAiVisionOcr:String(e.value.aiVisionOcr.rpmLimit),aiVisionPromptModeSelect:e.value.aiVisionOcr.isJsonMode?"json":"normal",aiVisionMinImageSize:String(e.value.aiVisionOcr.minImageSize),modelProvider:e.value.translation.provider,apiKey:e.value.translation.apiKey,modelName:e.value.translation.modelName,customBaseUrl:e.value.translation.customBaseUrl,rpmTranslation:String(e.value.translation.rpmLimit),translationMaxRetries:String(e.value.translation.maxRetries),translatePromptModeSelect:e.value.translation.isJsonMode?"json":"normal",targetLanguage:e.value.targetLanguage,promptContent:e.value.translatePrompt,enableTextboxPrompt:e.value.useTextboxPrompt,textboxPromptContent:e.value.textboxPrompt,hqTranslateProvider:e.value.hqTranslation.provider,hqApiKey:e.value.hqTranslation.apiKey,hqModelName:e.value.hqTranslation.modelName,hqCustomBaseUrl:e.value.hqTranslation.customBaseUrl,hqBatchSize:String(e.value.hqTranslation.batchSize),hqSessionReset:String(e.value.hqTranslation.sessionReset),hqRpmLimit:String(e.value.hqTranslation.rpmLimit),hqMaxRetries:String(e.value.hqTranslation.maxRetries),hqPrompt:e.value.hqTranslation.prompt,hqLowReasoning:e.value.hqTranslation.lowReasoning,hqNoThinkingMethod:e.value.hqTranslation.noThinkingMethod,hqForceJsonOutput:e.value.hqTranslation.forceJsonOutput,hqUseStream:e.value.hqTranslation.useStream,proofreadingEnabled:e.value.proofreading.enabled,proofreadingMaxRetries:String(e.value.proofreading.maxRetries),proofreading:{enabled:e.value.proofreading.enabled,maxRetries:String(e.value.proofreading.maxRetries),rounds:e.value.proofreading.rounds.map(l=>({name:l.name,provider:l.provider,apiKey:l.apiKey,modelName:l.modelName,customBaseUrl:l.customBaseUrl,prompt:l.prompt,batchSize:l.batchSize,sessionReset:l.sessionReset,rpmLimit:l.rpmLimit,maxRetries:l.maxRetries,lowReasoning:l.lowReasoning,noThinkingMethod:l.noThinkingMethod,forceJsonOutput:l.forceJsonOutput}))},boxExpandRatio:String(e.value.boxExpand.ratio),boxExpandTop:String(e.value.boxExpand.top),boxExpandBottom:String(e.value.boxExpand.bottom),boxExpandLeft:String(e.value.boxExpand.left),boxExpandRight:String(e.value.boxExpand.right),usePreciseMask:e.value.preciseMask.enabled,maskDilateSize:String(e.value.preciseMask.dilateSize),maskBoxExpandRatio:String(e.value.preciseMask.boxExpandRatio||0),pdfProcessingMethod:e.value.pdfProcessingMethod,showDetectionDebug:e.value.showDetectionDebug,parallelEnabled:e.value.parallel.enabled,parallelDeepLearningLockSize:e.value.parallel.deepLearningLockSize,autoSaveInBookshelfMode:e.value.autoSaveInBookshelfMode,providerSettings:ue()},c=await o(s);return c.success?(console.log("[Settings] 设置已保存到后端"),!0):(console.error("[Settings] 保存设置到后端失败:",c),!1)}catch(o){return console.error("[Settings] 保存设置到后端出错:",o),!1}}return{settings:e,providerConfigs:a,customFontPresets:T.customFontPresets,ocrEngine:v.ocrEngine,sourceLanguage:v.sourceLanguage,setOcrEngine:v.setOcrEngine,setSourceLanguage:v.setSourceLanguage,updateBaiduOcr:v.updateBaiduOcr,updatePaddleOcrVl:v.updatePaddleOcrVl,updateAiVisionOcr:v.updateAiVisionOcr,setAiVisionOcrProvider:v.setAiVisionOcrProvider,setAiVisionOcrPromptMode:v.setAiVisionOcrPromptMode,saveAiVisionOcrProviderConfig:v.saveAiVisionOcrProviderConfig,restoreAiVisionOcrProviderConfig:v.restoreAiVisionOcrProviderConfig,translationProvider:O.translationProvider,setTranslationProvider:O.setTranslationProvider,updateTranslationService:O.updateTranslationService,setTranslatePrompt:O.setTranslatePrompt,setTranslatePromptMode:O.setTranslatePromptMode,saveTranslationProviderConfig:O.saveTranslationProviderConfig,restoreTranslationProviderConfig:O.restoreTranslationProviderConfig,setTextDetector:r.setTextDetector,updateBoxExpand:r.updateBoxExpand,updatePreciseMask:r.updatePreciseMask,hqProvider:t.hqProvider,setHqProvider:t.setHqProvider,updateHqTranslation:t.updateHqTranslation,setHqUseStream:t.setHqUseStream,setHqNoThinkingMethod:t.setHqNoThinkingMethod,setHqForceJsonOutput:t.setHqForceJsonOutput,saveHqProviderConfig:t.saveHqProviderConfig,restoreHqProviderConfig:t.restoreHqProviderConfig,isProofreadingEnabled:u.isProofreadingEnabled,setProofreadingEnabled:u.setProofreadingEnabled,addProofreadingRound:u.addProofreadingRound,updateProofreadingRound:u.updateProofreadingRound,removeProofreadingRound:u.removeProofreadingRound,setProofreadingMaxRetries:u.setProofreadingMaxRetries,setTextboxPrompt:M.setTextboxPrompt,setUseTextboxPrompt:M.setUseTextboxPrompt,textStyle:h.textStyle,updateSettings:h.updateSettings,updateTextStyle:h.updateTextStyle,setPdfProcessingMethod:h.setPdfProcessingMethod,setShowDetectionDebug:h.setShowDetectionDebug,setAutoSaveInBookshelfMode:h.setAutoSaveInBookshelfMode,modelHistory:T.modelHistory,addModelToHistory:T.addModelToHistory,getModelHistory:T.getModelHistory,clearModelHistory:T.clearModelHistory,addCustomFontPreset:T.addCustomFontPreset,removeCustomFontPreset:T.removeCustomFontPreset,saveProviderConfig:ae,restoreProviderConfig:ie,saveToStorage:i,loadFromStorage:p,initSettings:te,resetToDefaults:ne,loadFromBackend:se,saveToBackend:ce}}),R=V([]);let ee=0;const ao=3e4,C=e=>{e.timer&&(clearTimeout(e.timer),e.timer=void 0)},y=(e,a="info",i=3e3)=>{const d=++ee,m=`msg_${Date.now()}_${Math.floor(Math.random()*1e3)}`,p={id:d,messageId:m,message:e,type:a,isHTML:!1};return i>0&&(p.timer=setTimeout(()=>{z(d)},i)),R.value.push(p),d},z=e=>{const a=R.value.findIndex(i=>i.id===e);if(a!==-1){const i=R.value[a];i&&C(i),R.value.splice(a,1)}},H=()=>{R.value.forEach(e=>{C(e)}),R.value=[]},io=(e,a)=>y(e,"success",a),ro=(e,a)=>y(e,"error",a),to=(e,a)=>y(e,"info",a),no=(e,a)=>y(e,"warning",a),so=(e,a="info",i=!1,d=5e3,m="")=>{const p=m||`msg_${Date.now()}_${Math.floor(Math.random()*1e3)}`;H();const g=++ee,P={id:g,messageId:p,message:e,type:a,isHTML:i},f=Math.max(d,ao);return P.timer=setTimeout(()=>{z(g)},d>0?d:f),R.value.push(P),p},lo=e=>{if(!e)return;const a=R.value.findIndex(i=>i.messageId===e);if(a!==-1){const i=R.value[a];i&&C(i),R.value.splice(a,1)}},uo=(e="")=>{if(e==="")H();else{const a=[];R.value.forEach((i,d)=>{i.type===e&&(C(i),a.push(d))});for(let i=a.length-1;i>=0;i--){const d=a[i];d!==void 0&&R.value.splice(d,1)}}},x={toasts:R,addToast:y,removeToast:z,clearAll:H,success:io,error:ro,info:to,warning:no,showGeneralMessage:so,clearGeneralMessageById:lo,clearAllGeneralMessages:uo};function bo(){return x}function Uo(e,a="info",i=3e3){return y(e,a,i)}const co={class:"vue-toast-container"},mo=["innerHTML"],po={key:1},fo=["onClick"],vo=X({__name:"ToastNotification",setup(e,{expose:a}){const i=x.toasts,d=m=>{x.removeToast(m)};return de(()=>{x.clearAll()}),a({toasts:i,addToast:x.addToast,removeToast:x.removeToast,clearAll:x.clearAll,success:x.success,error:x.error,info:x.info,warning:x.warning,showGeneralMessage:x.showGeneralMessage,clearGeneralMessageById:x.clearGeneralMessageById,clearAllGeneralMessages:x.clearAllGeneralMessages}),(m,p)=>(S(),pe(he,{to:"body"},[j("div",co,[J(fe,{name:"toast-slide"},{default:ve(()=>[(S(!0),L(W,null,ge(Z(i),g=>(S(),L("div",{key:g.id,class:Te(["vue-toast-message","vue-toast-"+g.type])},[g.isHTML?(S(),L("span",{key:0,innerHTML:g.message},null,8,mo)):(S(),L("span",po,Oe(g.message),1)),j("button",{class:"vue-toast-close",onClick:Pe(P=>d(g.id),["stop"])},"×",8,fo)],2))),128))]),_:1})])]))}}),ho=(e,a)=>{const i=e.__vccOpts||e;for(const[d,m]of a)i[d]=m;return i},go=ho(vo,[["__scopeId","data-v-28b4c9eb"]]),To=X({__name:"App",setup(e){const a=oo();return xe(()=>{a.initSettings()}),(i,d)=>(S(),L(W,null,[J(Z(Re)),J(go)],64))}}),Oo=[{path:"/",name:"bookshelf",component:()=>E(()=>import("./BookshelfView.DwSOaSgZ.js"),__vite__mapDeps([3,4,5,6,1,2,7,8,9,10])),meta:{title:"书架"}},{path:"/translate",name:"translate",component:()=>E(()=>import("./TranslateView.BFz5KsgO.js"),__vite__mapDeps([11,5,7,1,2,0,12,13,8,9,6,14])),meta:{title:"翻译"},props:e=>({bookId:e.query.book,chapterId:e.query.chapter})},{path:"/reader",name:"reader",component:()=>E(()=>import("./ReaderView.DbBchV0Y.js"),__vite__mapDeps([15,5,6,1,2,16])),meta:{title:"阅读器"},props:e=>({bookId:e.query.book,chapterId:e.query.chapter}),beforeEnter:(e,a,i)=>{!e.query.book||!e.query.chapter?i({name:"bookshelf"}):i()}},{path:"/insight",name:"insight",component:()=>E(()=>import("./InsightView.DMWqRhxw.js"),__vite__mapDeps([17,5,4,6,1,2,12,13,8,9,0,18])),meta:{title:"漫画分析"},props:e=>({bookId:e.query.book})},{path:"/:pathMatch(.*)*",redirect:{name:"bookshelf"}}],oe=_e({history:Me("/"),routes:Oo});oe.beforeEach((e,a,i)=>{const d=e.meta.title;document.title=d?`${d} - Saber Translator`:"Saber Translator",i()});const K=Se(To),Po=Ee();K.use(Po);K.use(oe);K.config.errorHandler=(e,a,i)=>{console.error("Vue 错误:",e,i)};K.mount("#app");export{yo as B,Vo as D,Mo as F,Ao as L,No as S,Io as W,ho as _,E as a,Be as b,Ue as c,be as d,Ae as e,Le as f,oo as g,A as h,Ve as i,Q as j,Ne as k,k as l,Ie as m,Ro as n,qo as o,Lo as p,Eo as q,So as r,Uo as s,_o as t,bo as u};
