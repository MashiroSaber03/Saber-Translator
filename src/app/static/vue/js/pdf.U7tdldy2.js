function _mergeNamespaces(N,n){for(var T=0;T<n.length;T++){const a=n[T];if(typeof a!="string"&&!Array.isArray(a)){for(const m in a)if(m!=="default"&&!(m in N)){const I=Object.getOwnPropertyDescriptor(a,m);I&&Object.defineProperty(N,m,I.get?I:{enumerable:!0,get:()=>a[m]})}}}return Object.freeze(Object.defineProperty(N,Symbol.toStringTag,{value:"Module"}))}function getDefaultExportFromCjs(N){return N&&N.__esModule&&Object.prototype.hasOwnProperty.call(N,"default")?N.default:N}function getAugmentedNamespace(N){if(Object.prototype.hasOwnProperty.call(N,"__esModule"))return N;var n=N.default;if(typeof n=="function"){var T=function a(){var m=!1;try{m=this instanceof a}catch{}return m?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};T.prototype=n.prototype}else T={};return Object.defineProperty(T,"__esModule",{value:!0}),Object.keys(N).forEach(function(a){var m=Object.getOwnPropertyDescriptor(N,a);Object.defineProperty(T,a,m.get?m:{enumerable:!0,get:function(){return N[a]}})}),T}function commonjsRequire(N){throw new Error('Could not dynamically require "'+N+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$2={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,(function(module,exports$1){(function(n,T){module.exports=n.pdfjsLib=T()})(globalThis,()=>(()=>{var __webpack_modules__=[,((N,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.VerbosityLevel=n.Util=n.UnknownErrorException=n.UnexpectedResponseException=n.TextRenderingMode=n.RenderingIntentFlag=n.PromiseCapability=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.MAX_IMAGE_SIZE_TO_CACHE=n.LINE_FACTOR=n.LINE_DESCENT_FACTOR=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FeatureTest=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.BASELINE_FACTOR=n.AnnotationType=n.AnnotationReplyType=n.AnnotationPrefix=n.AnnotationMode=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationEditorType=n.AnnotationEditorPrefix=n.AnnotationEditorParamsType=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,n.assert=c,n.bytesToString=L,n.createValidAbsoluteUrl=_,n.getModificationDate=mt,n.getUuid=Nt,n.getVerbosityLevel=nt,n.info=$,n.isArrayBuffer=ut,n.isArrayEqual=At,n.isNodeJS=void 0,n.normalizeUnicode=Dt,n.objectFromMap=V,n.objectSize=st,n.setVerbosityLevel=et,n.shadow=P,n.string32=q,n.stringToBytes=j,n.stringToPDFString=lt,n.stringToUTF8String=ct,n.unreachable=b,n.utf8StringToString=ht,n.warn=F;const T=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=T;const a=[1,0,0,1,0,0];n.IDENTITY_MATRIX=a;const m=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=m;const I=1e7;n.MAX_IMAGE_SIZE_TO_CACHE=I;const x=1.35;n.LINE_FACTOR=x;const B=.35;n.LINE_DESCENT_FACTOR=B;const U=B/x;n.BASELINE_FACTOR=U;const s={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};n.RenderingIntentFlag=s;const t={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};n.AnnotationMode=t;const i="pdfjs_internal_editor_";n.AnnotationEditorPrefix=i;const u={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};n.AnnotationEditorType=u;const l={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};n.AnnotationEditorParamsType=l;const e={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=e;const d={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=d;const p={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=p;const o={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=o;const y={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=y;const M={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=M;const w={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=w;const f={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=f;const v={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=v;const O={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=O;const H={O:"PageOpen",C:"PageClose"};n.PageActionEventType=H;const D={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=D;const G={NONE:0,BINARY:1};n.CMapCompressionType=G;const X={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=X;const it={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=it;let Q=D.WARNINGS;function et(tt){Number.isInteger(tt)&&(Q=tt)}function nt(){return Q}function $(tt){Q>=D.INFOS&&console.log(`Info: ${tt}`)}function F(tt){Q>=D.WARNINGS&&console.log(`Warning: ${tt}`)}function b(tt){throw new Error(tt)}function c(tt,z){tt||b(z)}function h(tt){switch(tt?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function _(tt,z=null,W=null){if(!tt)return null;try{if(W&&typeof tt=="string"&&(W.addDefaultProtocol&&tt.startsWith("www.")&&tt.match(/\./g)?.length>=2&&(tt=`http://${tt}`),W.tryConvertEncoding))try{tt=ct(tt)}catch{}const at=z?new URL(tt,z):new URL(tt);if(h(at))return at}catch{}return null}function P(tt,z,W,at=!1){return Object.defineProperty(tt,z,{value:W,enumerable:!at,configurable:!0,writable:!1}),W}const k=(function(){function z(W,at){this.constructor===z&&b("Cannot initialize BaseException."),this.message=W,this.name=at}return z.prototype=new Error,z.constructor=z,z})();n.BaseException=k;class R extends k{constructor(z,W){super(z,"PasswordException"),this.code=W}}n.PasswordException=R;class S extends k{constructor(z,W){super(z,"UnknownErrorException"),this.details=W}}n.UnknownErrorException=S;class r extends k{constructor(z){super(z,"InvalidPDFException")}}n.InvalidPDFException=r;class g extends k{constructor(z){super(z,"MissingPDFException")}}n.MissingPDFException=g;class A extends k{constructor(z,W){super(z,"UnexpectedResponseException"),this.status=W}}n.UnexpectedResponseException=A;class E extends k{constructor(z){super(z,"FormatError")}}n.FormatError=E;class C extends k{constructor(z){super(z,"AbortException")}}n.AbortException=C;function L(tt){(typeof tt!="object"||tt?.length===void 0)&&b("Invalid argument for bytesToString");const z=tt.length,W=8192;if(z<W)return String.fromCharCode.apply(null,tt);const at=[];for(let dt=0;dt<z;dt+=W){const pt=Math.min(dt+W,z),gt=tt.subarray(dt,pt);at.push(String.fromCharCode.apply(null,gt))}return at.join("")}function j(tt){typeof tt!="string"&&b("Invalid argument for stringToBytes");const z=tt.length,W=new Uint8Array(z);for(let at=0;at<z;++at)W[at]=tt.charCodeAt(at)&255;return W}function q(tt){return String.fromCharCode(tt>>24&255,tt>>16&255,tt>>8&255,tt&255)}function st(tt){return Object.keys(tt).length}function V(tt){const z=Object.create(null);for(const[W,at]of tt)z[W]=at;return z}function Y(){const tt=new Uint8Array(4);return tt[0]=1,new Uint32Array(tt.buffer,0,1)[0]===1}function K(){try{return new Function(""),!0}catch{return!1}}class J{static get isLittleEndian(){return P(this,"isLittleEndian",Y())}static get isEvalSupported(){return P(this,"isEvalSupported",K())}static get isOffscreenCanvasSupported(){return P(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?P(this,"platform",{isWin:!1,isMac:!1}):P(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return P(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}n.FeatureTest=J;const Z=[...Array(256).keys()].map(tt=>tt.toString(16).padStart(2,"0"));class rt{static makeHexColor(z,W,at){return`#${Z[z]}${Z[W]}${Z[at]}`}static scaleMinMax(z,W){let at;z[0]?(z[0]<0&&(at=W[0],W[0]=W[1],W[1]=at),W[0]*=z[0],W[1]*=z[0],z[3]<0&&(at=W[2],W[2]=W[3],W[3]=at),W[2]*=z[3],W[3]*=z[3]):(at=W[0],W[0]=W[2],W[2]=at,at=W[1],W[1]=W[3],W[3]=at,z[1]<0&&(at=W[2],W[2]=W[3],W[3]=at),W[2]*=z[1],W[3]*=z[1],z[2]<0&&(at=W[0],W[0]=W[1],W[1]=at),W[0]*=z[2],W[1]*=z[2]),W[0]+=z[4],W[1]+=z[4],W[2]+=z[5],W[3]+=z[5]}static transform(z,W){return[z[0]*W[0]+z[2]*W[1],z[1]*W[0]+z[3]*W[1],z[0]*W[2]+z[2]*W[3],z[1]*W[2]+z[3]*W[3],z[0]*W[4]+z[2]*W[5]+z[4],z[1]*W[4]+z[3]*W[5]+z[5]]}static applyTransform(z,W){const at=z[0]*W[0]+z[1]*W[2]+W[4],dt=z[0]*W[1]+z[1]*W[3]+W[5];return[at,dt]}static applyInverseTransform(z,W){const at=W[0]*W[3]-W[1]*W[2],dt=(z[0]*W[3]-z[1]*W[2]+W[2]*W[5]-W[4]*W[3])/at,pt=(-z[0]*W[1]+z[1]*W[0]+W[4]*W[1]-W[5]*W[0])/at;return[dt,pt]}static getAxialAlignedBoundingBox(z,W){const at=this.applyTransform(z,W),dt=this.applyTransform(z.slice(2,4),W),pt=this.applyTransform([z[0],z[3]],W),gt=this.applyTransform([z[2],z[1]],W);return[Math.min(at[0],dt[0],pt[0],gt[0]),Math.min(at[1],dt[1],pt[1],gt[1]),Math.max(at[0],dt[0],pt[0],gt[0]),Math.max(at[1],dt[1],pt[1],gt[1])]}static inverseTransform(z){const W=z[0]*z[3]-z[1]*z[2];return[z[3]/W,-z[1]/W,-z[2]/W,z[0]/W,(z[2]*z[5]-z[4]*z[3])/W,(z[4]*z[1]-z[5]*z[0])/W]}static singularValueDecompose2dScale(z){const W=[z[0],z[2],z[1],z[3]],at=z[0]*W[0]+z[1]*W[2],dt=z[0]*W[1]+z[1]*W[3],pt=z[2]*W[0]+z[3]*W[2],gt=z[2]*W[1]+z[3]*W[3],Ct=(at+gt)/2,Tt=Math.sqrt((at+gt)**2-4*(at*gt-pt*dt))/2,Et=Ct+Tt||1,_t=Ct-Tt||1;return[Math.sqrt(Et),Math.sqrt(_t)]}static normalizeRect(z){const W=z.slice(0);return z[0]>z[2]&&(W[0]=z[2],W[2]=z[0]),z[1]>z[3]&&(W[1]=z[3],W[3]=z[1]),W}static intersect(z,W){const at=Math.max(Math.min(z[0],z[2]),Math.min(W[0],W[2])),dt=Math.min(Math.max(z[0],z[2]),Math.max(W[0],W[2]));if(at>dt)return null;const pt=Math.max(Math.min(z[1],z[3]),Math.min(W[1],W[3])),gt=Math.min(Math.max(z[1],z[3]),Math.max(W[1],W[3]));return pt>gt?null:[at,pt,dt,gt]}static bezierBoundingBox(z,W,at,dt,pt,gt,Ct,Tt){const Et=[],_t=[[],[]];let Pt,St,Mt,ft,Ft,Rt,It,Lt;for(let Ot=0;Ot<2;++Ot){if(Ot===0?(St=6*z-12*at+6*pt,Pt=-3*z+9*at-9*pt+3*Ct,Mt=3*at-3*z):(St=6*W-12*dt+6*gt,Pt=-3*W+9*dt-9*gt+3*Tt,Mt=3*dt-3*W),Math.abs(Pt)<1e-12){if(Math.abs(St)<1e-12)continue;ft=-Mt/St,0<ft&&ft<1&&Et.push(ft);continue}It=St*St-4*Mt*Pt,Lt=Math.sqrt(It),!(It<0)&&(Ft=(-St+Lt)/(2*Pt),0<Ft&&Ft<1&&Et.push(Ft),Rt=(-St-Lt)/(2*Pt),0<Rt&&Rt<1&&Et.push(Rt))}let xt=Et.length,yt;const kt=xt;for(;xt--;)ft=Et[xt],yt=1-ft,_t[0][xt]=yt*yt*yt*z+3*yt*yt*ft*at+3*yt*ft*ft*pt+ft*ft*ft*Ct,_t[1][xt]=yt*yt*yt*W+3*yt*yt*ft*dt+3*yt*ft*ft*gt+ft*ft*ft*Tt;return _t[0][kt]=z,_t[1][kt]=W,_t[0][kt+1]=Ct,_t[1][kt+1]=Tt,_t[0].length=_t[1].length=kt+2,[Math.min(..._t[0]),Math.min(..._t[1]),Math.max(..._t[0]),Math.max(..._t[1])]}}n.Util=rt;const ot=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function lt(tt){if(tt[0]>="ï"){let W;if(tt[0]==="þ"&&tt[1]==="ÿ"?W="utf-16be":tt[0]==="ÿ"&&tt[1]==="þ"?W="utf-16le":tt[0]==="ï"&&tt[1]==="»"&&tt[2]==="¿"&&(W="utf-8"),W)try{const at=new TextDecoder(W,{fatal:!0}),dt=j(tt);return at.decode(dt)}catch(at){F(`stringToPDFString: "${at}".`)}}const z=[];for(let W=0,at=tt.length;W<at;W++){const dt=ot[tt.charCodeAt(W)];z.push(dt?String.fromCharCode(dt):tt.charAt(W))}return z.join("")}function ct(tt){return decodeURIComponent(escape(tt))}function ht(tt){return unescape(encodeURIComponent(tt))}function ut(tt){return typeof tt=="object"&&tt?.byteLength!==void 0}function At(tt,z){if(tt.length!==z.length)return!1;for(let W=0,at=tt.length;W<at;W++)if(tt[W]!==z[W])return!1;return!0}function mt(tt=new Date){return[tt.getUTCFullYear().toString(),(tt.getUTCMonth()+1).toString().padStart(2,"0"),tt.getUTCDate().toString().padStart(2,"0"),tt.getUTCHours().toString().padStart(2,"0"),tt.getUTCMinutes().toString().padStart(2,"0"),tt.getUTCSeconds().toString().padStart(2,"0")].join("")}class wt{#t=!1;constructor(){this.promise=new Promise((z,W)=>{this.resolve=at=>{this.#t=!0,z(at)},this.reject=at=>{this.#t=!0,W(at)}})}get settled(){return this.#t}}n.PromiseCapability=wt;let bt=null,vt=null;function Dt(tt){return bt||(bt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,vt=new Map([["ﬅ","ſt"]])),tt.replaceAll(bt,(z,W,at)=>W?W.normalize("NFKC"):vt.get(at))}function Nt(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const tt=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(tt);else for(let z=0;z<32;z++)tt[z]=Math.floor(Math.random()*255);return L(tt)}const Bt="pdfjs_internal_id_";n.AnnotationPrefix=Bt}),((__unused_webpack_module,exports$1,__w_pdfjs_require__)=>{Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.RenderTask=exports$1.PDFWorkerUtil=exports$1.PDFWorker=exports$1.PDFPageProxy=exports$1.PDFDocumentProxy=exports$1.PDFDocumentLoadingTask=exports$1.PDFDataRangeTransport=exports$1.LoopbackPort=exports$1.DefaultStandardFontDataFactory=exports$1.DefaultFilterFactory=exports$1.DefaultCanvasFactory=exports$1.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports$1,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports$1.build=void 0,exports$1.getDocument=getDocument,exports$1.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports$1.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports$1.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports$1.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports$1.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(N){if(typeof N=="string"||N instanceof URL?N={url:N}:(0,_util.isArrayBuffer)(N)&&(N={data:N}),typeof N!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!N.url&&!N.data&&!N.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const n=new PDFDocumentLoadingTask,{docId:T}=n,a=N.url?getUrlProp(N.url):null,m=N.data?getDataProp(N.data):null,I=N.httpHeaders||null,x=N.withCredentials===!0,B=N.password??null,U=N.range instanceof PDFDataRangeTransport?N.range:null,s=Number.isInteger(N.rangeChunkSize)&&N.rangeChunkSize>0?N.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let t=N.worker instanceof PDFWorker?N.worker:null;const i=N.verbosity,u=typeof N.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(N.docBaseUrl)?N.docBaseUrl:null,l=typeof N.cMapUrl=="string"?N.cMapUrl:null,e=N.cMapPacked!==!1,d=N.CMapReaderFactory||DefaultCMapReaderFactory,p=typeof N.standardFontDataUrl=="string"?N.standardFontDataUrl:null,o=N.StandardFontDataFactory||DefaultStandardFontDataFactory,y=N.stopAtErrors!==!0,M=Number.isInteger(N.maxImageSize)&&N.maxImageSize>-1?N.maxImageSize:-1,w=N.isEvalSupported!==!1,f=typeof N.isOffscreenCanvasSupported=="boolean"?N.isOffscreenCanvasSupported:!_util.isNodeJS,v=Number.isInteger(N.canvasMaxAreaInBytes)?N.canvasMaxAreaInBytes:-1,O=typeof N.disableFontFace=="boolean"?N.disableFontFace:_util.isNodeJS,H=N.fontExtraProperties===!0,D=N.enableXfa===!0,G=N.ownerDocument||globalThis.document,X=N.disableRange===!0,it=N.disableStream===!0,Q=N.disableAutoFetch===!0,et=N.pdfBug===!0,nt=U?U.length:N.length??NaN,$=typeof N.useSystemFonts=="boolean"?N.useSystemFonts:!_util.isNodeJS&&!O,F=typeof N.useWorkerFetch=="boolean"?N.useWorkerFetch:d===_display_utils.DOMCMapReaderFactory&&o===_display_utils.DOMStandardFontDataFactory&&l&&p&&(0,_display_utils.isValidFetchUrl)(l,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(p,document.baseURI),b=N.canvasFactory||new DefaultCanvasFactory({ownerDocument:G}),c=N.filterFactory||new DefaultFilterFactory({docId:T,ownerDocument:G}),h=null;(0,_util.setVerbosityLevel)(i);const _={canvasFactory:b,filterFactory:c};if(F||(_.cMapReaderFactory=new d({baseUrl:l,isCompressed:e}),_.standardFontDataFactory=new o({baseUrl:p})),!t){const R={verbosity:i,port:_worker_options.GlobalWorkerOptions.workerPort};t=R.port?PDFWorker.fromPort(R):new PDFWorker(R),n._worker=t}const P={docId:T,apiVersion:"3.11.174",data:m,password:B,disableAutoFetch:Q,rangeChunkSize:s,length:nt,docBaseUrl:u,enableXfa:D,evaluatorOptions:{maxImageSize:M,disableFontFace:O,ignoreErrors:y,isEvalSupported:w,isOffscreenCanvasSupported:f,canvasMaxAreaInBytes:v,fontExtraProperties:H,useSystemFonts:$,cMapUrl:F?l:null,standardFontDataUrl:F?p:null}},k={ignoreErrors:y,isEvalSupported:w,disableFontFace:O,fontExtraProperties:H,enableXfa:D,ownerDocument:G,disableAutoFetch:Q,pdfBug:et,styleElement:h};return t.promise.then(function(){if(n.destroyed)throw new Error("Loading aborted");const R=_fetchDocument(t,P),S=new Promise(function(r){let g;U?g=new _transport_stream.PDFDataTransportStream({length:nt,initialData:U.initialData,progressiveDone:U.progressiveDone,contentDispositionFilename:U.contentDispositionFilename,disableRange:X,disableStream:it},U):m||(g=(E=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(E):(0,_display_utils.isValidFetchUrl)(E.url)?new _displayFetch_stream.PDFFetchStream(E):new _displayNetwork.PDFNetworkStream(E))({url:a,length:nt,httpHeaders:I,withCredentials:x,rangeChunkSize:s,disableRange:X,disableStream:it})),r(g)});return Promise.all([R,S]).then(function([r,g]){if(n.destroyed)throw new Error("Loading aborted");const A=new _message_handler.MessageHandler(T,r,t.port),E=new WorkerTransport(A,n,g,k,_);n._transport=E,A.send("Ready",null)})}).catch(n._capability.reject),n}async function _fetchDocument(N,n){if(N.destroyed)throw new Error("Worker was destroyed");const T=await N.messageHandler.sendWithPromise("GetDocRequest",n,n.data?[n.data.buffer]:null);if(N.destroyed)throw new Error("Worker was destroyed");return T}function getUrlProp(N){if(N instanceof URL)return N.href;try{return new URL(N,window.location).href}catch{if(_util.isNodeJS&&typeof N=="string")return N}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(N){if(_util.isNodeJS&&typeof Buffer<"u"&&N instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(N instanceof Uint8Array&&N.byteLength===N.buffer.byteLength)return N;if(typeof N=="string")return(0,_util.stringToBytes)(N);if(typeof N=="object"&&!isNaN(N?.length)||(0,_util.isArrayBuffer)(N))return new Uint8Array(N);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(n){throw this._worker?.port&&delete this._worker._pendingDestroy,n}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports$1.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(n,T,a=!1,m=null){this.length=n,this.initialData=T,this.progressiveDone=a,this.contentDispositionFilename=m,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(n){this._rangeListeners.push(n)}addProgressListener(n){this._progressListeners.push(n)}addProgressiveReadListener(n){this._progressiveReadListeners.push(n)}addProgressiveDoneListener(n){this._progressiveDoneListeners.push(n)}onDataRange(n,T){for(const a of this._rangeListeners)a(n,T)}onDataProgress(n,T){this._readyCapability.promise.then(()=>{for(const a of this._progressListeners)a(n,T)})}onDataProgressiveRead(n){this._readyCapability.promise.then(()=>{for(const T of this._progressiveReadListeners)T(n)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const n of this._progressiveDoneListeners)n()})}transportReady(){this._readyCapability.resolve()}requestDataRange(n,T){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports$1.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(n,T){this._pdfInfo=n,this._transport=T,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(a=>{if(!a)return a;const m=[];for(const I in a)m.push(...a[I]);return m}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(n){return this._transport.getPage(n)}getPageIndex(n){return this._transport.getPageIndex(n)}getDestinations(){return this._transport.getDestinations()}getDestination(n){return this._transport.getDestination(n)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(n=!1){return this._transport.startCleanup(n||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports$1.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#t=null;#e=!1;constructor(n,T,a,m=!1){this._pageIndex=n,this._pageInfo=T,this._transport=a,this._stats=m?new _display_utils.StatTimer:null,this._pdfBug=m,this.commonObjs=a.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:n,rotation:T=this.rotate,offsetX:a=0,offsetY:m=0,dontFlip:I=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:n,rotation:T,offsetX:a,offsetY:m,dontFlip:I})}getAnnotations({intent:n="display"}={}){const T=this._transport.getRenderingIntent(n);return this._transport.getAnnotations(this._pageIndex,T.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:n,viewport:T,intent:a="display",annotationMode:m=_util.AnnotationMode.ENABLE,transform:I=null,background:x=null,optionalContentConfigPromise:B=null,annotationCanvasMap:U=null,pageColors:s=null,printAnnotationStorage:t=null}){this._stats?.time("Overall");const i=this._transport.getRenderingIntent(a,m,t);this.#e=!1,this.#s(),B||(B=this._transport.getOptionalContentConfig());let u=this._intentStates.get(i.cacheKey);u||(u=Object.create(null),this._intentStates.set(i.cacheKey,u)),u.streamReaderCancelTimeout&&(clearTimeout(u.streamReaderCancelTimeout),u.streamReaderCancelTimeout=null);const l=!!(i.renderingIntent&_util.RenderingIntentFlag.PRINT);u.displayReadyCapability||(u.displayReadyCapability=new _util.PromiseCapability,u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(i));const e=o=>{u.renderTasks.delete(d),(this._maybeCleanupAfterRender||l)&&(this.#e=!0),this.#i(!l),o?(d.capability.reject(o),this._abortOperatorList({intentState:u,reason:o instanceof Error?o:new Error(o)})):d.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},d=new InternalRenderTask({callback:e,params:{canvasContext:n,viewport:T,transform:I,background:x},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:U,operatorList:u.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!l,pdfBug:this._pdfBug,pageColors:s});(u.renderTasks||=new Set).add(d);const p=d.task;return Promise.all([u.displayReadyCapability.promise,B]).then(([o,y])=>{if(this.destroyed){e();return}this._stats?.time("Rendering"),d.initializeGraphics({transparency:o,optionalContentConfig:y}),d.operatorListChanged()}).catch(e),p}getOperatorList({intent:n="display",annotationMode:T=_util.AnnotationMode.ENABLE,printAnnotationStorage:a=null}={}){function m(){x.operatorList.lastChunk&&(x.opListReadCapability.resolve(x.operatorList),x.renderTasks.delete(B))}const I=this._transport.getRenderingIntent(n,T,a,!0);let x=this._intentStates.get(I.cacheKey);x||(x=Object.create(null),this._intentStates.set(I.cacheKey,x));let B;return x.opListReadCapability||(B=Object.create(null),B.operatorListChanged=m,x.opListReadCapability=new _util.PromiseCapability,(x.renderTasks||=new Set).add(B),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(I)),x.opListReadCapability.promise}streamTextContent({includeMarkedContent:n=!1,disableNormalization:T=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:n===!0,disableNormalization:T===!0},{highWaterMark:100,size(m){return m.items.length}})}getTextContent(n={}){if(this._transport._htmlForXfa)return this.getXfa().then(a=>_xfa_text.XfaText.textContent(a));const T=this.streamTextContent(n);return new Promise(function(a,m){function I(){x.read().then(function({value:U,done:s}){if(s){a(B);return}Object.assign(B.styles,U.styles),B.items.push(...U.items),I()},m)}const x=T.getReader(),B={items:[],styles:Object.create(null)};I()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const n=[];for(const T of this._intentStates.values())if(this._abortOperatorList({intentState:T,reason:new Error("Page was destroyed."),force:!0}),!T.opListReadCapability)for(const a of T.renderTasks)n.push(a.completed),a.cancel();return this.objs.clear(),this.#e=!1,this.#s(),Promise.all(n)}cleanup(n=!1){this.#e=!0;const T=this.#i(!1);return n&&T&&(this._stats&&=new _display_utils.StatTimer),T}#i(n=!1){if(this.#s(),!this.#e||this.destroyed)return!1;if(n)return this.#t=setTimeout(()=>{this.#t=null,this.#i(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:T,operatorList:a}of this._intentStates.values())if(T.size>0||!a.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#s(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(n,T){const a=this._intentStates.get(T);a&&(this._stats?.timeEnd("Page Request"),a.displayReadyCapability?.resolve(n))}_renderPageChunk(n,T){for(let a=0,m=n.length;a<m;a++)T.operatorList.fnArray.push(n.fnArray[a]),T.operatorList.argsArray.push(n.argsArray[a]);T.operatorList.lastChunk=n.lastChunk,T.operatorList.separateAnnots=n.separateAnnots;for(const a of T.renderTasks)a.operatorListChanged();n.lastChunk&&this.#i(!0)}_pumpOperatorList({renderingIntent:n,cacheKey:T,annotationStorageSerializable:a}){const{map:m,transfers:I}=a,B=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:n,cacheKey:T,annotationStorage:m},I).getReader(),U=this._intentStates.get(T);U.streamReader=B;const s=()=>{B.read().then(({value:t,done:i})=>{if(i){U.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(t,U),s())},t=>{if(U.streamReader=null,!this._transport.destroyed){if(U.operatorList){U.operatorList.lastChunk=!0;for(const i of U.renderTasks)i.operatorListChanged();this.#i(!0)}if(U.displayReadyCapability)U.displayReadyCapability.reject(t);else if(U.opListReadCapability)U.opListReadCapability.reject(t);else throw t}})};s()}_abortOperatorList({intentState:n,reason:T,force:a=!1}){if(n.streamReader){if(n.streamReaderCancelTimeout&&(clearTimeout(n.streamReaderCancelTimeout),n.streamReaderCancelTimeout=null),!a){if(n.renderTasks.size>0)return;if(T instanceof _display_utils.RenderingCancelledException){let m=RENDERING_CANCELLED_TIMEOUT;T.extraDelay>0&&T.extraDelay<1e3&&(m+=T.extraDelay),n.streamReaderCancelTimeout=setTimeout(()=>{n.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:n,reason:T,force:!0})},m);return}}if(n.streamReader.cancel(new _util.AbortException(T.message)).catch(()=>{}),n.streamReader=null,!this._transport.destroyed){for(const[m,I]of this._intentStates)if(I===n){this._intentStates.delete(m);break}this.cleanup()}}}get stats(){return this._stats}}exports$1.PDFPageProxy=PDFPageProxy;class LoopbackPort{#t=new Set;#e=Promise.resolve();postMessage(n,T){const a={data:structuredClone(n,T?{transfer:T}:null)};this.#e.then(()=>{for(const m of this.#t)m.call(this,a)})}addEventListener(n,T){this.#t.add(T)}removeEventListener(n,T){this.#t.delete(T)}terminate(){this.#t.clear()}}exports$1.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports$1.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const N=document?.currentScript?.src;N&&(PDFWorkerUtil.fallbackWorkerSrc=N.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(N,n){let T;try{if(T=new URL(N),!T.origin||T.origin==="null")return!1}catch{return!1}const a=new URL(n,T);return T.origin===a.origin},PDFWorkerUtil.createCDNWrapper=function(N){const n=`importScripts("${N}");`;return URL.createObjectURL(new Blob([n]))}}class PDFWorker{static#workerPorts;constructor({name:N=null,port:n=null,verbosity:T=(0,_util.getVerbosityLevel)()}={}){if(this.name=N,this.destroyed=!1,this.verbosity=T,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,n){if(PDFWorker.#workerPorts?.has(n))throw new Error("Cannot use more than one PDFWorker per port.");(PDFWorker.#workerPorts||=new WeakMap).set(n,this),this._initializeFromPort(n);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(N){this._port=N,this._messageHandler=new _message_handler.MessageHandler("main","worker",N),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:N}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,N)||(N=PDFWorkerUtil.createCDNWrapper(new URL(N,window.location).href));const n=new Worker(N),T=new _message_handler.MessageHandler("main","worker",n),a=()=>{n.removeEventListener("error",m),T.destroy(),n.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},m=()=>{this._webWorker||a()};n.addEventListener("error",m),T.on("test",x=>{if(n.removeEventListener("error",m),this.destroyed){a();return}x?(this._messageHandler=T,this._port=n,this._webWorker=n,this._readyCapability.resolve(),T.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),T.destroy(),n.terminate())}),T.on("ready",x=>{if(n.removeEventListener("error",m),this.destroyed){a();return}try{I()}catch{this._setupFakeWorker()}});const I=()=>{const x=new Uint8Array;T.send("test",x,[x.buffer])};I();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(N=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const n=new LoopbackPort;this._port=n;const T=`fake${PDFWorkerUtil.fakeWorkerId++}`,a=new _message_handler.MessageHandler(T+"_worker",T,n);N.setup(a,n);const m=new _message_handler.MessageHandler(T,T+"_worker",n);this._messageHandler=m,this._readyCapability.resolve(),m.send("configure",{verbosity:this.verbosity})}).catch(N=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${N.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(N){if(!N?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const n=this.#workerPorts?.get(N.port);if(n){if(n._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return n}return new PDFWorker(N)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports$1.PDFWorker=PDFWorker;class WorkerTransport{#t=new Map;#e=new Map;#i=new Map;#s=null;constructor(n,T,a,m,I){this.messageHandler=n,this.loadingTask=T,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:m.ownerDocument,styleElement:m.styleElement}),this._params=m,this.canvasFactory=I.canvasFactory,this.filterFactory=I.filterFactory,this.cMapReaderFactory=I.cMapReaderFactory,this.standardFontDataFactory=I.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=a,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#o(n,T=null){const a=this.#t.get(n);if(a)return a;const m=this.messageHandler.sendWithPromise(n,T);return this.#t.set(n,m),m}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(n,T=_util.AnnotationMode.ENABLE,a=null,m=!1){let I=_util.RenderingIntentFlag.DISPLAY,x=_annotation_storage.SerializableEmpty;switch(n){case"any":I=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":I=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${n}`)}switch(T){case _util.AnnotationMode.DISABLE:I+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:I+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:I+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,x=(I&_util.RenderingIntentFlag.PRINT&&a instanceof _annotation_storage.PrintAnnotationStorage?a:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${T}`)}return m&&(I+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:I,cacheKey:`${I}_${x.hash}`,annotationStorageSerializable:x}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const n=[];for(const a of this.#e.values())n.push(a._destroy());this.#e.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const T=this.messageHandler.sendWithPromise("Terminate",null);return n.push(T),Promise.all(n).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:n,loadingTask:T}=this;n.on("GetReader",(a,m)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=I=>{this._lastProgress={loaded:I.loaded,total:I.total}},m.onPull=()=>{this._fullReader.read().then(function({value:I,done:x}){if(x){m.close();return}(0,_util.assert)(I instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),m.enqueue(new Uint8Array(I),1,[I])}).catch(I=>{m.error(I)})},m.onCancel=I=>{this._fullReader.cancel(I),m.ready.catch(x=>{if(!this.destroyed)throw x})}}),n.on("ReaderHeadersReady",a=>{const m=new _util.PromiseCapability,I=this._fullReader;return I.headersReady.then(()=>{(!I.isStreamingSupported||!I.isRangeSupported)&&(this._lastProgress&&T.onProgress?.(this._lastProgress),I.onProgress=x=>{T.onProgress?.({loaded:x.loaded,total:x.total})}),m.resolve({isStreamingSupported:I.isStreamingSupported,isRangeSupported:I.isRangeSupported,contentLength:I.contentLength})},m.reject),m.promise}),n.on("GetRangeReader",(a,m)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const I=this._networkStream.getRangeReader(a.begin,a.end);if(!I){m.close();return}m.onPull=()=>{I.read().then(function({value:x,done:B}){if(B){m.close();return}(0,_util.assert)(x instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),m.enqueue(new Uint8Array(x),1,[x])}).catch(x=>{m.error(x)})},m.onCancel=x=>{I.cancel(x),m.ready.catch(B=>{if(!this.destroyed)throw B})}}),n.on("GetDoc",({pdfInfo:a})=>{this._numPages=a.numPages,this._htmlForXfa=a.htmlForXfa,delete a.htmlForXfa,T._capability.resolve(new PDFDocumentProxy(a,this))}),n.on("DocException",function(a){let m;switch(a.name){case"PasswordException":m=new _util.PasswordException(a.message,a.code);break;case"InvalidPDFException":m=new _util.InvalidPDFException(a.message);break;case"MissingPDFException":m=new _util.MissingPDFException(a.message);break;case"UnexpectedResponseException":m=new _util.UnexpectedResponseException(a.message,a.status);break;case"UnknownErrorException":m=new _util.UnknownErrorException(a.message,a.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}T._capability.reject(m)}),n.on("PasswordRequest",a=>{if(this.#s=new _util.PromiseCapability,T.onPassword){const m=I=>{I instanceof Error?this.#s.reject(I):this.#s.resolve({password:I})};try{T.onPassword(m,a.code)}catch(I){this.#s.reject(I)}}else this.#s.reject(new _util.PasswordException(a.message,a.code));return this.#s.promise}),n.on("DataLoaded",a=>{T.onProgress?.({loaded:a.length,total:a.length}),this.downloadInfoCapability.resolve(a)}),n.on("StartRenderPage",a=>{if(this.destroyed)return;this.#e.get(a.pageIndex)._startRenderPage(a.transparency,a.cacheKey)}),n.on("commonobj",([a,m,I])=>{if(!this.destroyed&&!this.commonObjs.has(a))switch(m){case"Font":const x=this._params;if("error"in I){const s=I.error;(0,_util.warn)(`Error during font loading: ${s}`),this.commonObjs.resolve(a,s);break}const B=x.pdfBug&&globalThis.FontInspector?.enabled?(s,t)=>globalThis.FontInspector.fontAdded(s,t):null,U=new _font_loader.FontFaceObject(I,{isEvalSupported:x.isEvalSupported,disableFontFace:x.disableFontFace,ignoreErrors:x.ignoreErrors,inspectFont:B});this.fontLoader.bind(U).catch(s=>n.sendWithPromise("FontFallback",{id:a})).finally(()=>{!x.fontExtraProperties&&U.data&&(U.data=null),this.commonObjs.resolve(a,U)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(a,I);break;default:throw new Error(`Got unknown common object type ${m}`)}}),n.on("obj",([a,m,I,x])=>{if(this.destroyed)return;const B=this.#e.get(m);if(!B.objs.has(a))switch(I){case"Image":if(B.objs.resolve(a,x),x){let U;if(x.bitmap){const{width:s,height:t}=x;U=s*t*4}else U=x.data?.length||0;U>_util.MAX_IMAGE_SIZE_TO_CACHE&&(B._maybeCleanupAfterRender=!0)}break;case"Pattern":B.objs.resolve(a,x);break;default:throw new Error(`Got unknown object type ${I}`)}}),n.on("DocProgress",a=>{this.destroyed||T.onProgress?.({loaded:a.loaded,total:a.total})}),n.on("FetchBuiltInCMap",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(a):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),n.on("FetchStandardFontData",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(a):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:n,transfers:T}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:n,filename:this._fullReader?.filename??null},T).finally(()=>{this.annotationStorage.resetModified()})}getPage(n){if(!Number.isInteger(n)||n<=0||n>this._numPages)return Promise.reject(new Error("Invalid page request."));const T=n-1,a=this.#i.get(T);if(a)return a;const m=this.messageHandler.sendWithPromise("GetPage",{pageIndex:T}).then(I=>{if(this.destroyed)throw new Error("Transport destroyed");const x=new PDFPageProxy(T,I,this,this._params.pdfBug);return this.#e.set(T,x),x});return this.#i.set(T,m),m}getPageIndex(n){return typeof n!="object"||n===null||!Number.isInteger(n.num)||n.num<0||!Number.isInteger(n.gen)||n.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:n.num,gen:n.gen})}getAnnotations(n,T){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:n,intent:T})}getFieldObjects(){return this.#o("GetFieldObjects")}hasJSActions(){return this.#o("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(n){return typeof n!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:n})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#o("GetDocJSActions")}getPageJSActions(n){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:n})}getStructTree(n){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:n})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(n=>new _optional_content_config.OptionalContentConfig(n))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const n="GetMetadata",T=this.#t.get(n);if(T)return T;const a=this.messageHandler.sendWithPromise(n,null).then(m=>({info:m[0],metadata:m[1]?new _metadata.Metadata(m[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(n,a),a}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(n=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const T of this.#e.values())if(!T.cleanup())throw new Error(`startCleanup: Page ${T.pageNumber} is currently rendering.`);this.commonObjs.clear(),n||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:n,enableXfa:T}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:n,enableXfa:T})}}class PDFObjects{#t=Object.create(null);#e(n){return this.#t[n]||={capability:new _util.PromiseCapability,data:null}}get(n,T=null){if(T){const m=this.#e(n);return m.capability.promise.then(()=>T(m.data)),null}const a=this.#t[n];if(!a?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${n}.`);return a.data}has(n){return this.#t[n]?.capability.settled||!1}resolve(n,T=null){const a=this.#e(n);a.data=T,a.capability.resolve()}clear(){for(const n in this.#t){const{data:T}=this.#t[n];T?.bitmap?.close()}this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(n){this.#t=n,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(n=0){this.#t.cancel(null,n)}get separateAnnots(){const{separateAnnots:n}=this.#t.operatorList;if(!n)return!1;const{annotationCanvasMap:T}=this.#t;return n.form||n.canvas&&T?.size>0}}exports$1.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:n,params:T,objs:a,commonObjs:m,annotationCanvasMap:I,operatorList:x,pageIndex:B,canvasFactory:U,filterFactory:s,useRequestAnimationFrame:t=!1,pdfBug:i=!1,pageColors:u=null}){this.callback=n,this.params=T,this.objs=a,this.commonObjs=m,this.annotationCanvasMap=I,this.operatorListIdx=null,this.operatorList=x,this._pageIndex=B,this.canvasFactory=U,this.filterFactory=s,this._pdfBug=i,this.pageColors=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=t===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=T.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:n=!1,optionalContentConfig:T}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:a,viewport:m,transform:I,background:x}=this.params;this.gfx=new _canvas.CanvasGraphics(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:T},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:I,viewport:m,transparency:n,background:x}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(n=null,T=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback(n||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,T))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback())))}}const version="3.11.174";exports$1.version=version;const build="ce8716743";exports$1.build=build}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SerializableEmpty=n.PrintAnnotationStorage=n.AnnotationStorage=void 0;var a=T(1),m=T(4),I=T(8);const x=Object.freeze({map:null,hash:"",transfers:void 0});n.SerializableEmpty=x;class B{#t=!1;#e=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const u=this.#e.get(t);return u===void 0?i:Object.assign(i,u)}getRawValue(t){return this.#e.get(t)}remove(t){if(this.#e.delete(t),this.#e.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const i of this.#e.values())if(i instanceof m.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(t,i){const u=this.#e.get(t);let l=!1;if(u!==void 0)for(const[e,d]of Object.entries(i))u[e]!==d&&(l=!0,u[e]=d);else l=!0,this.#e.set(t,i);l&&this.#i(),i instanceof m.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type)}has(t){return this.#e.has(t)}getAll(){return this.#e.size>0?(0,a.objectFromMap)(this.#e):null}setAll(t){for(const[i,u]of Object.entries(t))this.setValue(i,u)}get size(){return this.#e.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new U(this)}get serializable(){if(this.#e.size===0)return x;const t=new Map,i=new I.MurmurHash3_64,u=[],l=Object.create(null);let e=!1;for(const[d,p]of this.#e){const o=p instanceof m.AnnotationEditor?p.serialize(!1,l):p;o&&(t.set(d,o),i.update(`${d}:${JSON.stringify(o)}`),e||=!!o.bitmap)}if(e)for(const d of t.values())d.bitmap&&u.push(d.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfers:u}:x}}n.AnnotationStorage=B;class U extends B{#t;constructor(t){super();const{map:i,hash:u,transfers:l}=t.serializable,e=structuredClone(i,l?{transfer:l}:null);this.#t={map:e,hash:u,transfers:l}}get print(){(0,a.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}n.PrintAnnotationStorage=U}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditor=void 0;var a=T(5),m=T(1),I=T(6);class x{#t="";#e=!1;#i=null;#s=null;#o=null;#a=!1;#r=null;#l=this.focusin.bind(this);#c=this.focusout.bind(this);#n=!1;#f=!1;#d=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#u=!1;#p=x._zIndex++;static _borderLineWidth=-1;static _colorManager=new a.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(s){this.constructor===x&&(0,m.unreachable)("Cannot initialize AnnotationEditor."),this.parent=s.parent,this.id=s.id,this.width=this.height=null,this.pageIndex=s.parent.pageIndex,this.name=s.name,this.div=null,this._uiManager=s.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=s.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:u,pageX:l,pageY:e}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,u],this.pageTranslation=[l,e];const[d,p]=this.parentDimensions;this.x=s.x/d,this.y=s.y/p,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,m.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(s){const t=new B({id:s.parent.getNextId(),parent:s.parent,uiManager:s._uiManager});t.annotationElementId=s.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(s,t=null){if(x._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(u=>[u,s.get(u)])),t?.strings)for(const u of t.strings)x._l10nPromise.set(u,s.get(u));if(x._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);x._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(s,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(s){return!1}static paste(s,t){(0,m.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#u}set _isDraggable(s){this.#u=s,this.div?.classList.toggle("draggable",s)}center(){const[s,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(s*2),this.y+=this.width*s/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(s*2),this.y-=this.width*s/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(s){this._uiManager.addCommands(s)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#p}setParent(s){s!==null&&(this.pageIndex=s.pageIndex,this.pageDimensions=s.pageDimensions),this.parent=s}focusin(s){this._focusEventsAllowed&&(this.#n?this.#n=!1:this.parent.setSelected(this))}focusout(s){!this._focusEventsAllowed||!this.isAttachedToDOM||s.relatedTarget?.closest(`#${this.id}`)||(s.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(s,t,i,u){const[l,e]=this.parentDimensions;[i,u]=this.screenToPageTranslation(i,u),this.x=(s+i)/l,this.y=(t+u)/e,this.fixAndSetPosition()}#b([s,t],i,u){[i,u]=this.screenToPageTranslation(i,u),this.x+=i/s,this.y+=u/t,this.fixAndSetPosition()}translate(s,t){this.#b(this.parentDimensions,s,t)}translateInPage(s,t){this.#b(this.pageDimensions,s,t),this.div.scrollIntoView({block:"nearest"})}drag(s,t){const[i,u]=this.parentDimensions;if(this.x+=s/i,this.y+=t/u,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:o,y}=this.div.getBoundingClientRect();this.parent.findNewParent(this,o,y)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:e}=this;const[d,p]=this.#m();l+=d,e+=p,this.div.style.left=`${(100*l).toFixed(2)}%`,this.div.style.top=`${(100*e).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#m(){const[s,t]=this.parentDimensions,{_borderLineWidth:i}=x,u=i/s,l=i/t;switch(this.rotation){case 90:return[-u,l];case 180:return[u,l];case 270:return[u,-l];default:return[-u,-l]}}fixAndSetPosition(){const[s,t]=this.pageDimensions;let{x:i,y:u,width:l,height:e}=this;switch(l*=s,e*=t,i*=s,u*=t,this.rotation){case 0:i=Math.max(0,Math.min(s-l,i)),u=Math.max(0,Math.min(t-e,u));break;case 90:i=Math.max(0,Math.min(s-e,i)),u=Math.min(t,Math.max(l,u));break;case 180:i=Math.min(s,Math.max(l,i)),u=Math.min(t,Math.max(e,u));break;case 270:i=Math.min(s,Math.max(e,i)),u=Math.max(0,Math.min(t-l,u));break}this.x=i/=s,this.y=u/=t;const[d,p]=this.#m();i+=d,u+=p;const{style:o}=this.div;o.left=`${(100*i).toFixed(2)}%`,o.top=`${(100*u).toFixed(2)}%`,this.moveInDOM()}static#g(s,t,i){switch(i){case 90:return[t,-s];case 180:return[-s,-t];case 270:return[-t,s];default:return[s,t]}}screenToPageTranslation(s,t){return x.#g(s,t,this.parentRotation)}pageTranslationToScreen(s,t){return x.#g(s,t,360-this.parentRotation)}#h(s){switch(s){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:s,pageDimensions:[t,i]}=this,u=t*s,l=i*s;return m.FeatureTest.isCSSRoundSupported?[Math.round(u),Math.round(l)]:[u,l]}setDims(s,t){const[i,u]=this.parentDimensions;this.div.style.width=`${(100*s/i).toFixed(2)}%`,this.#a||(this.div.style.height=`${(100*t/u).toFixed(2)}%`),this.#i?.classList.toggle("small",s<x.SMALL_EDITOR_SIZE||t<x.SMALL_EDITOR_SIZE)}fixDims(){const{style:s}=this.div,{height:t,width:i}=s,u=i.endsWith("%"),l=!this.#a&&t.endsWith("%");if(u&&l)return;const[e,d]=this.parentDimensions;u||(s.width=`${(100*parseFloat(i)/e).toFixed(2)}%`),!this.#a&&!l&&(s.height=`${(100*parseFloat(t)/d).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#_(){if(this.#r)return;this.#r=document.createElement("div"),this.#r.classList.add("resizers");const s=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||s.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const t of s){const i=document.createElement("div");this.#r.append(i),i.classList.add("resizer",t),i.addEventListener("pointerdown",this.#E.bind(this,t)),i.addEventListener("contextmenu",I.noContextMenu)}this.div.prepend(this.#r)}#E(s,t){t.preventDefault();const{isMac:i}=m.FeatureTest.platform;if(t.button!==0||t.ctrlKey&&i)return;const u=this.#S.bind(this,s),l=this._isDraggable;this._isDraggable=!1;const e={passive:!0,capture:!0};window.addEventListener("pointermove",u,e);const d=this.x,p=this.y,o=this.width,y=this.height,M=this.parent.div.style.cursor,w=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const f=()=>{this._isDraggable=l,window.removeEventListener("pointerup",f),window.removeEventListener("blur",f),window.removeEventListener("pointermove",u,e),this.parent.div.style.cursor=M,this.div.style.cursor=w;const v=this.x,O=this.y,H=this.width,D=this.height;v===d&&O===p&&H===o&&D===y||this.addCommands({cmd:()=>{this.width=H,this.height=D,this.x=v,this.y=O;const[G,X]=this.parentDimensions;this.setDims(G*H,X*D),this.fixAndSetPosition()},undo:()=>{this.width=o,this.height=y,this.x=d,this.y=p;const[G,X]=this.parentDimensions;this.setDims(G*o,X*y),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",f),window.addEventListener("blur",f)}#S(s,t){const[i,u]=this.parentDimensions,l=this.x,e=this.y,d=this.width,p=this.height,o=x.MIN_SIZE/i,y=x.MIN_SIZE/u,M=S=>Math.round(S*1e4)/1e4,w=this.#h(this.rotation),f=(S,r)=>[w[0]*S+w[2]*r,w[1]*S+w[3]*r],v=this.#h(360-this.rotation),O=(S,r)=>[v[0]*S+v[2]*r,v[1]*S+v[3]*r];let H,D,G=!1,X=!1;switch(s){case"topLeft":G=!0,H=(S,r)=>[0,0],D=(S,r)=>[S,r];break;case"topMiddle":H=(S,r)=>[S/2,0],D=(S,r)=>[S/2,r];break;case"topRight":G=!0,H=(S,r)=>[S,0],D=(S,r)=>[0,r];break;case"middleRight":X=!0,H=(S,r)=>[S,r/2],D=(S,r)=>[0,r/2];break;case"bottomRight":G=!0,H=(S,r)=>[S,r],D=(S,r)=>[0,0];break;case"bottomMiddle":H=(S,r)=>[S/2,r],D=(S,r)=>[S/2,0];break;case"bottomLeft":G=!0,H=(S,r)=>[0,r],D=(S,r)=>[S,0];break;case"middleLeft":X=!0,H=(S,r)=>[0,r/2],D=(S,r)=>[S,r/2];break}const it=H(d,p),Q=D(d,p);let et=f(...Q);const nt=M(l+et[0]),$=M(e+et[1]);let F=1,b=1,[c,h]=this.screenToPageTranslation(t.movementX,t.movementY);if([c,h]=O(c/i,h/u),G){const S=Math.hypot(d,p);F=b=Math.max(Math.min(Math.hypot(Q[0]-it[0]-c,Q[1]-it[1]-h)/S,1/d,1/p),o/d,y/p)}else X?F=Math.max(o,Math.min(1,Math.abs(Q[0]-it[0]-c)))/d:b=Math.max(y,Math.min(1,Math.abs(Q[1]-it[1]-h)))/p;const _=M(d*F),P=M(p*b);et=f(...D(_,P));const k=nt-et[0],R=$-et[1];this.width=_,this.height=P,this.x=k,this.y=R,this.setDims(i*_,u*P),this.fixAndSetPosition()}async addAltTextButton(){if(this.#i)return;const s=this.#i=document.createElement("button");s.className="altText";const t=await x._l10nPromise.get("editor_alt_text_button_label");s.textContent=t,s.setAttribute("aria-label",t),s.tabIndex="0",s.addEventListener("contextmenu",I.noContextMenu),s.addEventListener("pointerdown",i=>i.stopPropagation()),s.addEventListener("click",i=>{i.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),s.addEventListener("keydown",i=>{i.target===s&&i.key==="Enter"&&(i.preventDefault(),this._uiManager.editAltText(this))}),this.#T(),this.div.append(s),x.SMALL_EDITOR_SIZE||(x.SMALL_EDITOR_SIZE=Math.min(128,Math.round(s.getBoundingClientRect().width*1.4)))}async#T(){const s=this.#i;if(!s)return;if(!this.#t&&!this.#e){s.classList.remove("done"),this.#s?.remove();return}x._l10nPromise.get("editor_alt_text_edit_button_label").then(i=>{s.setAttribute("aria-label",i)});let t=this.#s;if(!t){this.#s=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip");const i=t.id=`alt-text-tooltip-${this.id}`;s.setAttribute("aria-describedby",i);const u=100;s.addEventListener("mouseenter",()=>{this.#o=setTimeout(()=>{this.#o=null,this.#s.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},u)}),s.addEventListener("mouseleave",()=>{clearTimeout(this.#o),this.#o=null,this.#s?.classList.remove("show")})}s.classList.add("done"),t.innerText=this.#e?await x._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#t,t.parentNode||s.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#t,decorative:this.#e}}set altTextData({altText:s,decorative:t}){this.#t===s&&this.#e===t||(this.#t=s,this.#e=t,this.#T())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#l),this.div.addEventListener("focusout",this.#c);const[s,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/s).toFixed(2)}%`,this.div.style.maxHeight=`${(100*s/t).toFixed(2)}%`);const[i,u]=this.getInitialTranslation();return this.translate(i,u),(0,a.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(s){const{isMac:t}=m.FeatureTest.platform;if(s.button!==0||s.ctrlKey&&t){s.preventDefault();return}this.#n=!0,this.#x(s)}#x(s){if(!this._isDraggable)return;const t=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let i,u;t&&(i={passive:!0,capture:!0},u=e=>{const[d,p]=this.screenToPageTranslation(e.movementX,e.movementY);this._uiManager.dragSelectedEditors(d,p)},window.addEventListener("pointermove",u,i));const l=()=>{if(window.removeEventListener("pointerup",l),window.removeEventListener("blur",l),t&&window.removeEventListener("pointermove",u,i),this.#n=!1,!this._uiManager.endDragSession()){const{isMac:e}=m.FeatureTest.platform;s.ctrlKey&&!e||s.shiftKey||s.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",l),window.addEventListener("blur",l)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(s,t,i){s.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition()}getRect(s,t){const i=this.parentScale,[u,l]=this.pageDimensions,[e,d]=this.pageTranslation,p=s/i,o=t/i,y=this.x*u,M=this.y*l,w=this.width*u,f=this.height*l;switch(this.rotation){case 0:return[y+p+e,l-M-o-f+d,y+p+w+e,l-M-o+d];case 90:return[y+o+e,l-M+p+d,y+o+f+e,l-M+p+w+d];case 180:return[y-p-w+e,l-M+o+d,y-p+e,l-M+o+f+d];case 270:return[y-o-f+e,l-M-p-w+d,y-o+e,l-M-p+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(s,t){const[i,u,l,e]=s,d=l-i,p=e-u;switch(this.rotation){case 0:return[i,t-e,d,p];case 90:return[i,t-u,p,d];case 180:return[l,t-u,d,p];case 270:return[l,t-e,p,d];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#d=!0}disableEditMode(){this.#d=!1}isInEditMode(){return this.#d}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#l),this.div?.addEventListener("focusout",this.#c)}serialize(s=!1,t=null){(0,m.unreachable)("An editor must be serializable")}static deserialize(s,t,i){const u=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});u.rotation=s.rotation;const[l,e]=u.pageDimensions,[d,p,o,y]=u.getRectInCurrentCoords(s.rect,e);return u.x=d/l,u.y=p/e,u.width=o/l,u.height=y/e,u}remove(){this.div.removeEventListener("focusin",this.#l),this.div.removeEventListener("focusout",this.#c),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#i?.remove(),this.#i=null,this.#s=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#_(),this.#r.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#r?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(s,t){}disableEditing(){this.#i&&(this.#i.hidden=!0)}enableEditing(){this.#i&&(this.#i.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#f}set isEditing(s){this.#f=s,this.parent&&(s?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(s,t){this.#a=!0;const i=s/t,{style:u}=this.div;u.aspectRatio=i,u.height="auto"}static get MIN_SIZE(){return 16}}n.AnnotationEditor=x;class B extends x{constructor(s){super(s),this.annotationElementId=s.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.KeyboardManager=n.CommandManager=n.ColorManager=n.AnnotationEditorUIManager=void 0,n.bindEvents=I,n.opacityToHex=x;var a=T(1),m=T(6);function I(l,e,d){for(const p of d)e.addEventListener(p,l[p].bind(l))}function x(l){return Math.round(Math.min(255,Math.max(1,255*l))).toString(16).padStart(2,"0")}class B{#t=0;getId(){return`${a.AnnotationEditorPrefix}${this.#t++}`}}class U{#t=(0,a.getUuid)();#e=0;#i=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',p=new OffscreenCanvas(1,3).getContext("2d"),o=new Image;o.src=e;const y=o.decode().then(()=>(p.drawImage(o,0,0,1,1,0,0,1,3),new Uint32Array(p.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,a.shadow)(this,"_isSVGFittingCanvas",y)}async#s(e,d){this.#i||=new Map;let p=this.#i.get(e);if(p===null)return null;if(p?.bitmap)return p.refCounter+=1,p;try{p||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let o;if(typeof d=="string"){p.url=d;const y=await fetch(d);if(!y.ok)throw new Error(y.statusText);o=await y.blob()}else o=p.file=d;if(o.type==="image/svg+xml"){const y=U._isSVGFittingCanvas,M=new FileReader,w=new Image,f=new Promise((v,O)=>{w.onload=()=>{p.bitmap=w,p.isSvg=!0,v()},M.onload=async()=>{const H=p.svgUrl=M.result;w.src=await y?`${H}#svgView(preserveAspectRatio(none))`:H},w.onerror=M.onerror=O});M.readAsDataURL(o),await f}else p.bitmap=await createImageBitmap(o);p.refCounter=1}catch(o){console.error(o),p=null}return this.#i.set(e,p),p&&this.#i.set(p.id,p),p}async getFromFile(e){const{lastModified:d,name:p,size:o,type:y}=e;return this.#s(`${d}_${p}_${o}_${y}`,e)}async getFromUrl(e){return this.#s(e,e)}async getFromId(e){this.#i||=new Map;const d=this.#i.get(e);return d?d.bitmap?(d.refCounter+=1,d):d.file?this.getFromFile(d.file):this.getFromUrl(d.url):null}getSvgUrl(e){const d=this.#i.get(e);return d?.isSvg?d.svgUrl:null}deleteId(e){this.#i||=new Map;const d=this.#i.get(e);d&&(d.refCounter-=1,d.refCounter===0&&(d.bitmap=null))}isValidId(e){return e.startsWith(`image_${this.#t}_`)}}class s{#t=[];#e=!1;#i;#s=-1;constructor(e=128){this.#i=e}add({cmd:e,undo:d,mustExec:p,type:o=NaN,overwriteIfSameType:y=!1,keepUndo:M=!1}){if(p&&e(),this.#e)return;const w={cmd:e,undo:d,type:o};if(this.#s===-1){this.#t.length>0&&(this.#t.length=0),this.#s=0,this.#t.push(w);return}if(y&&this.#t[this.#s].type===o){M&&(w.undo=this.#t[this.#s].undo),this.#t[this.#s]=w;return}const f=this.#s+1;f===this.#i?this.#t.splice(0,1):(this.#s=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(w)}undo(){this.#s!==-1&&(this.#e=!0,this.#t[this.#s].undo(),this.#e=!1,this.#s-=1)}redo(){this.#s<this.#t.length-1&&(this.#s+=1,this.#e=!0,this.#t[this.#s].cmd(),this.#e=!1)}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#t.length-1}destroy(){this.#t=null}}n.CommandManager=s;class t{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:d}=a.FeatureTest.platform;for(const[p,o,y={}]of e)for(const M of p){const w=M.startsWith("mac+");d&&w?(this.callbacks.set(M.slice(4),{callback:o,options:y}),this.allKeys.add(M.split("+").at(-1))):!d&&!w&&(this.callbacks.set(M,{callback:o,options:y}),this.allKeys.add(M.split("+").at(-1)))}}#t(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const d=this.buffer.join("+");return this.buffer.length=0,d}exec(e,d){if(!this.allKeys.has(d.key))return;const p=this.callbacks.get(this.#t(d));if(!p)return;const{callback:o,options:{bubbles:y=!1,args:M=[],checker:w=null}}=p;w&&!w(e,d)||(o.bind(e,...M)(),y||(d.stopPropagation(),d.preventDefault()))}}n.KeyboardManager=t;class i{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,m.getColorValues)(e),(0,a.shadow)(this,"_colors",e)}convert(e){const d=(0,m.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return d;for(const[p,o]of this._colors)if(o.every((y,M)=>y===d[M]))return i._colorsMapping.get(p);return d}getHexCode(e){const d=this._colors.get(e);return d?a.Util.makeHexColor(...d):e}}n.ColorManager=i;class u{#t=null;#e=new Map;#i=new Map;#s=null;#o=null;#a=new s;#r=0;#l=new Set;#c=null;#n=null;#f=new Set;#d=null;#u=new B;#p=!1;#b=!1;#m=null;#g=a.AnnotationEditorType.NONE;#h=new Set;#_=null;#E=this.blur.bind(this);#S=this.focus.bind(this);#T=this.copy.bind(this);#x=this.cut.bind(this);#I=this.paste.bind(this);#L=this.keydown.bind(this);#O=this.onEditingAction.bind(this);#A=this.onPageChanging.bind(this);#D=this.onScaleChanging.bind(this);#k=this.onRotationChanging.bind(this);#M={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#y=[0,0];#P=null;#w=null;#N=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=u.prototype,d=y=>{const{activeElement:M}=document;return M&&y.#w.contains(M)&&y.hasSomethingToControl()},p=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new t([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-p,0],checker:d}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-o,0],checker:d}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[p,0],checker:d}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[o,0],checker:d}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-p],checker:d}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-o],checker:d}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,p],checker:d}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,o],checker:d}]]))}constructor(e,d,p,o,y,M){this.#w=e,this.#N=d,this.#s=p,this._eventBus=o,this._eventBus._on("editingaction",this.#O),this._eventBus._on("pagechanging",this.#A),this._eventBus._on("scalechanging",this.#D),this._eventBus._on("rotationchanging",this.#k),this.#o=y.annotationStorage,this.#d=y.filterFactory,this.#_=M,this.viewParameters={realScale:m.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#F(),this.#U(),this._eventBus._off("editingaction",this.#O),this._eventBus._off("pagechanging",this.#A),this._eventBus._off("scalechanging",this.#D),this._eventBus._off("rotationchanging",this.#k);for(const e of this.#i.values())e.destroy();this.#i.clear(),this.#e.clear(),this.#f.clear(),this.#t=null,this.#h.clear(),this.#a.destroy(),this.#s.destroy()}get hcmFilter(){return(0,a.shadow)(this,"hcmFilter",this.#_?this.#d.addHCMFilter(this.#_.foreground,this.#_.background):"none")}get direction(){return(0,a.shadow)(this,"direction",getComputedStyle(this.#w).direction)}editAltText(e){this.#s?.editAltText(this,e)}onPageChanging({pageNumber:e}){this.#r=e-1}focusMainContainer(){this.#w.focus()}findParent(e,d){for(const p of this.#i.values()){const{x:o,y,width:M,height:w}=p.div.getBoundingClientRect();if(e>=o&&e<=o+M&&d>=y&&d<=y+w)return p}return null}disableUserSelect(e=!1){this.#N.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#f.add(e)}removeShouldRescale(e){this.#f.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*m.PixelsPerInch.PDF_TO_CSS_UNITS;for(const d of this.#f)d.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){!e.isEmpty()&&this.#o&&!this.#o.has(e.id)&&this.#o.setValue(e.id,e)}#B(){window.addEventListener("focus",this.#S),window.addEventListener("blur",this.#E)}#U(){window.removeEventListener("focus",this.#S),window.removeEventListener("blur",this.#E)}blur(){if(!this.hasSelection)return;const{activeElement:e}=document;for(const d of this.#h)if(d.div.contains(e)){this.#m=[d,e],d._focusEventsAllowed=!1;break}}focus(){if(!this.#m)return;const[e,d]=this.#m;this.#m=null,d.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),d.focus()}#j(){window.addEventListener("keydown",this.#L,{capture:!0})}#F(){window.removeEventListener("keydown",this.#L,{capture:!0})}#R(){document.addEventListener("copy",this.#T),document.addEventListener("cut",this.#x),document.addEventListener("paste",this.#I)}#C(){document.removeEventListener("copy",this.#T),document.removeEventListener("cut",this.#x),document.removeEventListener("paste",this.#I)}addEditListeners(){this.#j(),this.#R()}removeEditListeners(){this.#F(),this.#C()}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const d=[];for(const p of this.#h){const o=p.serialize(!0);o&&d.push(o)}d.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(d))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:d}=e;for(const y of d.items)for(const M of this.#n)if(M.isHandlingMimeForPasting(y.type)){M.paste(y,this.currentLayer);return}let p=d.getData("application/pdfjs");if(!p)return;try{p=JSON.parse(p)}catch(y){(0,a.warn)(`paste: "${y.message}".`);return}if(!Array.isArray(p))return;this.unselectAll();const o=this.currentLayer;try{const y=[];for(const f of p){const v=o.deserialize(f);if(!v)return;y.push(v)}const M=()=>{for(const f of y)this.#G(f);this.#z(y)},w=()=>{for(const f of y)f.remove()};this.addCommands({cmd:M,undo:w,mustExec:!0})}catch(y){(0,a.warn)(`paste: "${y.message}".`)}}keydown(e){this.getActive()?.shouldGetKeyboardEvents()||u._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}#v(e){Object.entries(e).some(([p,o])=>this.#M[p]!==o)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#M,e)})}#H(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#B(),this.#j(),this.#R(),this.#v({isEditing:this.#g!==a.AnnotationEditorType.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:this.#a.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#U(),this.#F(),this.#C(),this.#v({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#n){this.#n=e;for(const d of this.#n)this.#H(d.defaultPropertiesToUpdate)}}getId(){return this.#u.getId()}get currentLayer(){return this.#i.get(this.#r)}getLayer(e){return this.#i.get(e)}get currentPageIndex(){return this.#r}addLayer(e){this.#i.set(e.pageIndex,e),this.#p?e.enable():e.disable()}removeLayer(e){this.#i.delete(e.pageIndex)}updateMode(e,d=null){if(this.#g!==e){if(this.#g=e,e===a.AnnotationEditorType.NONE){this.setEditingState(!1),this.#q();return}this.setEditingState(!0),this.#X(),this.unselectAll();for(const p of this.#i.values())p.updateMode(e);if(d){for(const p of this.#e.values())if(p.annotationElementId===d){this.setSelected(p),p.enterInEditMode();break}}}}updateToolbar(e){e!==this.#g&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,d){if(this.#n){if(e===a.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(e);return}for(const p of this.#h)p.updateParams(e,d);for(const p of this.#n)p.updateDefaultParams(e,d)}}enableWaiting(e=!1){if(this.#b!==e){this.#b=e;for(const d of this.#i.values())e?d.disableClick():d.enableClick(),d.div.classList.toggle("waiting",e)}}#X(){if(!this.#p){this.#p=!0;for(const e of this.#i.values())e.enable()}}#q(){if(this.unselectAll(),this.#p){this.#p=!1;for(const e of this.#i.values())e.disable()}}getEditors(e){const d=[];for(const p of this.#e.values())p.pageIndex===e&&d.push(p);return d}getEditor(e){return this.#e.get(e)}addEditor(e){this.#e.set(e.id,e)}removeEditor(e){this.#e.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#l.has(e.annotationElementId))&&this.#o?.remove(e.id)}addDeletedAnnotationElement(e){this.#l.add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return this.#l.has(e)}removeDeletedAnnotationElement(e){this.#l.delete(e.annotationElementId),e.deleted=!1}#G(e){const d=this.#i.get(e.pageIndex);d?d.addOrRebuild(e):this.addEditor(e)}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#H(e.propertiesToUpdate))}toggleSelected(e){if(this.#h.has(e)){this.#h.delete(e),e.unselect(),this.#v({hasSelectedEditor:this.hasSelection});return}this.#h.add(e),e.select(),this.#H(e.propertiesToUpdate),this.#v({hasSelectedEditor:!0})}setSelected(e){for(const d of this.#h)d!==e&&d.unselect();this.#h.clear(),this.#h.add(e),e.select(),this.#H(e.propertiesToUpdate),this.#v({hasSelectedEditor:!0})}isSelected(e){return this.#h.has(e)}unselect(e){e.unselect(),this.#h.delete(e),this.#v({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#h.size!==0}undo(){this.#a.undo(),this.#v({hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()})}redo(){this.#a.redo(),this.#v({hasSomethingToUndo:!0,hasSomethingToRedo:this.#a.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(e){this.#a.add(e),this.#v({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}#W(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(const e of this.#e.values())return e.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...this.#h],d=()=>{for(const o of e)o.remove()},p=()=>{for(const o of e)this.#G(o)};this.addCommands({cmd:d,undo:p,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#z(e){this.#h.clear();for(const d of e)d.isEmpty()||(this.#h.add(d),d.select());this.#v({hasSelectedEditor:!0})}selectAll(){for(const e of this.#h)e.commit();this.#z(this.#e.values())}unselectAll(){if(this.#t){this.#t.commitOrRemove();return}if(this.hasSelection){for(const e of this.#h)e.unselect();this.#h.clear(),this.#v({hasSelectedEditor:!1})}}translateSelectedEditors(e,d,p=!1){if(p||this.commitOrRemove(),!this.hasSelection)return;this.#y[0]+=e,this.#y[1]+=d;const[o,y]=this.#y,M=[...this.#h],w=1e3;this.#P&&clearTimeout(this.#P),this.#P=setTimeout(()=>{this.#P=null,this.#y[0]=this.#y[1]=0,this.addCommands({cmd:()=>{for(const f of M)this.#e.has(f.id)&&f.translateInPage(o,y)},undo:()=>{for(const f of M)this.#e.has(f.id)&&f.translateInPage(-o,-y)},mustExec:!1})},w);for(const f of M)f.translateInPage(e,d)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#c=new Map;for(const e of this.#h)this.#c.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#c)return!1;this.disableUserSelect(!1);const e=this.#c;this.#c=null;let d=!1;for(const[{x:o,y,pageIndex:M},w]of e)w.newX=o,w.newY=y,w.newPageIndex=M,d||=o!==w.savedX||y!==w.savedY||M!==w.savedPageIndex;if(!d)return!1;const p=(o,y,M,w)=>{if(this.#e.has(o.id)){const f=this.#i.get(w);f?o._setParentAndPosition(f,y,M):(o.pageIndex=w,o.x=y,o.y=M)}};return this.addCommands({cmd:()=>{for(const[o,{newX:y,newY:M,newPageIndex:w}]of e)p(o,y,M,w)},undo:()=>{for(const[o,{savedX:y,savedY:M,savedPageIndex:w}]of e)p(o,y,M,w)},mustExec:!0}),!0}dragSelectedEditors(e,d){if(this.#c)for(const p of this.#c.keys())p.drag(e,d)}rebuild(e){if(e.parent===null){const d=this.getLayer(e.pageIndex);d?(d.changeParent(e),d.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#g}get imageManager(){return(0,a.shadow)(this,"imageManager",new U)}}n.AnnotationEditorUIManager=u}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StatTimer=n.RenderingCancelledException=n.PixelsPerInch=n.PageViewport=n.PDFDateString=n.DOMStandardFontDataFactory=n.DOMSVGFactory=n.DOMFilterFactory=n.DOMCanvasFactory=n.DOMCMapReaderFactory=void 0,n.deprecated=O,n.getColorValues=it,n.getCurrentTransform=Q,n.getCurrentTransformInverse=et,n.getFilenameFromUrl=o,n.getPdfFilenameFromUrl=y,n.getRGB=X,n.getXfaPageViewport=G,n.isDataScheme=d,n.isPdfFile=p,n.isValidFetchUrl=w,n.loadScript=v,n.noContextMenu=f,n.setLayerDimensions=nt;var a=T(7),m=T(1);const I="http://www.w3.org/2000/svg";class x{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}n.PixelsPerInch=x;class B extends a.BaseFilterFactory{#t;#e;#i;#s;#o;#a;#r;#l;#c;#n;#f=0;constructor({docId:F,ownerDocument:b=globalThis.document}={}){super(),this.#i=F,this.#s=b}get#d(){return this.#t||=new Map}get#u(){if(!this.#e){const F=this.#s.createElement("div"),{style:b}=F;b.visibility="hidden",b.contain="strict",b.width=b.height=0,b.position="absolute",b.top=b.left=0,b.zIndex=-1;const c=this.#s.createElementNS(I,"svg");c.setAttribute("width",0),c.setAttribute("height",0),this.#e=this.#s.createElementNS(I,"defs"),F.append(c),c.append(this.#e),this.#s.body.append(F)}return this.#e}addFilter(F){if(!F)return"none";let b=this.#d.get(F);if(b)return b;let c,h,_,P;if(F.length===1){const r=F[0],g=new Array(256);for(let A=0;A<256;A++)g[A]=r[A]/255;P=c=h=_=g.join(",")}else{const[r,g,A]=F,E=new Array(256),C=new Array(256),L=new Array(256);for(let j=0;j<256;j++)E[j]=r[j]/255,C[j]=g[j]/255,L[j]=A[j]/255;c=E.join(","),h=C.join(","),_=L.join(","),P=`${c}${h}${_}`}if(b=this.#d.get(P),b)return this.#d.set(F,b),b;const k=`g_${this.#i}_transfer_map_${this.#f++}`,R=`url(#${k})`;this.#d.set(F,R),this.#d.set(P,R);const S=this.#b(k);return this.#g(c,h,_,S),R}addHCMFilter(F,b){const c=`${F}-${b}`;if(this.#a===c)return this.#r;if(this.#a=c,this.#r="none",this.#o?.remove(),!F||!b)return this.#r;const h=this.#h(F);F=m.Util.makeHexColor(...h);const _=this.#h(b);if(b=m.Util.makeHexColor(..._),this.#u.style.color="",F==="#000000"&&b==="#ffffff"||F===b)return this.#r;const P=new Array(256);for(let g=0;g<=255;g++){const A=g/255;P[g]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const k=P.join(","),R=`g_${this.#i}_hcm_filter`,S=this.#l=this.#b(R);this.#g(k,k,k,S),this.#p(S);const r=(g,A)=>{const E=h[g]/255,C=_[g]/255,L=new Array(A+1);for(let j=0;j<=A;j++)L[j]=E+j/A*(C-E);return L.join(",")};return this.#g(r(0,5),r(1,5),r(2,5),S),this.#r=`url(#${R})`,this.#r}addHighlightHCMFilter(F,b,c,h){const _=`${F}-${b}-${c}-${h}`;if(this.#c===_)return this.#n;if(this.#c=_,this.#n="none",this.#l?.remove(),!F||!b)return this.#n;const[P,k]=[F,b].map(this.#h.bind(this));let R=Math.round(.2126*P[0]+.7152*P[1]+.0722*P[2]),S=Math.round(.2126*k[0]+.7152*k[1]+.0722*k[2]),[r,g]=[c,h].map(this.#h.bind(this));S<R&&([R,S,r,g]=[S,R,g,r]),this.#u.style.color="";const A=(L,j,q)=>{const st=new Array(256),V=(S-R)/q,Y=L/255,K=(j-L)/(255*q);let J=0;for(let Z=0;Z<=q;Z++){const rt=Math.round(R+Z*V),ot=Y+Z*K;for(let lt=J;lt<=rt;lt++)st[lt]=ot;J=rt+1}for(let Z=J;Z<256;Z++)st[Z]=st[J-1];return st.join(",")},E=`g_${this.#i}_hcm_highlight_filter`,C=this.#l=this.#b(E);return this.#p(C),this.#g(A(r[0],g[0],5),A(r[1],g[1],5),A(r[2],g[2],5),C),this.#n=`url(#${E})`,this.#n}destroy(F=!1){F&&(this.#r||this.#n)||(this.#e&&(this.#e.parentNode.parentNode.remove(),this.#e=null),this.#t&&(this.#t.clear(),this.#t=null),this.#f=0)}#p(F){const b=this.#s.createElementNS(I,"feColorMatrix");b.setAttribute("type","matrix"),b.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),F.append(b)}#b(F){const b=this.#s.createElementNS(I,"filter");return b.setAttribute("color-interpolation-filters","sRGB"),b.setAttribute("id",F),this.#u.append(b),b}#m(F,b,c){const h=this.#s.createElementNS(I,b);h.setAttribute("type","discrete"),h.setAttribute("tableValues",c),F.append(h)}#g(F,b,c,h){const _=this.#s.createElementNS(I,"feComponentTransfer");h.append(_),this.#m(_,"feFuncR",F),this.#m(_,"feFuncG",b),this.#m(_,"feFuncB",c)}#h(F){return this.#u.style.color=F,X(getComputedStyle(this.#u).getPropertyValue("color"))}}n.DOMFilterFactory=B;class U extends a.BaseCanvasFactory{constructor({ownerDocument:F=globalThis.document}={}){super(),this._document=F}_createCanvas(F,b){const c=this._document.createElement("canvas");return c.width=F,c.height=b,c}}n.DOMCanvasFactory=U;async function s($,F=!1){if(w($,document.baseURI)){const b=await fetch($);if(!b.ok)throw new Error(b.statusText);return F?new Uint8Array(await b.arrayBuffer()):(0,m.stringToBytes)(await b.text())}return new Promise((b,c)=>{const h=new XMLHttpRequest;h.open("GET",$,!0),F&&(h.responseType="arraybuffer"),h.onreadystatechange=()=>{if(h.readyState===XMLHttpRequest.DONE){if(h.status===200||h.status===0){let _;if(F&&h.response?_=new Uint8Array(h.response):!F&&h.responseText&&(_=(0,m.stringToBytes)(h.responseText)),_){b(_);return}}c(new Error(h.statusText))}},h.send(null)})}class t extends a.BaseCMapReaderFactory{_fetchData(F,b){return s(F,this.isCompressed).then(c=>({cMapData:c,compressionType:b}))}}n.DOMCMapReaderFactory=t;class i extends a.BaseStandardFontDataFactory{_fetchData(F){return s(F,!0)}}n.DOMStandardFontDataFactory=i;class u extends a.BaseSVGFactory{_createSVG(F){return document.createElementNS(I,F)}}n.DOMSVGFactory=u;class l{constructor({viewBox:F,scale:b,rotation:c,offsetX:h=0,offsetY:_=0,dontFlip:P=!1}){this.viewBox=F,this.scale=b,this.rotation=c,this.offsetX=h,this.offsetY=_;const k=(F[2]+F[0])/2,R=(F[3]+F[1])/2;let S,r,g,A;switch(c%=360,c<0&&(c+=360),c){case 180:S=-1,r=0,g=0,A=1;break;case 90:S=0,r=1,g=1,A=0;break;case 270:S=0,r=-1,g=-1,A=0;break;case 0:S=1,r=0,g=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}P&&(g=-g,A=-A);let E,C,L,j;S===0?(E=Math.abs(R-F[1])*b+h,C=Math.abs(k-F[0])*b+_,L=(F[3]-F[1])*b,j=(F[2]-F[0])*b):(E=Math.abs(k-F[0])*b+h,C=Math.abs(R-F[1])*b+_,L=(F[2]-F[0])*b,j=(F[3]-F[1])*b),this.transform=[S*b,r*b,g*b,A*b,E-S*b*k-g*b*R,C-r*b*k-A*b*R],this.width=L,this.height=j}get rawDims(){const{viewBox:F}=this;return(0,m.shadow)(this,"rawDims",{pageWidth:F[2]-F[0],pageHeight:F[3]-F[1],pageX:F[0],pageY:F[1]})}clone({scale:F=this.scale,rotation:b=this.rotation,offsetX:c=this.offsetX,offsetY:h=this.offsetY,dontFlip:_=!1}={}){return new l({viewBox:this.viewBox.slice(),scale:F,rotation:b,offsetX:c,offsetY:h,dontFlip:_})}convertToViewportPoint(F,b){return m.Util.applyTransform([F,b],this.transform)}convertToViewportRectangle(F){const b=m.Util.applyTransform([F[0],F[1]],this.transform),c=m.Util.applyTransform([F[2],F[3]],this.transform);return[b[0],b[1],c[0],c[1]]}convertToPdfPoint(F,b){return m.Util.applyInverseTransform([F,b],this.transform)}}n.PageViewport=l;class e extends m.BaseException{constructor(F,b=0){super(F,"RenderingCancelledException"),this.extraDelay=b}}n.RenderingCancelledException=e;function d($){const F=$.length;let b=0;for(;b<F&&$[b].trim()==="";)b++;return $.substring(b,b+5).toLowerCase()==="data:"}function p($){return typeof $=="string"&&/\.pdf$/i.test($)}function o($,F=!1){return F||([$]=$.split(/[#?]/,1)),$.substring($.lastIndexOf("/")+1)}function y($,F="document.pdf"){if(typeof $!="string")return F;if(d($))return(0,m.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),F;const b=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,c=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,h=b.exec($);let _=c.exec(h[1])||c.exec(h[2])||c.exec(h[3]);if(_&&(_=_[0],_.includes("%")))try{_=c.exec(decodeURIComponent(_))[0]}catch{}return _||F}class M{started=Object.create(null);times=[];time(F){F in this.started&&(0,m.warn)(`Timer is already running for ${F}`),this.started[F]=Date.now()}timeEnd(F){F in this.started||(0,m.warn)(`Timer has not been started for ${F}`),this.times.push({name:F,start:this.started[F],end:Date.now()}),delete this.started[F]}toString(){const F=[];let b=0;for(const{name:c}of this.times)b=Math.max(c.length,b);for(const{name:c,start:h,end:_}of this.times)F.push(`${c.padEnd(b)} ${_-h}ms
`);return F.join("")}}n.StatTimer=M;function w($,F){try{const{protocol:b}=F?new URL($,F):new URL($);return b==="http:"||b==="https:"}catch{return!1}}function f($){$.preventDefault()}function v($,F=!1){return new Promise((b,c)=>{const h=document.createElement("script");h.src=$,h.onload=function(_){F&&h.remove(),b(_)},h.onerror=function(){c(new Error(`Cannot load script at: ${h.src}`))},(document.head||document.documentElement).append(h)})}function O($){console.log("Deprecated API usage: "+$)}let H;class D{static toDateObject(F){if(!F||typeof F!="string")return null;H||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const b=H.exec(F);if(!b)return null;const c=parseInt(b[1],10);let h=parseInt(b[2],10);h=h>=1&&h<=12?h-1:0;let _=parseInt(b[3],10);_=_>=1&&_<=31?_:1;let P=parseInt(b[4],10);P=P>=0&&P<=23?P:0;let k=parseInt(b[5],10);k=k>=0&&k<=59?k:0;let R=parseInt(b[6],10);R=R>=0&&R<=59?R:0;const S=b[7]||"Z";let r=parseInt(b[8],10);r=r>=0&&r<=23?r:0;let g=parseInt(b[9],10)||0;return g=g>=0&&g<=59?g:0,S==="-"?(P+=r,k+=g):S==="+"&&(P-=r,k-=g),new Date(Date.UTC(c,h,_,P,k,R))}}n.PDFDateString=D;function G($,{scale:F=1,rotation:b=0}){const{width:c,height:h}=$.attributes.style,_=[0,0,parseInt(c),parseInt(h)];return new l({viewBox:_,scale:F,rotation:b})}function X($){if($.startsWith("#")){const F=parseInt($.slice(1),16);return[(F&16711680)>>16,(F&65280)>>8,F&255]}return $.startsWith("rgb(")?$.slice(4,-1).split(",").map(F=>parseInt(F)):$.startsWith("rgba(")?$.slice(5,-1).split(",").map(F=>parseInt(F)).slice(0,3):((0,m.warn)(`Not a valid color format: "${$}"`),[0,0,0])}function it($){const F=document.createElement("span");F.style.visibility="hidden",document.body.append(F);for(const b of $.keys()){F.style.color=b;const c=window.getComputedStyle(F).color;$.set(b,X(c))}F.remove()}function Q($){const{a:F,b,c,d:h,e:_,f:P}=$.getTransform();return[F,b,c,h,_,P]}function et($){const{a:F,b,c,d:h,e:_,f:P}=$.getTransform().invertSelf();return[F,b,c,h,_,P]}function nt($,F,b=!1,c=!0){if(F instanceof l){const{pageWidth:h,pageHeight:_}=F.rawDims,{style:P}=$,k=m.FeatureTest.isCSSRoundSupported,R=`var(--scale-factor) * ${h}px`,S=`var(--scale-factor) * ${_}px`,r=k?`round(${R}, 1px)`:`calc(${R})`,g=k?`round(${S}, 1px)`:`calc(${S})`;!b||F.rotation%180===0?(P.width=r,P.height=g):(P.width=g,P.height=r)}c&&$.setAttribute("data-main-rotation",F.rotation)}}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseStandardFontDataFactory=n.BaseSVGFactory=n.BaseFilterFactory=n.BaseCanvasFactory=n.BaseCMapReaderFactory=void 0;var a=T(1);class m{constructor(){this.constructor===m&&(0,a.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addHighlightHCMFilter(t,i,u,l){return"none"}destroy(t=!1){}}n.BaseFilterFactory=m;class I{constructor(){this.constructor===I&&(0,a.unreachable)("Cannot initialize BaseCanvasFactory.")}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const u=this._createCanvas(t,i);return{canvas:u,context:u.getContext("2d")}}reset(t,i,u){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||u<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=u}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){(0,a.unreachable)("Abstract method `_createCanvas` called.")}}n.BaseCanvasFactory=I;class x{constructor({baseUrl:t=null,isCompressed:i=!0}){this.constructor===x&&(0,a.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":""),u=this.isCompressed?a.CMapCompressionType.BINARY:a.CMapCompressionType.NONE;return this._fetchData(i,u).catch(l=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}_fetchData(t,i){(0,a.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=x;class B{constructor({baseUrl:t=null}){this.constructor===B&&(0,a.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetchData(i).catch(u=>{throw new Error(`Unable to load font data at: ${i}`)})}_fetchData(t){(0,a.unreachable)("Abstract method `_fetchData` called.")}}n.BaseStandardFontDataFactory=B;class U{constructor(){this.constructor===U&&(0,a.unreachable)("Cannot initialize BaseSVGFactory.")}create(t,i,u=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const l=this._createSVG("svg:svg");return l.setAttribute("version","1.1"),u||(l.setAttribute("width",`${t}px`),l.setAttribute("height",`${i}px`)),l.setAttribute("preserveAspectRatio","none"),l.setAttribute("viewBox",`0 0 ${t} ${i}`),l}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){(0,a.unreachable)("Abstract method `_createSVG` called.")}}n.BaseSVGFactory=U}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MurmurHash3_64=void 0;var a=T(1);const m=3285377520,I=4294901760,x=65535;class B{constructor(s){this.h1=s?s&4294967295:m,this.h2=s?s&4294967295:m}update(s){let t,i;if(typeof s=="string"){t=new Uint8Array(s.length*2),i=0;for(let O=0,H=s.length;O<H;O++){const D=s.charCodeAt(O);D<=255?t[i++]=D:(t[i++]=D>>>8,t[i++]=D&255)}}else if((0,a.isArrayBuffer)(s))t=s.slice(),i=t.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const u=i>>2,l=i-u*4,e=new Uint32Array(t.buffer,0,u);let d=0,p=0,o=this.h1,y=this.h2;const M=3432918353,w=461845907,f=M&x,v=w&x;for(let O=0;O<u;O++)O&1?(d=e[O],d=d*M&I|d*f&x,d=d<<15|d>>>17,d=d*w&I|d*v&x,o^=d,o=o<<13|o>>>19,o=o*5+3864292196):(p=e[O],p=p*M&I|p*f&x,p=p<<15|p>>>17,p=p*w&I|p*v&x,y^=p,y=y<<13|y>>>19,y=y*5+3864292196);switch(d=0,l){case 3:d^=t[u*4+2]<<16;case 2:d^=t[u*4+1]<<8;case 1:d^=t[u*4],d=d*M&I|d*f&x,d=d<<15|d>>>17,d=d*w&I|d*v&x,u&1?o^=d:y^=d}this.h1=o,this.h2=y}hexdigest(){let s=this.h1,t=this.h2;return s^=t>>>1,s=s*3981806797&I|s*36045&x,t=t*4283543511&I|((t<<16|s>>>16)*2950163797&I)>>>16,s^=t>>>1,s=s*444984403&I|s*60499&x,t=t*3301882366&I|((t<<16|s>>>16)*3120437893&I)>>>16,s^=t>>>1,(s>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}n.MurmurHash3_64=B}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var a=T(1);class m{#t=new Set;constructor({ownerDocument:B=globalThis.document,styleElement:U=null}){this._document=B,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(B){this.nativeFontFaces.add(B),this._document.fonts.add(B)}removeNativeFontFace(B){this.nativeFontFaces.delete(B),this._document.fonts.delete(B)}insertRule(B){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const U=this.styleElement.sheet;U.insertRule(B,U.cssRules.length)}clear(){for(const B of this.nativeFontFaces)this._document.fonts.delete(B);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(B){if(!(!B||this.#t.has(B.loadedName))){if((0,a.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:U,src:s,style:t}=B,i=new FontFace(U,s,t);this.addNativeFontFace(i);try{await i.load(),this.#t.add(U)}catch{(0,a.warn)(`Cannot load system font: ${B.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(i)}return}(0,a.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(B){if(B.attached||B.missingFile&&!B.systemFontInfo)return;if(B.attached=!0,B.systemFontInfo){await this.loadSystemFont(B.systemFontInfo);return}if(this.isFontLoadingAPISupported){const s=B.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(t){throw(0,a.warn)(`Failed to load font '${s.family}': '${t}'.`),B.disableFontFace=!0,t}}return}const U=B.createFontFaceRule();if(U){if(this.insertRule(U),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const t=this._queueLoadingCallback(s);this._prepareFontLoadEvent(B,t)})}}get isFontLoadingAPISupported(){const B=!!this._document?.fonts;return(0,a.shadow)(this,"isFontLoadingAPISupported",B)}get isSyncFontLoadingSupported(){let B=!1;return(a.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(B=!0),(0,a.shadow)(this,"isSyncFontLoadingSupported",B)}_queueLoadingCallback(B){function U(){for((0,a.assert)(!t.done,"completeRequest() cannot be called twice."),t.done=!0;s.length>0&&s[0].done;){const i=s.shift();setTimeout(i.callback,0)}}const{loadingRequests:s}=this,t={done:!1,complete:U,callback:B};return s.push(t),t}get _loadTestFont(){const B=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,a.shadow)(this,"_loadTestFont",B)}_prepareFontLoadEvent(B,U){function s(G,X){return G.charCodeAt(X)<<24|G.charCodeAt(X+1)<<16|G.charCodeAt(X+2)<<8|G.charCodeAt(X+3)&255}function t(G,X,it,Q){const et=G.substring(0,X),nt=G.substring(X+it);return et+Q+nt}let i,u;const l=this._document.createElement("canvas");l.width=1,l.height=1;const e=l.getContext("2d");let d=0;function p(G,X){if(++d>30){(0,a.warn)("Load test font never loaded."),X();return}if(e.font="30px "+G,e.fillText(".",0,20),e.getImageData(0,0,1,1).data[3]>0){X();return}setTimeout(p.bind(null,G,X))}const o=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=t(y,976,o.length,o);const w=16,f=1482184792;let v=s(y,w);for(i=0,u=o.length-3;i<u;i+=4)v=v-f+s(o,i)|0;i<o.length&&(v=v-f+s(o+"XXX",i)|0),y=t(y,w,4,(0,a.string32)(v));const O=`url(data:font/opentype;base64,${btoa(y)});`,H=`@font-face {font-family:"${o}";src:${O}}`;this.insertRule(H);const D=this._document.createElement("div");D.style.visibility="hidden",D.style.width=D.style.height="10px",D.style.position="absolute",D.style.top=D.style.left="0px";for(const G of[B.loadedName,o]){const X=this._document.createElement("span");X.textContent="Hi",X.style.fontFamily=G,D.append(X)}this._document.body.append(D),p(o,()=>{D.remove(),U.complete()})}}n.FontLoader=m;class I{constructor(B,{isEvalSupported:U=!0,disableFontFace:s=!1,ignoreErrors:t=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const u in B)this[u]=B[u];this.isEvalSupported=U!==!1,this.disableFontFace=s===!0,this.ignoreErrors=t===!0,this._inspectFont=i}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let B;if(!this.cssFontInfo)B=new FontFace(this.loadedName,this.data,{});else{const U={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(U.style=`oblique ${this.cssFontInfo.italicAngle}deg`),B=new FontFace(this.cssFontInfo.fontFamily,this.data,U)}return this._inspectFont?.(this),B}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const B=(0,a.bytesToString)(this.data),U=`url(data:${this.mimetype};base64,${btoa(B)});`;let s;if(!this.cssFontInfo)s=`@font-face {font-family:"${this.loadedName}";src:${U}}`;else{let t=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(t+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),s=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${t}src:${U}}`}return this._inspectFont?.(this,U),s}getPathGenerator(B,U){if(this.compiledGlyphs[U]!==void 0)return this.compiledGlyphs[U];let s;try{s=B.get(this.loadedName+"_path_"+U)}catch(t){if(!this.ignoreErrors)throw t;return(0,a.warn)(`getPathGenerator - ignoring character: "${t}".`),this.compiledGlyphs[U]=function(i,u){}}if(this.isEvalSupported&&a.FeatureTest.isEvalSupported){const t=[];for(const i of s){const u=i.args!==void 0?i.args.join(","):"";t.push("c.",i.cmd,"(",u,`);
`)}return this.compiledGlyphs[U]=new Function("c","size",t.join(""))}return this.compiledGlyphs[U]=function(t,i){for(const u of s)u.cmd==="scale"&&(u.args=[i,-i]),t[u.cmd].apply(t,u.args)}}}n.FontFaceObject=I}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeStandardFontDataFactory=n.NodeFilterFactory=n.NodeCanvasFactory=n.NodeCMapReaderFactory=void 0;var a=T(7);T(1);const m=function(s){return new Promise((t,i)=>{require$$5.readFile(s,(l,e)=>{if(l||!e){i(new Error(l));return}t(new Uint8Array(e))})})};class I extends a.BaseFilterFactory{}n.NodeFilterFactory=I;class x extends a.BaseCanvasFactory{_createCanvas(t,i){return require$$5.createCanvas(t,i)}}n.NodeCanvasFactory=x;class B extends a.BaseCMapReaderFactory{_fetchData(t,i){return m(t).then(u=>({cMapData:u,compressionType:i}))}}n.NodeCMapReaderFactory=B;class U extends a.BaseStandardFontDataFactory{_fetchData(t){return m(t)}}n.NodeStandardFontDataFactory=U}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var a=T(1),m=T(6),I=T(12),x=T(13);const B=16,U=100,s=4096,t=15,i=10,u=1e3,l=16;function e(b,c){if(b._removeMirroring)throw new Error("Context is already forwarding operations.");b.__originalSave=b.save,b.__originalRestore=b.restore,b.__originalRotate=b.rotate,b.__originalScale=b.scale,b.__originalTranslate=b.translate,b.__originalTransform=b.transform,b.__originalSetTransform=b.setTransform,b.__originalResetTransform=b.resetTransform,b.__originalClip=b.clip,b.__originalMoveTo=b.moveTo,b.__originalLineTo=b.lineTo,b.__originalBezierCurveTo=b.bezierCurveTo,b.__originalRect=b.rect,b.__originalClosePath=b.closePath,b.__originalBeginPath=b.beginPath,b._removeMirroring=()=>{b.save=b.__originalSave,b.restore=b.__originalRestore,b.rotate=b.__originalRotate,b.scale=b.__originalScale,b.translate=b.__originalTranslate,b.transform=b.__originalTransform,b.setTransform=b.__originalSetTransform,b.resetTransform=b.__originalResetTransform,b.clip=b.__originalClip,b.moveTo=b.__originalMoveTo,b.lineTo=b.__originalLineTo,b.bezierCurveTo=b.__originalBezierCurveTo,b.rect=b.__originalRect,b.closePath=b.__originalClosePath,b.beginPath=b.__originalBeginPath,delete b._removeMirroring},b.save=function(){c.save(),this.__originalSave()},b.restore=function(){c.restore(),this.__originalRestore()},b.translate=function(_,P){c.translate(_,P),this.__originalTranslate(_,P)},b.scale=function(_,P){c.scale(_,P),this.__originalScale(_,P)},b.transform=function(_,P,k,R,S,r){c.transform(_,P,k,R,S,r),this.__originalTransform(_,P,k,R,S,r)},b.setTransform=function(_,P,k,R,S,r){c.setTransform(_,P,k,R,S,r),this.__originalSetTransform(_,P,k,R,S,r)},b.resetTransform=function(){c.resetTransform(),this.__originalResetTransform()},b.rotate=function(_){c.rotate(_),this.__originalRotate(_)},b.clip=function(_){c.clip(_),this.__originalClip(_)},b.moveTo=function(h,_){c.moveTo(h,_),this.__originalMoveTo(h,_)},b.lineTo=function(h,_){c.lineTo(h,_),this.__originalLineTo(h,_)},b.bezierCurveTo=function(h,_,P,k,R,S){c.bezierCurveTo(h,_,P,k,R,S),this.__originalBezierCurveTo(h,_,P,k,R,S)},b.rect=function(h,_,P,k){c.rect(h,_,P,k),this.__originalRect(h,_,P,k)},b.closePath=function(){c.closePath(),this.__originalClosePath()},b.beginPath=function(){c.beginPath(),this.__originalBeginPath()}}class d{constructor(c){this.canvasFactory=c,this.cache=Object.create(null)}getCanvas(c,h,_){let P;return this.cache[c]!==void 0?(P=this.cache[c],this.canvasFactory.reset(P,h,_)):(P=this.canvasFactory.create(h,_),this.cache[c]=P),P}delete(c){delete this.cache[c]}clear(){for(const c in this.cache){const h=this.cache[c];this.canvasFactory.destroy(h),delete this.cache[c]}}}function p(b,c,h,_,P,k,R,S,r,g){const[A,E,C,L,j,q]=(0,m.getCurrentTransform)(b);if(E===0&&C===0){const Y=R*A+j,K=Math.round(Y),J=S*L+q,Z=Math.round(J),rt=(R+r)*A+j,ot=Math.abs(Math.round(rt)-K)||1,lt=(S+g)*L+q,ct=Math.abs(Math.round(lt)-Z)||1;return b.setTransform(Math.sign(A),0,0,Math.sign(L),K,Z),b.drawImage(c,h,_,P,k,0,0,ot,ct),b.setTransform(A,E,C,L,j,q),[ot,ct]}if(A===0&&L===0){const Y=S*C+j,K=Math.round(Y),J=R*E+q,Z=Math.round(J),rt=(S+g)*C+j,ot=Math.abs(Math.round(rt)-K)||1,lt=(R+r)*E+q,ct=Math.abs(Math.round(lt)-Z)||1;return b.setTransform(0,Math.sign(E),Math.sign(C),0,K,Z),b.drawImage(c,h,_,P,k,0,0,ct,ot),b.setTransform(A,E,C,L,j,q),[ct,ot]}b.drawImage(c,h,_,P,k,R,S,r,g);const st=Math.hypot(A,E),V=Math.hypot(C,L);return[st*r,V*g]}function o(b){const{width:c,height:h}=b;if(c>u||h>u)return null;const _=1e3,P=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),k=c+1;let R=new Uint8Array(k*(h+1)),S,r,g;const A=c+7&-8;let E=new Uint8Array(A*h),C=0;for(const V of b.data){let Y=128;for(;Y>0;)E[C++]=V&Y?0:255,Y>>=1}let L=0;for(C=0,E[C]!==0&&(R[0]=1,++L),r=1;r<c;r++)E[C]!==E[C+1]&&(R[r]=E[C]?2:1,++L),C++;for(E[C]!==0&&(R[r]=2,++L),S=1;S<h;S++){C=S*A,g=S*k,E[C-A]!==E[C]&&(R[g]=E[C]?1:8,++L);let V=(E[C]?4:0)+(E[C-A]?8:0);for(r=1;r<c;r++)V=(V>>2)+(E[C+1]?4:0)+(E[C-A+1]?8:0),P[V]&&(R[g+r]=P[V],++L),C++;if(E[C-A]!==E[C]&&(R[g+r]=E[C]?2:4,++L),L>_)return null}for(C=A*(h-1),g=S*k,E[C]!==0&&(R[g]=8,++L),r=1;r<c;r++)E[C]!==E[C+1]&&(R[g+r]=E[C]?4:8,++L),C++;if(E[C]!==0&&(R[g+r]=4,++L),L>_)return null;const j=new Int32Array([0,k,-1,0,-k,0,0,0,1]),q=new Path2D;for(S=0;L&&S<=h;S++){let V=S*k;const Y=V+c;for(;V<Y&&!R[V];)V++;if(V===Y)continue;q.moveTo(V%k,S);const K=V;let J=R[V];do{const Z=j[J];do V+=Z;while(!R[V]);const rt=R[V];rt!==5&&rt!==10?(J=rt,R[V]=0):(J=rt&51*J>>4,R[V]&=J>>2|J<<2),q.lineTo(V%k,V/k|0),R[V]||--L}while(K!==V);--S}return E=null,R=null,function(V){V.save(),V.scale(1/c,-1/h),V.translate(0,-h),V.fill(q),V.beginPath(),V.restore()}}class y{constructor(c,h){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,c,h])}clone(){const c=Object.create(this);return c.clipBox=this.clipBox.slice(),c}setCurrentPoint(c,h){this.x=c,this.y=h}updatePathMinMax(c,h,_){[h,_]=a.Util.applyTransform([h,_],c),this.minX=Math.min(this.minX,h),this.minY=Math.min(this.minY,_),this.maxX=Math.max(this.maxX,h),this.maxY=Math.max(this.maxY,_)}updateRectMinMax(c,h){const _=a.Util.applyTransform(h,c),P=a.Util.applyTransform(h.slice(2),c);this.minX=Math.min(this.minX,_[0],P[0]),this.minY=Math.min(this.minY,_[1],P[1]),this.maxX=Math.max(this.maxX,_[0],P[0]),this.maxY=Math.max(this.maxY,_[1],P[1])}updateScalingPathMinMax(c,h){a.Util.scaleMinMax(c,h),this.minX=Math.min(this.minX,h[0]),this.maxX=Math.max(this.maxX,h[1]),this.minY=Math.min(this.minY,h[2]),this.maxY=Math.max(this.maxY,h[3])}updateCurvePathMinMax(c,h,_,P,k,R,S,r,g,A){const E=a.Util.bezierBoundingBox(h,_,P,k,R,S,r,g);if(A){A[0]=Math.min(A[0],E[0],E[2]),A[1]=Math.max(A[1],E[0],E[2]),A[2]=Math.min(A[2],E[1],E[3]),A[3]=Math.max(A[3],E[1],E[3]);return}this.updateRectMinMax(c,E)}getPathBoundingBox(c=I.PathType.FILL,h=null){const _=[this.minX,this.minY,this.maxX,this.maxY];if(c===I.PathType.STROKE){h||(0,a.unreachable)("Stroke bounding box must include transform.");const P=a.Util.singularValueDecompose2dScale(h),k=P[0]*this.lineWidth/2,R=P[1]*this.lineWidth/2;_[0]-=k,_[1]-=R,_[2]+=k,_[3]+=R}return _}updateClipFromPath(){const c=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(c||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(c){this.clipBox=c,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(c=I.PathType.FILL,h=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(c,h))}}function M(b,c){if(typeof ImageData<"u"&&c instanceof ImageData){b.putImageData(c,0,0);return}const h=c.height,_=c.width,P=h%l,k=(h-P)/l,R=P===0?k:k+1,S=b.createImageData(_,l);let r=0,g;const A=c.data,E=S.data;let C,L,j,q;if(c.kind===a.ImageKind.GRAYSCALE_1BPP){const st=A.byteLength,V=new Uint32Array(E.buffer,0,E.byteLength>>2),Y=V.length,K=_+7>>3,J=4294967295,Z=a.FeatureTest.isLittleEndian?4278190080:255;for(C=0;C<R;C++){for(j=C<k?l:P,g=0,L=0;L<j;L++){const rt=st-r;let ot=0;const lt=rt>K?_:rt*8-7,ct=lt&-8;let ht=0,ut=0;for(;ot<ct;ot+=8)ut=A[r++],V[g++]=ut&128?J:Z,V[g++]=ut&64?J:Z,V[g++]=ut&32?J:Z,V[g++]=ut&16?J:Z,V[g++]=ut&8?J:Z,V[g++]=ut&4?J:Z,V[g++]=ut&2?J:Z,V[g++]=ut&1?J:Z;for(;ot<lt;ot++)ht===0&&(ut=A[r++],ht=128),V[g++]=ut&ht?J:Z,ht>>=1}for(;g<Y;)V[g++]=0;b.putImageData(S,0,C*l)}}else if(c.kind===a.ImageKind.RGBA_32BPP){for(L=0,q=_*l*4,C=0;C<k;C++)E.set(A.subarray(r,r+q)),r+=q,b.putImageData(S,0,L),L+=l;C<R&&(q=_*P*4,E.set(A.subarray(r,r+q)),b.putImageData(S,0,L))}else if(c.kind===a.ImageKind.RGB_24BPP)for(j=l,q=_*j,C=0;C<R;C++){for(C>=k&&(j=P,q=_*j),g=0,L=q;L--;)E[g++]=A[r++],E[g++]=A[r++],E[g++]=A[r++],E[g++]=255;b.putImageData(S,0,C*l)}else throw new Error(`bad image kind: ${c.kind}`)}function w(b,c){if(c.bitmap){b.drawImage(c.bitmap,0,0);return}const h=c.height,_=c.width,P=h%l,k=(h-P)/l,R=P===0?k:k+1,S=b.createImageData(_,l);let r=0;const g=c.data,A=S.data;for(let E=0;E<R;E++){const C=E<k?l:P;({srcPos:r}=(0,x.convertBlackAndWhiteToRGBA)({src:g,srcPos:r,dest:A,width:_,height:C,nonBlackColor:0})),b.putImageData(S,0,E*l)}}function f(b,c){const h=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const _ of h)b[_]!==void 0&&(c[_]=b[_]);b.setLineDash!==void 0&&(c.setLineDash(b.getLineDash()),c.lineDashOffset=b.lineDashOffset)}function v(b){if(b.strokeStyle=b.fillStyle="#000000",b.fillRule="nonzero",b.globalAlpha=1,b.lineWidth=1,b.lineCap="butt",b.lineJoin="miter",b.miterLimit=10,b.globalCompositeOperation="source-over",b.font="10px sans-serif",b.setLineDash!==void 0&&(b.setLineDash([]),b.lineDashOffset=0),!a.isNodeJS){const{filter:c}=b;c!=="none"&&c!==""&&(b.filter="none")}}function O(b,c,h,_){const P=b.length;for(let k=3;k<P;k+=4){const R=b[k];if(R===0)b[k-3]=c,b[k-2]=h,b[k-1]=_;else if(R<255){const S=255-R;b[k-3]=b[k-3]*R+c*S>>8,b[k-2]=b[k-2]*R+h*S>>8,b[k-1]=b[k-1]*R+_*S>>8}}}function H(b,c,h){const _=b.length,P=1/255;for(let k=3;k<_;k+=4){const R=h?h[b[k]]:b[k];c[k]=c[k]*R*P|0}}function D(b,c,h){const _=b.length;for(let P=3;P<_;P+=4){const k=b[P-3]*77+b[P-2]*152+b[P-1]*28;c[P]=h?c[P]*h[k>>8]>>8:c[P]*k>>16}}function G(b,c,h,_,P,k,R,S,r,g,A){const E=!!k,C=E?k[0]:0,L=E?k[1]:0,j=E?k[2]:0,q=P==="Luminosity"?D:H,V=Math.min(_,Math.ceil(1048576/h));for(let Y=0;Y<_;Y+=V){const K=Math.min(V,_-Y),J=b.getImageData(S-g,Y+(r-A),h,K),Z=c.getImageData(S,Y+r,h,K);E&&O(J.data,C,L,j),q(J.data,Z.data,R),c.putImageData(Z,S,Y+r)}}function X(b,c,h,_){const P=_[0],k=_[1],R=_[2]-P,S=_[3]-k;R===0||S===0||(G(c.context,h,R,S,c.subtype,c.backdrop,c.transferMap,P,k,c.offsetX,c.offsetY),b.save(),b.globalAlpha=1,b.globalCompositeOperation="source-over",b.setTransform(1,0,0,1,0,0),b.drawImage(h.canvas,0,0),b.restore())}function it(b,c){const h=a.Util.singularValueDecompose2dScale(b);h[0]=Math.fround(h[0]),h[1]=Math.fround(h[1]);const _=Math.fround((globalThis.devicePixelRatio||1)*m.PixelsPerInch.PDF_TO_CSS_UNITS);return c!==void 0?c:h[0]<=_||h[1]<=_}const Q=["butt","round","square"],et=["miter","round","bevel"],nt={},$={};class F{constructor(c,h,_,P,k,{optionalContentConfig:R,markedContentStack:S=null},r,g){this.ctx=c,this.current=new y(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=h,this.objs=_,this.canvasFactory=P,this.filterFactory=k,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=S||[],this.optionalContentConfig=R,this.cachedCanvases=new d(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=r,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=g,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(c,h=null){return typeof c=="string"?c.startsWith("g_")?this.commonObjs.get(c):this.objs.get(c):h}beginDrawing({transform:c,viewport:h,transparency:_=!1,background:P=null}){const k=this.ctx.canvas.width,R=this.ctx.canvas.height,S=this.ctx.fillStyle;if(this.ctx.fillStyle=P||"#ffffff",this.ctx.fillRect(0,0,k,R),this.ctx.fillStyle=S,_){const r=this.cachedCanvases.getCanvas("transparent",k,R);this.compositeCtx=this.ctx,this.transparentCanvas=r.canvas,this.ctx=r.context,this.ctx.save(),this.ctx.transform(...(0,m.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),v(this.ctx),c&&(this.ctx.transform(...c),this.outputScaleX=c[0],this.outputScaleY=c[0]),this.ctx.transform(...h.transform),this.viewportScale=h.scale,this.baseTransform=(0,m.getCurrentTransform)(this.ctx)}executeOperatorList(c,h,_,P){const k=c.argsArray,R=c.fnArray;let S=h||0;const r=k.length;if(r===S)return S;const g=r-S>i&&typeof _=="function",A=g?Date.now()+t:0;let E=0;const C=this.commonObjs,L=this.objs;let j;for(;;){if(P!==void 0&&S===P.nextBreakPoint)return P.breakIt(S,_),S;if(j=R[S],j!==a.OPS.dependency)this[j].apply(this,k[S]);else for(const q of k[S]){const st=q.startsWith("g_")?C:L;if(!st.has(q))return st.get(q,_),S}if(S++,S===r)return S;if(g&&++E>i){if(Date.now()>A)return _(),S;E=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const c of this._cachedBitmapsMap.values()){for(const h of c.values())typeof HTMLCanvasElement<"u"&&h instanceof HTMLCanvasElement&&(h.width=h.height=0);c.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const c=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(c!=="none"){const h=this.ctx.filter;this.ctx.filter=c,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=h}}}_scaleImage(c,h){const _=c.width,P=c.height;let k=Math.max(Math.hypot(h[0],h[1]),1),R=Math.max(Math.hypot(h[2],h[3]),1),S=_,r=P,g="prescale1",A,E;for(;k>2&&S>1||R>2&&r>1;){let C=S,L=r;k>2&&S>1&&(C=S>=16384?Math.floor(S/2)-1||1:Math.ceil(S/2),k/=S/C),R>2&&r>1&&(L=r>=16384?Math.floor(r/2)-1||1:Math.ceil(r)/2,R/=r/L),A=this.cachedCanvases.getCanvas(g,C,L),E=A.context,E.clearRect(0,0,C,L),E.drawImage(c,0,0,S,r,0,0,C,L),c=A.canvas,S=C,r=L,g=g==="prescale1"?"prescale2":"prescale1"}return{img:c,paintWidth:S,paintHeight:r}}_createMaskCanvas(c){const h=this.ctx,{width:_,height:P}=c,k=this.current.fillColor,R=this.current.patternFill,S=(0,m.getCurrentTransform)(h);let r,g,A,E;if((c.bitmap||c.data)&&c.count>1){const ot=c.bitmap||c.data.buffer;g=JSON.stringify(R?S:[S.slice(0,4),k]),r=this._cachedBitmapsMap.get(ot),r||(r=new Map,this._cachedBitmapsMap.set(ot,r));const lt=r.get(g);if(lt&&!R){const ct=Math.round(Math.min(S[0],S[2])+S[4]),ht=Math.round(Math.min(S[1],S[3])+S[5]);return{canvas:lt,offsetX:ct,offsetY:ht}}A=lt}A||(E=this.cachedCanvases.getCanvas("maskCanvas",_,P),w(E.context,c));let C=a.Util.transform(S,[1/_,0,0,-1/P,0,0]);C=a.Util.transform(C,[1,0,0,1,0,-P]);const L=a.Util.applyTransform([0,0],C),j=a.Util.applyTransform([_,P],C),q=a.Util.normalizeRect([L[0],L[1],j[0],j[1]]),st=Math.round(q[2]-q[0])||1,V=Math.round(q[3]-q[1])||1,Y=this.cachedCanvases.getCanvas("fillCanvas",st,V),K=Y.context,J=Math.min(L[0],j[0]),Z=Math.min(L[1],j[1]);K.translate(-J,-Z),K.transform(...C),A||(A=this._scaleImage(E.canvas,(0,m.getCurrentTransformInverse)(K)),A=A.img,r&&R&&r.set(g,A)),K.imageSmoothingEnabled=it((0,m.getCurrentTransform)(K),c.interpolate),p(K,A,0,0,A.width,A.height,0,0,_,P),K.globalCompositeOperation="source-in";const rt=a.Util.transform((0,m.getCurrentTransformInverse)(K),[1,0,0,1,-J,-Z]);return K.fillStyle=R?k.getPattern(h,this,rt,I.PathType.FILL):k,K.fillRect(0,0,_,P),r&&!R&&(this.cachedCanvases.delete("fillCanvas"),r.set(g,Y.canvas)),{canvas:Y.canvas,offsetX:Math.round(J),offsetY:Math.round(Z)}}setLineWidth(c){c!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=c,this.ctx.lineWidth=c}setLineCap(c){this.ctx.lineCap=Q[c]}setLineJoin(c){this.ctx.lineJoin=et[c]}setMiterLimit(c){this.ctx.miterLimit=c}setDash(c,h){const _=this.ctx;_.setLineDash!==void 0&&(_.setLineDash(c),_.lineDashOffset=h)}setRenderingIntent(c){}setFlatness(c){}setGState(c){for(const[h,_]of c)switch(h){case"LW":this.setLineWidth(_);break;case"LC":this.setLineCap(_);break;case"LJ":this.setLineJoin(_);break;case"ML":this.setMiterLimit(_);break;case"D":this.setDash(_[0],_[1]);break;case"RI":this.setRenderingIntent(_);break;case"FL":this.setFlatness(_);break;case"Font":this.setFont(_[0],_[1]);break;case"CA":this.current.strokeAlpha=_;break;case"ca":this.current.fillAlpha=_,this.ctx.globalAlpha=_;break;case"BM":this.ctx.globalCompositeOperation=_;break;case"SMask":this.current.activeSMask=_?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(_);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const c=this.inSMaskMode;this.current.activeSMask&&!c?this.beginSMaskMode():!this.current.activeSMask&&c&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const c=this.ctx.canvas.width,h=this.ctx.canvas.height,_="smaskGroupAt"+this.groupLevel,P=this.cachedCanvases.getCanvas(_,c,h);this.suspendedCtx=this.ctx,this.ctx=P.context;const k=this.ctx;k.setTransform(...(0,m.getCurrentTransform)(this.suspendedCtx)),f(this.suspendedCtx,k),e(k,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),f(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(c){if(!this.current.activeSMask)return;c?(c[0]=Math.floor(c[0]),c[1]=Math.floor(c[1]),c[2]=Math.ceil(c[2]),c[3]=Math.ceil(c[3])):c=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const h=this.current.activeSMask,_=this.suspendedCtx;X(_,h,this.ctx,c),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(f(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const c=this.current;this.stateStack.push(c),this.current=c.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),f(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(c,h,_,P,k,R){this.ctx.transform(c,h,_,P,k,R),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(c,h,_){const P=this.ctx,k=this.current;let R=k.x,S=k.y,r,g;const A=(0,m.getCurrentTransform)(P),E=A[0]===0&&A[3]===0||A[1]===0&&A[2]===0,C=E?_.slice(0):null;for(let L=0,j=0,q=c.length;L<q;L++)switch(c[L]|0){case a.OPS.rectangle:R=h[j++],S=h[j++];const st=h[j++],V=h[j++],Y=R+st,K=S+V;P.moveTo(R,S),st===0||V===0?P.lineTo(Y,K):(P.lineTo(Y,S),P.lineTo(Y,K),P.lineTo(R,K)),E||k.updateRectMinMax(A,[R,S,Y,K]),P.closePath();break;case a.OPS.moveTo:R=h[j++],S=h[j++],P.moveTo(R,S),E||k.updatePathMinMax(A,R,S);break;case a.OPS.lineTo:R=h[j++],S=h[j++],P.lineTo(R,S),E||k.updatePathMinMax(A,R,S);break;case a.OPS.curveTo:r=R,g=S,R=h[j+4],S=h[j+5],P.bezierCurveTo(h[j],h[j+1],h[j+2],h[j+3],R,S),k.updateCurvePathMinMax(A,r,g,h[j],h[j+1],h[j+2],h[j+3],R,S,C),j+=6;break;case a.OPS.curveTo2:r=R,g=S,P.bezierCurveTo(R,S,h[j],h[j+1],h[j+2],h[j+3]),k.updateCurvePathMinMax(A,r,g,R,S,h[j],h[j+1],h[j+2],h[j+3],C),R=h[j+2],S=h[j+3],j+=4;break;case a.OPS.curveTo3:r=R,g=S,R=h[j+2],S=h[j+3],P.bezierCurveTo(h[j],h[j+1],R,S,R,S),k.updateCurvePathMinMax(A,r,g,h[j],h[j+1],R,S,R,S,C),j+=4;break;case a.OPS.closePath:P.closePath();break}E&&k.updateScalingPathMinMax(A,C),k.setCurrentPoint(R,S)}closePath(){this.ctx.closePath()}stroke(c=!0){const h=this.ctx,_=this.current.strokeColor;h.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof _=="object"&&_?.getPattern?(h.save(),h.strokeStyle=_.getPattern(h,this,(0,m.getCurrentTransformInverse)(h),I.PathType.STROKE),this.rescaleAndStroke(!1),h.restore()):this.rescaleAndStroke(!0)),c&&this.consumePath(this.current.getClippedPathBoundingBox()),h.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(c=!0){const h=this.ctx,_=this.current.fillColor,P=this.current.patternFill;let k=!1;P&&(h.save(),h.fillStyle=_.getPattern(h,this,(0,m.getCurrentTransformInverse)(h),I.PathType.FILL),k=!0);const R=this.current.getClippedPathBoundingBox();this.contentVisible&&R!==null&&(this.pendingEOFill?(h.fill("evenodd"),this.pendingEOFill=!1):h.fill()),k&&h.restore(),c&&this.consumePath(R)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=nt}eoClip(){this.pendingClip=$}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const c=this.pendingTextPaths,h=this.ctx;if(c===void 0){h.beginPath();return}h.save(),h.beginPath();for(const _ of c)h.setTransform(..._.transform),h.translate(_.x,_.y),_.addToPath(h,_.fontSize);h.restore(),h.clip(),h.beginPath(),delete this.pendingTextPaths}setCharSpacing(c){this.current.charSpacing=c}setWordSpacing(c){this.current.wordSpacing=c}setHScale(c){this.current.textHScale=c/100}setLeading(c){this.current.leading=-c}setFont(c,h){const _=this.commonObjs.get(c),P=this.current;if(!_)throw new Error(`Can't find font for ${c}`);if(P.fontMatrix=_.fontMatrix||a.FONT_IDENTITY_MATRIX,(P.fontMatrix[0]===0||P.fontMatrix[3]===0)&&(0,a.warn)("Invalid font matrix for font "+c),h<0?(h=-h,P.fontDirection=-1):P.fontDirection=1,this.current.font=_,this.current.fontSize=h,_.isType3Font)return;const k=_.loadedName||"sans-serif",R=_.systemFontInfo?.css||`"${k}", ${_.fallbackName}`;let S="normal";_.black?S="900":_.bold&&(S="bold");const r=_.italic?"italic":"normal";let g=h;h<B?g=B:h>U&&(g=U),this.current.fontSizeScale=h/g,this.ctx.font=`${r} ${S} ${g}px ${R}`}setTextRenderingMode(c){this.current.textRenderingMode=c}setTextRise(c){this.current.textRise=c}moveText(c,h){this.current.x=this.current.lineX+=c,this.current.y=this.current.lineY+=h}setLeadingMoveText(c,h){this.setLeading(-h),this.moveText(c,h)}setTextMatrix(c,h,_,P,k,R){this.current.textMatrix=[c,h,_,P,k,R],this.current.textMatrixScale=Math.hypot(c,h),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(c,h,_,P){const k=this.ctx,R=this.current,S=R.font,r=R.textRenderingMode,g=R.fontSize/R.fontSizeScale,A=r&a.TextRenderingMode.FILL_STROKE_MASK,E=!!(r&a.TextRenderingMode.ADD_TO_PATH_FLAG),C=R.patternFill&&!S.missingFile;let L;(S.disableFontFace||E||C)&&(L=S.getPathGenerator(this.commonObjs,c)),S.disableFontFace||C?(k.save(),k.translate(h,_),k.beginPath(),L(k,g),P&&k.setTransform(...P),(A===a.TextRenderingMode.FILL||A===a.TextRenderingMode.FILL_STROKE)&&k.fill(),(A===a.TextRenderingMode.STROKE||A===a.TextRenderingMode.FILL_STROKE)&&k.stroke(),k.restore()):((A===a.TextRenderingMode.FILL||A===a.TextRenderingMode.FILL_STROKE)&&k.fillText(c,h,_),(A===a.TextRenderingMode.STROKE||A===a.TextRenderingMode.FILL_STROKE)&&k.strokeText(c,h,_)),E&&(this.pendingTextPaths||=[]).push({transform:(0,m.getCurrentTransform)(k),x:h,y:_,fontSize:g,addToPath:L})}get isFontSubpixelAAEnabled(){const{context:c}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);c.scale(1.5,1),c.fillText("I",0,10);const h=c.getImageData(0,0,10,10).data;let _=!1;for(let P=3;P<h.length;P+=4)if(h[P]>0&&h[P]<255){_=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",_)}showText(c){const h=this.current,_=h.font;if(_.isType3Font)return this.showType3Text(c);const P=h.fontSize;if(P===0)return;const k=this.ctx,R=h.fontSizeScale,S=h.charSpacing,r=h.wordSpacing,g=h.fontDirection,A=h.textHScale*g,E=c.length,C=_.vertical,L=C?1:-1,j=_.defaultVMetrics,q=P*h.fontMatrix[0],st=h.textRenderingMode===a.TextRenderingMode.FILL&&!_.disableFontFace&&!h.patternFill;k.save(),k.transform(...h.textMatrix),k.translate(h.x,h.y+h.textRise),g>0?k.scale(A,-1):k.scale(A,1);let V;if(h.patternFill){k.save();const rt=h.fillColor.getPattern(k,this,(0,m.getCurrentTransformInverse)(k),I.PathType.FILL);V=(0,m.getCurrentTransform)(k),k.restore(),k.fillStyle=rt}let Y=h.lineWidth;const K=h.textMatrixScale;if(K===0||Y===0){const rt=h.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;(rt===a.TextRenderingMode.STROKE||rt===a.TextRenderingMode.FILL_STROKE)&&(Y=this.getSinglePixelWidth())}else Y/=K;if(R!==1&&(k.scale(R,R),Y/=R),k.lineWidth=Y,_.isInvalidPDFjsFont){const rt=[];let ot=0;for(const lt of c)rt.push(lt.unicode),ot+=lt.width;k.fillText(rt.join(""),0,0),h.x+=ot*q*A,k.restore(),this.compose();return}let J=0,Z;for(Z=0;Z<E;++Z){const rt=c[Z];if(typeof rt=="number"){J+=L*rt*P/1e3;continue}let ot=!1;const lt=(rt.isSpace?r:0)+S,ct=rt.fontChar,ht=rt.accent;let ut,At,mt=rt.width;if(C){const bt=rt.vmetric||j,vt=-(rt.vmetric?bt[1]:mt*.5)*q,Dt=bt[2]*q;mt=bt?-bt[0]:mt,ut=vt/R,At=(J+Dt)/R}else ut=J/R,At=0;if(_.remeasure&&mt>0){const bt=k.measureText(ct).width*1e3/P*R;if(mt<bt&&this.isFontSubpixelAAEnabled){const vt=mt/bt;ot=!0,k.save(),k.scale(vt,1),ut/=vt}else mt!==bt&&(ut+=(mt-bt)/2e3*P/R)}if(this.contentVisible&&(rt.isInFont||_.missingFile)){if(st&&!ht)k.fillText(ct,ut,At);else if(this.paintChar(ct,ut,At,V),ht){const bt=ut+P*ht.offset.x/R,vt=At-P*ht.offset.y/R;this.paintChar(ht.fontChar,bt,vt,V)}}const wt=C?mt*q-lt*g:mt*q+lt*g;J+=wt,ot&&k.restore()}C?h.y-=J:h.x+=J*A,k.restore(),this.compose()}showType3Text(c){const h=this.ctx,_=this.current,P=_.font,k=_.fontSize,R=_.fontDirection,S=P.vertical?1:-1,r=_.charSpacing,g=_.wordSpacing,A=_.textHScale*R,E=_.fontMatrix||a.FONT_IDENTITY_MATRIX,C=c.length,L=_.textRenderingMode===a.TextRenderingMode.INVISIBLE;let j,q,st,V;if(!(L||k===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,h.save(),h.transform(..._.textMatrix),h.translate(_.x,_.y),h.scale(A,R),j=0;j<C;++j){if(q=c[j],typeof q=="number"){V=S*q*k/1e3,this.ctx.translate(V,0),_.x+=V*A;continue}const Y=(q.isSpace?g:0)+r,K=P.charProcOperatorList[q.operatorListId];if(!K){(0,a.warn)(`Type3 character "${q.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=q,this.save(),h.scale(k,k),h.transform(...E),this.executeOperatorList(K),this.restore()),st=a.Util.applyTransform([q.width,0],E)[0]*k+Y,h.translate(st,0),_.x+=st*A}h.restore(),this.processingType3=null}}setCharWidth(c,h){}setCharWidthAndBounds(c,h,_,P,k,R){this.ctx.rect(_,P,k-_,R-P),this.ctx.clip(),this.endPath()}getColorN_Pattern(c){let h;if(c[0]==="TilingPattern"){const _=c[1],P=this.baseTransform||(0,m.getCurrentTransform)(this.ctx),k={createCanvasGraphics:R=>new F(R,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};h=new I.TilingPattern(c,_,this.ctx,k,P)}else h=this._getPattern(c[1],c[2]);return h}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(c,h,_){const P=a.Util.makeHexColor(c,h,_);this.ctx.strokeStyle=P,this.current.strokeColor=P}setFillRGBColor(c,h,_){const P=a.Util.makeHexColor(c,h,_);this.ctx.fillStyle=P,this.current.fillColor=P,this.current.patternFill=!1}_getPattern(c,h=null){let _;return this.cachedPatterns.has(c)?_=this.cachedPatterns.get(c):(_=(0,I.getShadingPattern)(this.getObject(c)),this.cachedPatterns.set(c,_)),h&&(_.matrix=h),_}shadingFill(c){if(!this.contentVisible)return;const h=this.ctx;this.save();const _=this._getPattern(c);h.fillStyle=_.getPattern(h,this,(0,m.getCurrentTransformInverse)(h),I.PathType.SHADING);const P=(0,m.getCurrentTransformInverse)(h);if(P){const{width:k,height:R}=h.canvas,[S,r,g,A]=a.Util.getAxialAlignedBoundingBox([0,0,k,R],P);this.ctx.fillRect(S,r,g-S,A-r)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(c,h){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(c)&&c.length===6&&this.transform(...c),this.baseTransform=(0,m.getCurrentTransform)(this.ctx),h)){const _=h[2]-h[0],P=h[3]-h[1];this.ctx.rect(h[0],h[1],_,P),this.current.updateRectMinMax((0,m.getCurrentTransform)(this.ctx),h),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(c){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const h=this.ctx;c.isolated||(0,a.info)("TODO: Support non-isolated groups."),c.knockout&&(0,a.warn)("Knockout groups not supported.");const _=(0,m.getCurrentTransform)(h);if(c.matrix&&h.transform(...c.matrix),!c.bbox)throw new Error("Bounding box is required.");let P=a.Util.getAxialAlignedBoundingBox(c.bbox,(0,m.getCurrentTransform)(h));const k=[0,0,h.canvas.width,h.canvas.height];P=a.Util.intersect(P,k)||[0,0,0,0];const R=Math.floor(P[0]),S=Math.floor(P[1]);let r=Math.max(Math.ceil(P[2])-R,1),g=Math.max(Math.ceil(P[3])-S,1),A=1,E=1;r>s&&(A=r/s,r=s),g>s&&(E=g/s,g=s),this.current.startNewPathAndClipBox([0,0,r,g]);let C="groupAt"+this.groupLevel;c.smask&&(C+="_smask_"+this.smaskCounter++%2);const L=this.cachedCanvases.getCanvas(C,r,g),j=L.context;j.scale(1/A,1/E),j.translate(-R,-S),j.transform(..._),c.smask?this.smaskStack.push({canvas:L.canvas,context:j,offsetX:R,offsetY:S,scaleX:A,scaleY:E,subtype:c.smask.subtype,backdrop:c.smask.backdrop,transferMap:c.smask.transferMap||null,startTransformInverse:null}):(h.setTransform(1,0,0,1,0,0),h.translate(R,S),h.scale(A,E),h.save()),f(h,j),this.ctx=j,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(h),this.groupLevel++}endGroup(c){if(!this.contentVisible)return;this.groupLevel--;const h=this.ctx,_=this.groupStack.pop();if(this.ctx=_,this.ctx.imageSmoothingEnabled=!1,c.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const P=(0,m.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...P);const k=a.Util.getAxialAlignedBoundingBox([0,0,h.canvas.width,h.canvas.height],P);this.ctx.drawImage(h.canvas,0,0),this.ctx.restore(),this.compose(k)}}beginAnnotation(c,h,_,P,k){if(this.#t(),v(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(h)&&h.length===4){const R=h[2]-h[0],S=h[3]-h[1];if(k&&this.annotationCanvasMap){_=_.slice(),_[4]-=h[0],_[5]-=h[1],h=h.slice(),h[0]=h[1]=0,h[2]=R,h[3]=S;const[r,g]=a.Util.singularValueDecompose2dScale((0,m.getCurrentTransform)(this.ctx)),{viewportScale:A}=this,E=Math.ceil(R*this.outputScaleX*A),C=Math.ceil(S*this.outputScaleY*A);this.annotationCanvas=this.canvasFactory.create(E,C);const{canvas:L,context:j}=this.annotationCanvas;this.annotationCanvasMap.set(c,L),this.annotationCanvas.savedCtx=this.ctx,this.ctx=j,this.ctx.save(),this.ctx.setTransform(r,0,0,-g,0,S*g),v(this.ctx)}else v(this.ctx),this.ctx.rect(h[0],h[1],R,S),this.ctx.clip(),this.endPath()}this.current=new y(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(..._),this.transform(...P)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(c){if(!this.contentVisible)return;const h=c.count;c=this.getObject(c.data,c),c.count=h;const _=this.ctx,P=this.processingType3;if(P&&(P.compiled===void 0&&(P.compiled=o(c)),P.compiled)){P.compiled(_);return}const k=this._createMaskCanvas(c),R=k.canvas;_.save(),_.setTransform(1,0,0,1,0,0),_.drawImage(R,k.offsetX,k.offsetY),_.restore(),this.compose()}paintImageMaskXObjectRepeat(c,h,_=0,P=0,k,R){if(!this.contentVisible)return;c=this.getObject(c.data,c);const S=this.ctx;S.save();const r=(0,m.getCurrentTransform)(S);S.transform(h,_,P,k,0,0);const g=this._createMaskCanvas(c);S.setTransform(1,0,0,1,g.offsetX-r[4],g.offsetY-r[5]);for(let A=0,E=R.length;A<E;A+=2){const C=a.Util.transform(r,[h,_,P,k,R[A],R[A+1]]),[L,j]=a.Util.applyTransform([0,0],C);S.drawImage(g.canvas,L,j)}S.restore(),this.compose()}paintImageMaskXObjectGroup(c){if(!this.contentVisible)return;const h=this.ctx,_=this.current.fillColor,P=this.current.patternFill;for(const k of c){const{data:R,width:S,height:r,transform:g}=k,A=this.cachedCanvases.getCanvas("maskCanvas",S,r),E=A.context;E.save();const C=this.getObject(R,k);w(E,C),E.globalCompositeOperation="source-in",E.fillStyle=P?_.getPattern(E,this,(0,m.getCurrentTransformInverse)(h),I.PathType.FILL):_,E.fillRect(0,0,S,r),E.restore(),h.save(),h.transform(...g),h.scale(1,-1),p(h,A.canvas,0,0,S,r,0,-1,1,1),h.restore()}this.compose()}paintImageXObject(c){if(!this.contentVisible)return;const h=this.getObject(c);if(!h){(0,a.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(h)}paintImageXObjectRepeat(c,h,_,P){if(!this.contentVisible)return;const k=this.getObject(c);if(!k){(0,a.warn)("Dependent image isn't ready yet");return}const R=k.width,S=k.height,r=[];for(let g=0,A=P.length;g<A;g+=2)r.push({transform:[h,0,0,_,P[g],P[g+1]],x:0,y:0,w:R,h:S});this.paintInlineImageXObjectGroup(k,r)}applyTransferMapsToCanvas(c){return this.current.transferMaps!=="none"&&(c.filter=this.current.transferMaps,c.drawImage(c.canvas,0,0),c.filter="none"),c.canvas}applyTransferMapsToBitmap(c){if(this.current.transferMaps==="none")return c.bitmap;const{bitmap:h,width:_,height:P}=c,k=this.cachedCanvases.getCanvas("inlineImage",_,P),R=k.context;return R.filter=this.current.transferMaps,R.drawImage(h,0,0),R.filter="none",k.canvas}paintInlineImageXObject(c){if(!this.contentVisible)return;const h=c.width,_=c.height,P=this.ctx;if(this.save(),!a.isNodeJS){const{filter:S}=P;S!=="none"&&S!==""&&(P.filter="none")}P.scale(1/h,-1/_);let k;if(c.bitmap)k=this.applyTransferMapsToBitmap(c);else if(typeof HTMLElement=="function"&&c instanceof HTMLElement||!c.data)k=c;else{const r=this.cachedCanvases.getCanvas("inlineImage",h,_).context;M(r,c),k=this.applyTransferMapsToCanvas(r)}const R=this._scaleImage(k,(0,m.getCurrentTransformInverse)(P));P.imageSmoothingEnabled=it((0,m.getCurrentTransform)(P),c.interpolate),p(P,R.img,0,0,R.paintWidth,R.paintHeight,0,-_,h,_),this.compose(),this.restore()}paintInlineImageXObjectGroup(c,h){if(!this.contentVisible)return;const _=this.ctx;let P;if(c.bitmap)P=c.bitmap;else{const k=c.width,R=c.height,r=this.cachedCanvases.getCanvas("inlineImage",k,R).context;M(r,c),P=this.applyTransferMapsToCanvas(r)}for(const k of h)_.save(),_.transform(...k.transform),_.scale(1,-1),p(_,P,k.x,k.y,k.w,k.h,0,-1,1,1),_.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(c){}markPointProps(c,h){}beginMarkedContent(c){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(c,h){c==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(h)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(c){const h=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(c);const _=this.ctx;this.pendingClip&&(h||(this.pendingClip===$?_.clip("evenodd"):_.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),_.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const c=(0,m.getCurrentTransform)(this.ctx);if(c[1]===0&&c[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(c[0]),Math.abs(c[3]));else{const h=Math.abs(c[0]*c[3]-c[2]*c[1]),_=Math.hypot(c[0],c[2]),P=Math.hypot(c[1],c[3]);this._cachedGetSinglePixelWidth=Math.max(_,P)/h}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:c}=this.current,{a:h,b:_,c:P,d:k}=this.ctx.getTransform();let R,S;if(_===0&&P===0){const r=Math.abs(h),g=Math.abs(k);if(r===g)if(c===0)R=S=1/r;else{const A=r*c;R=S=A<1?1/A:1}else if(c===0)R=1/r,S=1/g;else{const A=r*c,E=g*c;R=A<1?1/A:1,S=E<1?1/E:1}}else{const r=Math.abs(h*k-_*P),g=Math.hypot(h,_),A=Math.hypot(P,k);if(c===0)R=A/r,S=g/r;else{const E=c*r;R=A>E?A/E:1,S=g>E?g/E:1}}this._cachedScaleForStroking[0]=R,this._cachedScaleForStroking[1]=S}return this._cachedScaleForStroking}rescaleAndStroke(c){const{ctx:h}=this,{lineWidth:_}=this.current,[P,k]=this.getScaleForStroking();if(h.lineWidth=_||1,P===1&&k===1){h.stroke();return}const R=h.getLineDash();if(c&&h.save(),h.scale(P,k),R.length>0){const S=Math.max(P,k);h.setLineDash(R.map(r=>r/S)),h.lineDashOffset/=S}h.stroke(),c&&h.restore()}isContentVisible(){for(let c=this.markedContentStack.length-1;c>=0;c--)if(!this.markedContentStack[c].visible)return!1;return!0}}n.CanvasGraphics=F;for(const b in a.OPS)F.prototype[b]!==void 0&&(F.prototype[a.OPS[b]]=F.prototype[b])}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TilingPattern=n.PathType=void 0,n.getShadingPattern=l;var a=T(1),m=T(6);const I={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};n.PathType=I;function x(p,o){if(!o)return;const y=o[2]-o[0],M=o[3]-o[1],w=new Path2D;w.rect(o[0],o[1],y,M),p.clip(w)}class B{constructor(){this.constructor===B&&(0,a.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,a.unreachable)("Abstract method `getPattern` called.")}}class U extends B{constructor(o){super(),this._type=o[1],this._bbox=o[2],this._colorStops=o[3],this._p0=o[4],this._p1=o[5],this._r0=o[6],this._r1=o[7],this.matrix=null}_createGradient(o){let y;this._type==="axial"?y=o.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(y=o.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const M of this._colorStops)y.addColorStop(M[0],M[1]);return y}getPattern(o,y,M,w){let f;if(w===I.STROKE||w===I.FILL){const v=y.current.getClippedPathBoundingBox(w,(0,m.getCurrentTransform)(o))||[0,0,0,0],O=Math.ceil(v[2]-v[0])||1,H=Math.ceil(v[3]-v[1])||1,D=y.cachedCanvases.getCanvas("pattern",O,H,!0),G=D.context;G.clearRect(0,0,G.canvas.width,G.canvas.height),G.beginPath(),G.rect(0,0,G.canvas.width,G.canvas.height),G.translate(-v[0],-v[1]),M=a.Util.transform(M,[1,0,0,1,v[0],v[1]]),G.transform(...y.baseTransform),this.matrix&&G.transform(...this.matrix),x(G,this._bbox),G.fillStyle=this._createGradient(G),G.fill(),f=o.createPattern(D.canvas,"no-repeat");const X=new DOMMatrix(M);f.setTransform(X)}else x(o,this._bbox),f=this._createGradient(o);return f}}function s(p,o,y,M,w,f,v,O){const H=o.coords,D=o.colors,G=p.data,X=p.width*4;let it;H[y+1]>H[M+1]&&(it=y,y=M,M=it,it=f,f=v,v=it),H[M+1]>H[w+1]&&(it=M,M=w,w=it,it=v,v=O,O=it),H[y+1]>H[M+1]&&(it=y,y=M,M=it,it=f,f=v,v=it);const Q=(H[y]+o.offsetX)*o.scaleX,et=(H[y+1]+o.offsetY)*o.scaleY,nt=(H[M]+o.offsetX)*o.scaleX,$=(H[M+1]+o.offsetY)*o.scaleY,F=(H[w]+o.offsetX)*o.scaleX,b=(H[w+1]+o.offsetY)*o.scaleY;if(et>=b)return;const c=D[f],h=D[f+1],_=D[f+2],P=D[v],k=D[v+1],R=D[v+2],S=D[O],r=D[O+1],g=D[O+2],A=Math.round(et),E=Math.round(b);let C,L,j,q,st,V,Y,K;for(let J=A;J<=E;J++){if(J<$){const ct=J<et?0:(et-J)/(et-$);C=Q-(Q-nt)*ct,L=c-(c-P)*ct,j=h-(h-k)*ct,q=_-(_-R)*ct}else{let ct;J>b?ct=1:$===b?ct=0:ct=($-J)/($-b),C=nt-(nt-F)*ct,L=P-(P-S)*ct,j=k-(k-r)*ct,q=R-(R-g)*ct}let Z;J<et?Z=0:J>b?Z=1:Z=(et-J)/(et-b),st=Q-(Q-F)*Z,V=c-(c-S)*Z,Y=h-(h-r)*Z,K=_-(_-g)*Z;const rt=Math.round(Math.min(C,st)),ot=Math.round(Math.max(C,st));let lt=X*J+rt*4;for(let ct=rt;ct<=ot;ct++)Z=(C-ct)/(C-st),Z<0?Z=0:Z>1&&(Z=1),G[lt++]=L-(L-V)*Z|0,G[lt++]=j-(j-Y)*Z|0,G[lt++]=q-(q-K)*Z|0,G[lt++]=255}}function t(p,o,y){const M=o.coords,w=o.colors;let f,v;switch(o.type){case"lattice":const O=o.verticesPerRow,H=Math.floor(M.length/O)-1,D=O-1;for(f=0;f<H;f++){let G=f*O;for(let X=0;X<D;X++,G++)s(p,y,M[G],M[G+1],M[G+O],w[G],w[G+1],w[G+O]),s(p,y,M[G+O+1],M[G+1],M[G+O],w[G+O+1],w[G+1],w[G+O])}break;case"triangles":for(f=0,v=M.length;f<v;f+=3)s(p,y,M[f],M[f+1],M[f+2],w[f],w[f+1],w[f+2]);break;default:throw new Error("illegal figure")}}class i extends B{constructor(o){super(),this._coords=o[2],this._colors=o[3],this._figures=o[4],this._bounds=o[5],this._bbox=o[7],this._background=o[8],this.matrix=null}_createMeshCanvas(o,y,M){const O=Math.floor(this._bounds[0]),H=Math.floor(this._bounds[1]),D=Math.ceil(this._bounds[2])-O,G=Math.ceil(this._bounds[3])-H,X=Math.min(Math.ceil(Math.abs(D*o[0]*1.1)),3e3),it=Math.min(Math.ceil(Math.abs(G*o[1]*1.1)),3e3),Q=D/X,et=G/it,nt={coords:this._coords,colors:this._colors,offsetX:-O,offsetY:-H,scaleX:1/Q,scaleY:1/et},$=X+4,F=it+4,b=M.getCanvas("mesh",$,F,!1),c=b.context,h=c.createImageData(X,it);if(y){const P=h.data;for(let k=0,R=P.length;k<R;k+=4)P[k]=y[0],P[k+1]=y[1],P[k+2]=y[2],P[k+3]=255}for(const P of this._figures)t(h,P,nt);return c.putImageData(h,2,2),{canvas:b.canvas,offsetX:O-2*Q,offsetY:H-2*et,scaleX:Q,scaleY:et}}getPattern(o,y,M,w){x(o,this._bbox);let f;if(w===I.SHADING)f=a.Util.singularValueDecompose2dScale((0,m.getCurrentTransform)(o));else if(f=a.Util.singularValueDecompose2dScale(y.baseTransform),this.matrix){const O=a.Util.singularValueDecompose2dScale(this.matrix);f=[f[0]*O[0],f[1]*O[1]]}const v=this._createMeshCanvas(f,w===I.SHADING?null:this._background,y.cachedCanvases);return w!==I.SHADING&&(o.setTransform(...y.baseTransform),this.matrix&&o.transform(...this.matrix)),o.translate(v.offsetX,v.offsetY),o.scale(v.scaleX,v.scaleY),o.createPattern(v.canvas,"no-repeat")}}class u extends B{getPattern(){return"hotpink"}}function l(p){switch(p[0]){case"RadialAxial":return new U(p);case"Mesh":return new i(p);case"Dummy":return new u}throw new Error(`Unknown IR type: ${p[0]}`)}const e={COLORED:1,UNCOLORED:2};class d{static MAX_PATTERN_SIZE=3e3;constructor(o,y,M,w,f){this.operatorList=o[2],this.matrix=o[3]||[1,0,0,1,0,0],this.bbox=o[4],this.xstep=o[5],this.ystep=o[6],this.paintType=o[7],this.tilingType=o[8],this.color=y,this.ctx=M,this.canvasGraphicsFactory=w,this.baseTransform=f}createPatternCanvas(o){const y=this.operatorList,M=this.bbox,w=this.xstep,f=this.ystep,v=this.paintType,O=this.tilingType,H=this.color,D=this.canvasGraphicsFactory;(0,a.info)("TilingType: "+O);const G=M[0],X=M[1],it=M[2],Q=M[3],et=a.Util.singularValueDecompose2dScale(this.matrix),nt=a.Util.singularValueDecompose2dScale(this.baseTransform),$=[et[0]*nt[0],et[1]*nt[1]],F=this.getSizeAndScale(w,this.ctx.canvas.width,$[0]),b=this.getSizeAndScale(f,this.ctx.canvas.height,$[1]),c=o.cachedCanvases.getCanvas("pattern",F.size,b.size,!0),h=c.context,_=D.createCanvasGraphics(h);_.groupLevel=o.groupLevel,this.setFillAndStrokeStyleToContext(_,v,H);let P=G,k=X,R=it,S=Q;return G<0&&(P=0,R+=Math.abs(G)),X<0&&(k=0,S+=Math.abs(X)),h.translate(-(F.scale*P),-(b.scale*k)),_.transform(F.scale,0,0,b.scale,0,0),h.save(),this.clipBbox(_,P,k,R,S),_.baseTransform=(0,m.getCurrentTransform)(_.ctx),_.executeOperatorList(y),_.endDrawing(),{canvas:c.canvas,scaleX:F.scale,scaleY:b.scale,offsetX:P,offsetY:k}}getSizeAndScale(o,y,M){o=Math.abs(o);const w=Math.max(d.MAX_PATTERN_SIZE,y);let f=Math.ceil(o*M);return f>=w?f=w:M=f/o,{scale:M,size:f}}clipBbox(o,y,M,w,f){const v=w-y,O=f-M;o.ctx.rect(y,M,v,O),o.current.updateRectMinMax((0,m.getCurrentTransform)(o.ctx),[y,M,w,f]),o.clip(),o.endPath()}setFillAndStrokeStyleToContext(o,y,M){const w=o.ctx,f=o.current;switch(y){case e.COLORED:const v=this.ctx;w.fillStyle=v.fillStyle,w.strokeStyle=v.strokeStyle,f.fillColor=v.fillStyle,f.strokeColor=v.strokeStyle;break;case e.UNCOLORED:const O=a.Util.makeHexColor(M[0],M[1],M[2]);w.fillStyle=O,w.strokeStyle=O,f.fillColor=O,f.strokeColor=O;break;default:throw new a.FormatError(`Unsupported paint type: ${y}`)}}getPattern(o,y,M,w){let f=M;w!==I.SHADING&&(f=a.Util.transform(f,y.baseTransform),this.matrix&&(f=a.Util.transform(f,this.matrix)));const v=this.createPatternCanvas(y);let O=new DOMMatrix(f);O=O.translate(v.offsetX,v.offsetY),O=O.scale(1/v.scaleX,1/v.scaleY);const H=o.createPattern(v.canvas,"repeat");return H.setTransform(O),H}}n.TilingPattern=d}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.convertBlackAndWhiteToRGBA=I,n.convertToRGBA=m,n.grayToRGBA=B;var a=T(1);function m(U){switch(U.kind){case a.ImageKind.GRAYSCALE_1BPP:return I(U);case a.ImageKind.RGB_24BPP:return x(U)}return null}function I({src:U,srcPos:s=0,dest:t,width:i,height:u,nonBlackColor:l=4294967295,inverseDecode:e=!1}){const d=a.FeatureTest.isLittleEndian?4278190080:255,[p,o]=e?[l,d]:[d,l],y=i>>3,M=i&7,w=U.length;t=new Uint32Array(t.buffer);let f=0;for(let v=0;v<u;v++){for(const H=s+y;s<H;s++){const D=s<w?U[s]:255;t[f++]=D&128?o:p,t[f++]=D&64?o:p,t[f++]=D&32?o:p,t[f++]=D&16?o:p,t[f++]=D&8?o:p,t[f++]=D&4?o:p,t[f++]=D&2?o:p,t[f++]=D&1?o:p}if(M===0)continue;const O=s<w?U[s++]:255;for(let H=0;H<M;H++)t[f++]=O&1<<7-H?o:p}return{srcPos:s,destPos:f}}function x({src:U,srcPos:s=0,dest:t,destPos:i=0,width:u,height:l}){let e=0;const d=U.length>>2,p=new Uint32Array(U.buffer,s,d);if(a.FeatureTest.isLittleEndian){for(;e<d-2;e+=3,i+=4){const o=p[e],y=p[e+1],M=p[e+2];t[i]=o|4278190080,t[i+1]=o>>>24|y<<8|4278190080,t[i+2]=y>>>16|M<<16|4278190080,t[i+3]=M>>>8|4278190080}for(let o=e*4,y=U.length;o<y;o+=3)t[i++]=U[o]|U[o+1]<<8|U[o+2]<<16|4278190080}else{for(;e<d-2;e+=3,i+=4){const o=p[e],y=p[e+1],M=p[e+2];t[i]=o|255,t[i+1]=o<<24|y>>>8|255,t[i+2]=y<<16|M>>>16|255,t[i+3]=M<<8|255}for(let o=e*4,y=U.length;o<y;o+=3)t[i++]=U[o]<<24|U[o+1]<<16|U[o+2]<<8|255}return{srcPos:s,destPos:i}}function B(U,s){if(a.FeatureTest.isLittleEndian)for(let t=0,i=U.length;t<i;t++)s[t]=U[t]*65793|4278190080;else for(let t=0,i=U.length;t<i;t++)s[t]=U[t]*16843008|255}}),((N,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const T=Object.create(null);n.GlobalWorkerOptions=T,T.workerPort=null,T.workerSrc=""}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var a=T(1);const m={DATA:1,ERROR:2},I={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function x(U){switch(U instanceof Error||typeof U=="object"&&U!==null||(0,a.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),U.name){case"AbortException":return new a.AbortException(U.message);case"MissingPDFException":return new a.MissingPDFException(U.message);case"PasswordException":return new a.PasswordException(U.message,U.code);case"UnexpectedResponseException":return new a.UnexpectedResponseException(U.message,U.status);case"UnknownErrorException":return new a.UnknownErrorException(U.message,U.details);default:return new a.UnknownErrorException(U.message,U.toString())}}class B{constructor(s,t,i){this.sourceName=s,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=u=>{const l=u.data;if(l.targetName!==this.sourceName)return;if(l.stream){this.#e(l);return}if(l.callback){const d=l.callbackId,p=this.callbackCapabilities[d];if(!p)throw new Error(`Cannot resolve callback ${d}`);if(delete this.callbackCapabilities[d],l.callback===m.DATA)p.resolve(l.data);else if(l.callback===m.ERROR)p.reject(x(l.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[l.action];if(!e)throw new Error(`Unknown action from worker: ${l.action}`);if(l.callbackId){const d=this.sourceName,p=l.sourceName;new Promise(function(o){o(e(l.data))}).then(function(o){i.postMessage({sourceName:d,targetName:p,callback:m.DATA,callbackId:l.callbackId,data:o})},function(o){i.postMessage({sourceName:d,targetName:p,callback:m.ERROR,callbackId:l.callbackId,reason:x(o)})});return}if(l.streamId){this.#t(l);return}e(l.data)},i.addEventListener("message",this._onComObjOnMessage)}on(s,t){const i=this.actionHandler;if(i[s])throw new Error(`There is already an actionName called "${s}"`);i[s]=t}send(s,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:s,data:t},i)}sendWithPromise(s,t,i){const u=this.callbackId++,l=new a.PromiseCapability;this.callbackCapabilities[u]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:s,callbackId:u,data:t},i)}catch(e){l.reject(e)}return l.promise}sendWithStream(s,t,i,u){const l=this.streamId++,e=this.sourceName,d=this.targetName,p=this.comObj;return new ReadableStream({start:o=>{const y=new a.PromiseCapability;return this.streamControllers[l]={controller:o,startCall:y,pullCall:null,cancelCall:null,isClosed:!1},p.postMessage({sourceName:e,targetName:d,action:s,streamId:l,data:t,desiredSize:o.desiredSize},u),y.promise},pull:o=>{const y=new a.PromiseCapability;return this.streamControllers[l].pullCall=y,p.postMessage({sourceName:e,targetName:d,stream:I.PULL,streamId:l,desiredSize:o.desiredSize}),y.promise},cancel:o=>{(0,a.assert)(o instanceof Error,"cancel must have a valid reason");const y=new a.PromiseCapability;return this.streamControllers[l].cancelCall=y,this.streamControllers[l].isClosed=!0,p.postMessage({sourceName:e,targetName:d,stream:I.CANCEL,streamId:l,reason:x(o)}),y.promise}},i)}#t(s){const t=s.streamId,i=this.sourceName,u=s.sourceName,l=this.comObj,e=this,d=this.actionHandler[s.action],p={enqueue(o,y=1,M){if(this.isCancelled)return;const w=this.desiredSize;this.desiredSize-=y,w>0&&this.desiredSize<=0&&(this.sinkCapability=new a.PromiseCapability,this.ready=this.sinkCapability.promise),l.postMessage({sourceName:i,targetName:u,stream:I.ENQUEUE,streamId:t,chunk:o},M)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:u,stream:I.CLOSE,streamId:t}),delete e.streamSinks[t])},error(o){(0,a.assert)(o instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:u,stream:I.ERROR,streamId:t,reason:x(o)}))},sinkCapability:new a.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:s.desiredSize,ready:null};p.sinkCapability.resolve(),p.ready=p.sinkCapability.promise,this.streamSinks[t]=p,new Promise(function(o){o(d(s.data,p))}).then(function(){l.postMessage({sourceName:i,targetName:u,stream:I.START_COMPLETE,streamId:t,success:!0})},function(o){l.postMessage({sourceName:i,targetName:u,stream:I.START_COMPLETE,streamId:t,reason:x(o)})})}#e(s){const t=s.streamId,i=this.sourceName,u=s.sourceName,l=this.comObj,e=this.streamControllers[t],d=this.streamSinks[t];switch(s.stream){case I.START_COMPLETE:s.success?e.startCall.resolve():e.startCall.reject(x(s.reason));break;case I.PULL_COMPLETE:s.success?e.pullCall.resolve():e.pullCall.reject(x(s.reason));break;case I.PULL:if(!d){l.postMessage({sourceName:i,targetName:u,stream:I.PULL_COMPLETE,streamId:t,success:!0});break}d.desiredSize<=0&&s.desiredSize>0&&d.sinkCapability.resolve(),d.desiredSize=s.desiredSize,new Promise(function(p){p(d.onPull?.())}).then(function(){l.postMessage({sourceName:i,targetName:u,stream:I.PULL_COMPLETE,streamId:t,success:!0})},function(p){l.postMessage({sourceName:i,targetName:u,stream:I.PULL_COMPLETE,streamId:t,reason:x(p)})});break;case I.ENQUEUE:if((0,a.assert)(e,"enqueue should have stream controller"),e.isClosed)break;e.controller.enqueue(s.chunk);break;case I.CLOSE:if((0,a.assert)(e,"close should have stream controller"),e.isClosed)break;e.isClosed=!0,e.controller.close(),this.#i(e,t);break;case I.ERROR:(0,a.assert)(e,"error should have stream controller"),e.controller.error(x(s.reason)),this.#i(e,t);break;case I.CANCEL_COMPLETE:s.success?e.cancelCall.resolve():e.cancelCall.reject(x(s.reason)),this.#i(e,t);break;case I.CANCEL:if(!d)break;new Promise(function(p){p(d.onCancel?.(x(s.reason)))}).then(function(){l.postMessage({sourceName:i,targetName:u,stream:I.CANCEL_COMPLETE,streamId:t,success:!0})},function(p){l.postMessage({sourceName:i,targetName:u,stream:I.CANCEL_COMPLETE,streamId:t,reason:x(p)})}),d.sinkCapability.reject(x(s.reason)),d.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#i(s,t){await Promise.allSettled([s.startCall?.promise,s.pullCall?.promise,s.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}n.MessageHandler=B}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var a=T(1);class m{#t;#e;constructor({parsedData:x,rawData:B}){this.#t=x,this.#e=B}getRaw(){return this.#e}get(x){return this.#t.get(x)??null}getAll(){return(0,a.objectFromMap)(this.#t)}has(x){return this.#t.has(x)}}n.Metadata=m}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var a=T(1),m=T(8);const I=Symbol("INTERNAL");class x{#t=!0;constructor(s,t){this.name=s,this.intent=t}get visible(){return this.#t}_setVisible(s,t){s!==I&&(0,a.unreachable)("Internal method `_setVisible` called."),this.#t=t}}class B{#t=null;#e=new Map;#i=null;#s=null;constructor(s){if(this.name=null,this.creator=null,s!==null){this.name=s.name,this.creator=s.creator,this.#s=s.order;for(const t of s.groups)this.#e.set(t.id,new x(t.name,t.intent));if(s.baseState==="OFF")for(const t of this.#e.values())t._setVisible(I,!1);for(const t of s.on)this.#e.get(t)._setVisible(I,!0);for(const t of s.off)this.#e.get(t)._setVisible(I,!1);this.#i=this.getHash()}}#o(s){const t=s.length;if(t<2)return!0;const i=s[0];for(let u=1;u<t;u++){const l=s[u];let e;if(Array.isArray(l))e=this.#o(l);else if(this.#e.has(l))e=this.#e.get(l).visible;else return(0,a.warn)(`Optional content group not found: ${l}`),!0;switch(i){case"And":if(!e)return!1;break;case"Or":if(e)return!0;break;case"Not":return!e;default:return!0}}return i==="And"}isVisible(s){if(this.#e.size===0)return!0;if(!s)return(0,a.warn)("Optional content group not defined."),!0;if(s.type==="OCG")return this.#e.has(s.id)?this.#e.get(s.id).visible:((0,a.warn)(`Optional content group not found: ${s.id}`),!0);if(s.type==="OCMD"){if(s.expression)return this.#o(s.expression);if(!s.policy||s.policy==="AnyOn"){for(const t of s.ids){if(!this.#e.has(t))return(0,a.warn)(`Optional content group not found: ${t}`),!0;if(this.#e.get(t).visible)return!0}return!1}else if(s.policy==="AllOn"){for(const t of s.ids){if(!this.#e.has(t))return(0,a.warn)(`Optional content group not found: ${t}`),!0;if(!this.#e.get(t).visible)return!1}return!0}else if(s.policy==="AnyOff"){for(const t of s.ids){if(!this.#e.has(t))return(0,a.warn)(`Optional content group not found: ${t}`),!0;if(!this.#e.get(t).visible)return!0}return!1}else if(s.policy==="AllOff"){for(const t of s.ids){if(!this.#e.has(t))return(0,a.warn)(`Optional content group not found: ${t}`),!0;if(this.#e.get(t).visible)return!1}return!0}return(0,a.warn)(`Unknown optional content policy ${s.policy}.`),!0}return(0,a.warn)(`Unknown group type ${s.type}.`),!0}setVisibility(s,t=!0){if(!this.#e.has(s)){(0,a.warn)(`Optional content group not found: ${s}`);return}this.#e.get(s)._setVisible(I,!!t),this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#s?this.#s.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,a.objectFromMap)(this.#e):null}getGroup(s){return this.#e.get(s)||null}getHash(){if(this.#t!==null)return this.#t;const s=new m.MurmurHash3_64;for(const[t,i]of this.#e)s.update(`${t}:${i.visible}`);return this.#t=s.hexdigest()}}n.OptionalContentConfig=B}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var a=T(1),m=T(6);class I{constructor({length:s,initialData:t,progressiveDone:i=!1,contentDispositionFilename:u=null,disableRange:l=!1,disableStream:e=!1},d){if((0,a.assert)(d,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=i,this._contentDispositionFilename=u,t?.length>0){const p=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;this._queuedChunks.push(p)}this._pdfDataRangeTransport=d,this._isStreamingSupported=!e,this._isRangeSupported=!l,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((p,o)=>{this._onReceiveData({begin:p,chunk:o})}),this._pdfDataRangeTransport.addProgressListener((p,o)=>{this._onProgress({loaded:p,total:o})}),this._pdfDataRangeTransport.addProgressiveReadListener(p=>{this._onReceiveData({chunk:p})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:s,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(s===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const u=this._rangeReaders.some(function(l){return l._begin!==s?!1:(l._enqueue(i),!0)});(0,a.assert)(u,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(s){s.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:s.loaded}):this._fullRequestReader?.onProgress?.({loaded:s.loaded,total:s.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(s){const t=this._rangeReaders.indexOf(s);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){(0,a.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const s=this._queuedChunks;return this._queuedChunks=null,new x(this,s,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(s,t){if(t<=this._progressiveDataLength)return null;const i=new B(this,s,t);return this._pdfDataRangeTransport.requestDataRange(s,t),this._rangeReaders.push(i),i}cancelAllRequests(s){this._fullRequestReader?.cancel(s);for(const t of this._rangeReaders.slice(0))t.cancel(s);this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=I;class x{constructor(s,t,i=!1,u=null){this._stream=s,this._done=i||!1,this._filename=(0,m.isPdfFile)(u)?u:null,this._queuedChunks=t||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),s._fullRequestReader=this,this.onProgress=null}_enqueue(s){this._done||(this._requests.length>0?this._requests.shift().resolve({value:s,done:!1}):this._queuedChunks.push(s),this._loaded+=s.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const s=new a.PromiseCapability;return this._requests.push(s),s.promise}cancel(s){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class B{constructor(s,t,i){this._stream=s,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(s){if(!this._done){if(this._requests.length===0)this._queuedChunk=s;else{this._requests.shift().resolve({value:s,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const s=new a.PromiseCapability;return this._requests.push(s),s.promise}cancel(s){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var a=T(1),m=T(20);function I(i,u,l){return{method:"GET",headers:i,signal:l.signal,mode:"cors",credentials:u?"include":"same-origin",redirect:"follow"}}function x(i){const u=new Headers;for(const l in i){const e=i[l];e!==void 0&&u.append(l,e)}return u}function B(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:((0,a.warn)(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class U{constructor(u){this.source=u,this.isHttp=/^https?:/i.test(u.url),this.httpHeaders=this.isHttp&&u.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new s(this),this._fullRequestReader}getRangeReader(u,l){if(l<=this._progressiveDataLength)return null;const e=new t(this,u,l);return this._rangeRequestReaders.push(e),e}cancelAllRequests(u){this._fullRequestReader?.cancel(u);for(const l of this._rangeRequestReaders.slice(0))l.cancel(u)}}n.PDFFetchStream=U;class s{constructor(u){this._stream=u,this._reader=null,this._loaded=0,this._filename=null;const l=u.source;this._withCredentials=l.withCredentials||!1,this._contentLength=l.length,this._headersCapability=new a.PromiseCapability,this._disableRange=l.disableRange||!1,this._rangeChunkSize=l.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!l.disableStream,this._isRangeSupported=!l.disableRange,this._headers=x(this._stream.httpHeaders);const e=l.url;fetch(e,I(this._headers,this._withCredentials,this._abortController)).then(d=>{if(!(0,m.validateResponseStatus)(d.status))throw(0,m.createResponseStatusError)(d.status,e);this._reader=d.body.getReader(),this._headersCapability.resolve();const p=M=>d.headers.get(M),{allowRangeRequests:o,suggestedLength:y}=(0,m.validateRangeRequestCapabilities)({getResponseHeader:p,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=y||this._contentLength,this._filename=(0,m.extractFilenameFromHeader)(p),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new a.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:u,done:l}=await this._reader.read();return l?{value:u,done:l}:(this._loaded+=u.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:B(u),done:!1})}cancel(u){this._reader?.cancel(u),this._abortController.abort()}}class t{constructor(u,l,e){this._stream=u,this._reader=null,this._loaded=0;const d=u.source;this._withCredentials=d.withCredentials||!1,this._readCapability=new a.PromiseCapability,this._isStreamingSupported=!d.disableStream,this._abortController=new AbortController,this._headers=x(this._stream.httpHeaders),this._headers.append("Range",`bytes=${l}-${e-1}`);const p=d.url;fetch(p,I(this._headers,this._withCredentials,this._abortController)).then(o=>{if(!(0,m.validateResponseStatus)(o.status))throw(0,m.createResponseStatusError)(o.status,p);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:u,done:l}=await this._reader.read();return l?{value:u,done:l}:(this._loaded+=u.byteLength,this.onProgress?.({loaded:this._loaded}),{value:B(u),done:!1})}cancel(u){this._reader?.cancel(u),this._abortController.abort()}}}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=U,n.extractFilenameFromHeader=B,n.validateRangeRequestCapabilities=x,n.validateResponseStatus=s;var a=T(1),m=T(21),I=T(6);function x({getResponseHeader:t,isHttp:i,rangeChunkSize:u,disableRange:l}){const e={allowRangeRequests:!1,suggestedLength:void 0},d=parseInt(t("Content-Length"),10);return!Number.isInteger(d)||(e.suggestedLength=d,d<=2*u)||l||!i||t("Accept-Ranges")!=="bytes"||(t("Content-Encoding")||"identity")!=="identity"||(e.allowRangeRequests=!0),e}function B(t){const i=t("Content-Disposition");if(i){let u=(0,m.getFilenameFromContentDispositionHeader)(i);if(u.includes("%"))try{u=decodeURIComponent(u)}catch{}if((0,I.isPdfFile)(u))return u}return null}function U(t,i){return t===404||t===0&&i.startsWith("file:")?new a.MissingPDFException('Missing PDF "'+i+'".'):new a.UnexpectedResponseException(`Unexpected server response (${t}) while retrieving PDF "${i}".`,t)}function s(t){return t===200||t===206}}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=m;var a=T(1);function m(I){let x=!0,B=U("filename\\*","i").exec(I);if(B){B=B[1];let d=u(B);return d=unescape(d),d=l(d),d=e(d),t(d)}if(B=i(I),B){const d=e(B);return t(d)}if(B=U("filename","i").exec(I),B){B=B[1];let d=u(B);return d=e(d),t(d)}function U(d,p){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function s(d,p){if(d){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const o=new TextDecoder(d,{fatal:!0}),y=(0,a.stringToBytes)(p);p=o.decode(y),x=!1}catch{}}return p}function t(d){return x&&/[\x80-\xff]/.test(d)&&(d=s("utf-8",d),x&&(d=s("iso-8859-1",d))),d}function i(d){const p=[];let o;const y=U("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(o=y.exec(d))!==null;){let[,w,f,v]=o;if(w=parseInt(w,10),w in p){if(w===0)break;continue}p[w]=[f,v]}const M=[];for(let w=0;w<p.length&&w in p;++w){let[f,v]=p[w];v=u(v),f&&(v=unescape(v),w===0&&(v=l(v))),M.push(v)}return M.join("")}function u(d){if(d.startsWith('"')){const p=d.slice(1).split('\\"');for(let o=0;o<p.length;++o){const y=p[o].indexOf('"');y!==-1&&(p[o]=p[o].slice(0,y),p.length=o+1),p[o]=p[o].replaceAll(/\\(.)/g,"$1")}d=p.join('"')}return d}function l(d){const p=d.indexOf("'");if(p===-1)return d;const o=d.slice(0,p),M=d.slice(p+1).replace(/^[^']*'/,"");return s(o,M)}function e(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,o,y,M){if(y==="q"||y==="Q")return M=M.replaceAll("_"," "),M=M.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,f){return String.fromCharCode(parseInt(f,16))}),s(o,M);try{M=atob(M)}catch{}return s(o,M)})}return""}}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var a=T(1),m=T(20);const I=200,x=206;function B(u){const l=u.response;return typeof l!="string"?l:(0,a.stringToBytes)(l).buffer}class U{constructor(l,e={}){this.url=l,this.isHttp=/^https?:/i.test(l),this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null),this.withCredentials=e.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(l,e,d){const p={begin:l,end:e};for(const o in d)p[o]=d[o];return this.request(p)}requestFull(l){return this.request(l)}request(l){const e=new XMLHttpRequest,d=this.currXhrId++,p=this.pendingRequests[d]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const o in this.httpHeaders){const y=this.httpHeaders[o];y!==void 0&&e.setRequestHeader(o,y)}return this.isHttp&&"begin"in l&&"end"in l?(e.setRequestHeader("Range",`bytes=${l.begin}-${l.end-1}`),p.expectedStatus=x):p.expectedStatus=I,e.responseType="arraybuffer",l.onError&&(e.onerror=function(o){l.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,d),e.onprogress=this.onProgress.bind(this,d),p.onHeadersReceived=l.onHeadersReceived,p.onDone=l.onDone,p.onError=l.onError,p.onProgress=l.onProgress,e.send(null),d}onProgress(l,e){const d=this.pendingRequests[l];d&&d.onProgress?.(e)}onStateChange(l,e){const d=this.pendingRequests[l];if(!d)return;const p=d.xhr;if(p.readyState>=2&&d.onHeadersReceived&&(d.onHeadersReceived(),delete d.onHeadersReceived),p.readyState!==4||!(l in this.pendingRequests))return;if(delete this.pendingRequests[l],p.status===0&&this.isHttp){d.onError?.(p.status);return}const o=p.status||I;if(!(o===I&&d.expectedStatus===x)&&o!==d.expectedStatus){d.onError?.(p.status);return}const M=B(p);if(o===x){const w=p.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(w);d.onDone({begin:parseInt(f[1],10),chunk:M})}else M?d.onDone({begin:0,chunk:M}):d.onError?.(p.status)}getRequestXhr(l){return this.pendingRequests[l].xhr}isPendingRequest(l){return l in this.pendingRequests}abortRequest(l){const e=this.pendingRequests[l].xhr;delete this.pendingRequests[l],e.abort()}}class s{constructor(l){this._source=l,this._manager=new U(l.url,{httpHeaders:l.httpHeaders,withCredentials:l.withCredentials}),this._rangeChunkSize=l.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(l){const e=this._rangeRequestReaders.indexOf(l);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new t(this._manager,this._source),this._fullRequestReader}getRangeReader(l,e){const d=new i(this._manager,l,e);return d.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(d),d}cancelAllRequests(l){this._fullRequestReader?.cancel(l);for(const e of this._rangeRequestReaders.slice(0))e.cancel(l)}}n.PDFNetworkStream=s;class t{constructor(l,e){this._manager=l;const d={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=l.requestFull(d),this._headersReceivedCapability=new a.PromiseCapability,this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const l=this._fullRequestId,e=this._manager.getRequestXhr(l),d=y=>e.getResponseHeader(y),{allowRangeRequests:p,suggestedLength:o}=(0,m.validateRangeRequestCapabilities)({getResponseHeader:d,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});p&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=(0,m.extractFilenameFromHeader)(d),this._isRangeSupported&&this._manager.abortRequest(l),this._headersReceivedCapability.resolve()}_onDone(l){if(l&&(this._requests.length>0?this._requests.shift().resolve({value:l.chunk,done:!1}):this._cachedChunks.push(l.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(l){this._storedError=(0,m.createResponseStatusError)(l,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(l){this.onProgress?.({loaded:l.loaded,total:l.lengthComputable?l.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const l=new a.PromiseCapability;return this._requests.push(l),l.promise}cancel(l){this._done=!0,this._headersReceivedCapability.reject(l);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class i{constructor(l,e,d){this._manager=l;const p={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=l.url,this._requestId=l.requestRange(e,d,p),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(l){const e=l.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(l){this._storedError=(0,m.createResponseStatusError)(l,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(l){this.isStreamingSupported||this.onProgress?.({loaded:l.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const l=new a.PromiseCapability;return this._requests.push(l),l.promise}cancel(l){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var a=T(1),m=T(20);const I=/^file:\/\/\/[a-zA-Z]:\//;function x(d){const p=require$$5,o=p.parse(d);return o.protocol==="file:"||o.host?o:/^[a-z]:[/\\]/i.test(d)?p.parse(`file:///${d}`):(o.host||(o.protocol="file:"),o)}class B{constructor(p){this.source=p,this.url=x(p.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&p.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new l(this):new i(this),this._fullRequestReader}getRangeReader(p,o){if(o<=this._progressiveDataLength)return null;const y=this.isFsUrl?new e(this,p,o):new u(this,p,o);return this._rangeRequestReaders.push(y),y}cancelAllRequests(p){this._fullRequestReader?.cancel(p);for(const o of this._rangeRequestReaders.slice(0))o.cancel(p)}}n.PDFNodeStream=B;class U{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null;const o=p.source;this._contentLength=o.length,this._loaded=0,this._filename=null,this._disableRange=o.disableRange||!1,this._rangeChunkSize=o.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!o.disableStream,this._isRangeSupported=!o.disableRange,this._readableStream=null,this._readCapability=new a.PromiseCapability,this._headersCapability=new a.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const p=this._readableStream.read();return p===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=p.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(p).buffer,done:!1})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",o=>{this._error(o)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new a.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class s{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new a.PromiseCapability;const o=p.source;this._isStreamingSupported=!o.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const p=this._readableStream.read();return p===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=p.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(p).buffer,done:!1})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",o=>{this._error(o)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function t(d,p){return{protocol:d.protocol,auth:d.auth,host:d.hostname,port:d.port,path:d.path,method:"GET",headers:p}}class i extends U{constructor(p){super(p);const o=y=>{if(y.statusCode===404){const v=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=v,this._headersCapability.reject(v);return}this._headersCapability.resolve(),this._setReadableStream(y);const M=v=>this._readableStream.headers[v.toLowerCase()],{allowRangeRequests:w,suggestedLength:f}=(0,m.validateRangeRequestCapabilities)({getResponseHeader:M,isHttp:p.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=w,this._contentLength=f||this._contentLength,this._filename=(0,m.extractFilenameFromHeader)(M)};if(this._request=null,this._url.protocol==="http:"){const y=require$$5;this._request=y.request(t(this._url,p.httpHeaders),o)}else{const y=require$$5;this._request=y.request(t(this._url,p.httpHeaders),o)}this._request.on("error",y=>{this._storedError=y,this._headersCapability.reject(y)}),this._request.end()}}class u extends s{constructor(p,o,y){super(p),this._httpHeaders={};for(const w in p.httpHeaders){const f=p.httpHeaders[w];f!==void 0&&(this._httpHeaders[w]=f)}this._httpHeaders.Range=`bytes=${o}-${y-1}`;const M=w=>{if(w.statusCode===404){const f=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=f;return}this._setReadableStream(w)};if(this._request=null,this._url.protocol==="http:"){const w=require$$5;this._request=w.request(t(this._url,this._httpHeaders),M)}else{const w=require$$5;this._request=w.request(t(this._url,this._httpHeaders),M)}this._request.on("error",w=>{this._storedError=w}),this._request.end()}}class l extends U{constructor(p){super(p);let o=decodeURIComponent(this._url.path);I.test(this._url.href)&&(o=o.replace(/^\//,""));const y=require$$5;y.lstat(o,(M,w)=>{if(M){M.code==="ENOENT"&&(M=new a.MissingPDFException(`Missing PDF "${o}".`)),this._storedError=M,this._headersCapability.reject(M);return}this._contentLength=w.size,this._setReadableStream(y.createReadStream(o)),this._headersCapability.resolve()})}}class e extends s{constructor(p,o,y){super(p);let M=decodeURIComponent(this._url.path);I.test(this._url.href)&&(M=M.replace(/^\//,""));const w=require$$5;this._setReadableStream(w.createReadStream(M,{start:o,end:y-1}))}}}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var a=T(6),m=T(1);const I={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},x="http://www.w3.org/XML/1998/namespace",B="http://www.w3.org/1999/xlink",U=["butt","round","square"],s=["miter","round","bevel"],t=function(w,f="",v=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!v)return URL.createObjectURL(new Blob([w],{type:f}));const O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let H=`data:${f};base64,`;for(let D=0,G=w.length;D<G;D+=3){const X=w[D]&255,it=w[D+1]&255,Q=w[D+2]&255,et=X>>2,nt=(X&3)<<4|it>>4,$=D+1<G?(it&15)<<2|Q>>6:64,F=D+2<G?Q&63:64;H+=O[et]+O[nt]+O[$]+O[F]}return H},i=(function(){const w=new Uint8Array([137,80,78,71,13,10,26,10]),f=12,v=new Int32Array(256);for(let Q=0;Q<256;Q++){let et=Q;for(let nt=0;nt<8;nt++)et=et&1?3988292384^et>>1&2147483647:et>>1&2147483647;v[Q]=et}function O(Q,et,nt){let $=-1;for(let F=et;F<nt;F++){const b=($^Q[F])&255,c=v[b];$=$>>>8^c}return $^-1}function H(Q,et,nt,$){let F=$;const b=et.length;nt[F]=b>>24&255,nt[F+1]=b>>16&255,nt[F+2]=b>>8&255,nt[F+3]=b&255,F+=4,nt[F]=Q.charCodeAt(0)&255,nt[F+1]=Q.charCodeAt(1)&255,nt[F+2]=Q.charCodeAt(2)&255,nt[F+3]=Q.charCodeAt(3)&255,F+=4,nt.set(et,F),F+=et.length;const c=O(nt,$+4,F);nt[F]=c>>24&255,nt[F+1]=c>>16&255,nt[F+2]=c>>8&255,nt[F+3]=c&255}function D(Q,et,nt){let $=1,F=0;for(let b=et;b<nt;++b)$=($+(Q[b]&255))%65521,F=(F+$)%65521;return F<<16|$}function G(Q){if(!m.isNodeJS)return X(Q);try{const et=parseInt(process.versions.node)>=8?Q:Buffer.from(Q),nt=require$$5.deflateSync(et,{level:9});return nt instanceof Uint8Array?nt:new Uint8Array(nt)}catch(et){(0,m.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+et)}return X(Q)}function X(Q){let et=Q.length;const nt=65535,$=Math.ceil(et/nt),F=new Uint8Array(2+et+$*5+4);let b=0;F[b++]=120,F[b++]=156;let c=0;for(;et>nt;)F[b++]=0,F[b++]=255,F[b++]=255,F[b++]=0,F[b++]=0,F.set(Q.subarray(c,c+nt),b),b+=nt,c+=nt,et-=nt;F[b++]=1,F[b++]=et&255,F[b++]=et>>8&255,F[b++]=~et&65535&255,F[b++]=(~et&65535)>>8&255,F.set(Q.subarray(c),b),b+=Q.length-c;const h=D(Q,0,Q.length);return F[b++]=h>>24&255,F[b++]=h>>16&255,F[b++]=h>>8&255,F[b++]=h&255,F}function it(Q,et,nt,$){const F=Q.width,b=Q.height;let c,h,_;const P=Q.data;switch(et){case m.ImageKind.GRAYSCALE_1BPP:h=0,c=1,_=F+7>>3;break;case m.ImageKind.RGB_24BPP:h=2,c=8,_=F*3;break;case m.ImageKind.RGBA_32BPP:h=6,c=8,_=F*4;break;default:throw new Error("invalid format")}const k=new Uint8Array((1+_)*b);let R=0,S=0;for(let L=0;L<b;++L)k[R++]=0,k.set(P.subarray(S,S+_),R),S+=_,R+=_;if(et===m.ImageKind.GRAYSCALE_1BPP&&$){R=0;for(let L=0;L<b;L++){R++;for(let j=0;j<_;j++)k[R++]^=255}}const r=new Uint8Array([F>>24&255,F>>16&255,F>>8&255,F&255,b>>24&255,b>>16&255,b>>8&255,b&255,c,h,0,0,0]),g=G(k),A=w.length+f*3+r.length+g.length,E=new Uint8Array(A);let C=0;return E.set(w,C),C+=w.length,H("IHDR",r,E,C),C+=f+r.length,H("IDATA",g,E,C),C+=f+g.length,H("IEND",new Uint8Array(0),E,C),t(E,"image/png",nt)}return function(et,nt,$){const F=et.kind===void 0?m.ImageKind.GRAYSCALE_1BPP:et.kind;return it(et,F,nt,$)}})();class u{constructor(){this.fontSizeScale=1,this.fontWeight=I.fontWeight,this.fontSize=0,this.textMatrix=m.IDENTITY_MATRIX,this.fontMatrix=m.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=m.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=I.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(f,v){this.x=f,this.y=v}}function l(w){let f=[];const v=[];for(const O of w){if(O.fn==="save"){f.push({fnId:92,fn:"group",items:[]}),v.push(f),f=f.at(-1).items;continue}O.fn==="restore"?f=v.pop():f.push(O)}return f}function e(w){if(Number.isInteger(w))return w.toString();const f=w.toFixed(10);let v=f.length-1;if(f[v]!=="0")return f;do v--;while(f[v]==="0");return f.substring(0,f[v]==="."?v:v+1)}function d(w){if(w[4]===0&&w[5]===0){if(w[1]===0&&w[2]===0)return w[0]===1&&w[3]===1?"":`scale(${e(w[0])} ${e(w[3])})`;if(w[0]===w[3]&&w[1]===-w[2]){const f=Math.acos(w[0])*180/Math.PI;return`rotate(${e(f)})`}}else if(w[0]===1&&w[1]===0&&w[2]===0&&w[3]===1)return`translate(${e(w[4])} ${e(w[5])})`;return`matrix(${e(w[0])} ${e(w[1])} ${e(w[2])} ${e(w[3])} ${e(w[4])} ${e(w[5])})`}let p=0,o=0,y=0;class M{constructor(f,v,O=!1){(0,a.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new a.DOMSVGFactory,this.current=new u,this.transformMatrix=m.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=f,this.objs=v,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!O,this._operatorIdMapping=[];for(const H in m.OPS)this._operatorIdMapping[m.OPS[H]]=H}getObject(f,v=null){return typeof f=="string"?f.startsWith("g_")?this.commonObjs.get(f):this.objs.get(f):v}save(){this.transformStack.push(this.transformMatrix);const f=this.current;this.extraStack.push(f),this.current=f.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(f){this.save(),this.executeOpTree(f),this.restore()}loadDependencies(f){const v=f.fnArray,O=f.argsArray;for(let H=0,D=v.length;H<D;H++)if(v[H]===m.OPS.dependency)for(const G of O[H]){const X=G.startsWith("g_")?this.commonObjs:this.objs,it=new Promise(Q=>{X.get(G,Q)});this.current.dependencies.push(it)}return Promise.all(this.current.dependencies)}transform(f,v,O,H,D,G){const X=[f,v,O,H,D,G];this.transformMatrix=m.Util.transform(this.transformMatrix,X),this.tgrp=null}getSVG(f,v){this.viewport=v;const O=this._initialize(v);return this.loadDependencies(f).then(()=>(this.transformMatrix=m.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(f)),O))}convertOpList(f){const v=this._operatorIdMapping,O=f.argsArray,H=f.fnArray,D=[];for(let G=0,X=H.length;G<X;G++){const it=H[G];D.push({fnId:it,fn:v[it],args:O[G]})}return l(D)}executeOpTree(f){for(const v of f){const O=v.fn,H=v.fnId,D=v.args;switch(H|0){case m.OPS.beginText:this.beginText();break;case m.OPS.dependency:break;case m.OPS.setLeading:this.setLeading(D);break;case m.OPS.setLeadingMoveText:this.setLeadingMoveText(D[0],D[1]);break;case m.OPS.setFont:this.setFont(D);break;case m.OPS.showText:this.showText(D[0]);break;case m.OPS.showSpacedText:this.showText(D[0]);break;case m.OPS.endText:this.endText();break;case m.OPS.moveText:this.moveText(D[0],D[1]);break;case m.OPS.setCharSpacing:this.setCharSpacing(D[0]);break;case m.OPS.setWordSpacing:this.setWordSpacing(D[0]);break;case m.OPS.setHScale:this.setHScale(D[0]);break;case m.OPS.setTextMatrix:this.setTextMatrix(D[0],D[1],D[2],D[3],D[4],D[5]);break;case m.OPS.setTextRise:this.setTextRise(D[0]);break;case m.OPS.setTextRenderingMode:this.setTextRenderingMode(D[0]);break;case m.OPS.setLineWidth:this.setLineWidth(D[0]);break;case m.OPS.setLineJoin:this.setLineJoin(D[0]);break;case m.OPS.setLineCap:this.setLineCap(D[0]);break;case m.OPS.setMiterLimit:this.setMiterLimit(D[0]);break;case m.OPS.setFillRGBColor:this.setFillRGBColor(D[0],D[1],D[2]);break;case m.OPS.setStrokeRGBColor:this.setStrokeRGBColor(D[0],D[1],D[2]);break;case m.OPS.setStrokeColorN:this.setStrokeColorN(D);break;case m.OPS.setFillColorN:this.setFillColorN(D);break;case m.OPS.shadingFill:this.shadingFill(D[0]);break;case m.OPS.setDash:this.setDash(D[0],D[1]);break;case m.OPS.setRenderingIntent:this.setRenderingIntent(D[0]);break;case m.OPS.setFlatness:this.setFlatness(D[0]);break;case m.OPS.setGState:this.setGState(D[0]);break;case m.OPS.fill:this.fill();break;case m.OPS.eoFill:this.eoFill();break;case m.OPS.stroke:this.stroke();break;case m.OPS.fillStroke:this.fillStroke();break;case m.OPS.eoFillStroke:this.eoFillStroke();break;case m.OPS.clip:this.clip("nonzero");break;case m.OPS.eoClip:this.clip("evenodd");break;case m.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case m.OPS.paintImageXObject:this.paintImageXObject(D[0]);break;case m.OPS.paintInlineImageXObject:this.paintInlineImageXObject(D[0]);break;case m.OPS.paintImageMaskXObject:this.paintImageMaskXObject(D[0]);break;case m.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(D[0],D[1]);break;case m.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case m.OPS.closePath:this.closePath();break;case m.OPS.closeStroke:this.closeStroke();break;case m.OPS.closeFillStroke:this.closeFillStroke();break;case m.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case m.OPS.nextLine:this.nextLine();break;case m.OPS.transform:this.transform(D[0],D[1],D[2],D[3],D[4],D[5]);break;case m.OPS.constructPath:this.constructPath(D[0],D[1]);break;case m.OPS.endPath:this.endPath();break;case 92:this.group(v.items);break;default:(0,m.warn)(`Unimplemented operator ${O}`);break}}}setWordSpacing(f){this.current.wordSpacing=f}setCharSpacing(f){this.current.charSpacing=f}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(f,v,O,H,D,G){const X=this.current;X.textMatrix=X.lineMatrix=[f,v,O,H,D,G],X.textMatrixScale=Math.hypot(f,v),X.x=X.lineX=0,X.y=X.lineY=0,X.xcoords=[],X.ycoords=[],X.tspan=this.svgFactory.createElement("svg:tspan"),X.tspan.setAttributeNS(null,"font-family",X.fontFamily),X.tspan.setAttributeNS(null,"font-size",`${e(X.fontSize)}px`),X.tspan.setAttributeNS(null,"y",e(-X.y)),X.txtElement=this.svgFactory.createElement("svg:text"),X.txtElement.append(X.tspan)}beginText(){const f=this.current;f.x=f.lineX=0,f.y=f.lineY=0,f.textMatrix=m.IDENTITY_MATRIX,f.lineMatrix=m.IDENTITY_MATRIX,f.textMatrixScale=1,f.tspan=this.svgFactory.createElement("svg:tspan"),f.txtElement=this.svgFactory.createElement("svg:text"),f.txtgrp=this.svgFactory.createElement("svg:g"),f.xcoords=[],f.ycoords=[]}moveText(f,v){const O=this.current;O.x=O.lineX+=f,O.y=O.lineY+=v,O.xcoords=[],O.ycoords=[],O.tspan=this.svgFactory.createElement("svg:tspan"),O.tspan.setAttributeNS(null,"font-family",O.fontFamily),O.tspan.setAttributeNS(null,"font-size",`${e(O.fontSize)}px`),O.tspan.setAttributeNS(null,"y",e(-O.y))}showText(f){const v=this.current,O=v.font,H=v.fontSize;if(H===0)return;const D=v.fontSizeScale,G=v.charSpacing,X=v.wordSpacing,it=v.fontDirection,Q=v.textHScale*it,et=O.vertical,nt=et?1:-1,$=O.defaultVMetrics,F=H*v.fontMatrix[0];let b=0;for(const _ of f){if(_===null){b+=it*X;continue}else if(typeof _=="number"){b+=nt*_*H/1e3;continue}const P=(_.isSpace?X:0)+G,k=_.fontChar;let R,S,r=_.width;if(et){let A;const E=_.vmetric||$;A=_.vmetric?E[1]:r*.5,A=-A*F;const C=E[2]*F;r=E?-E[0]:r,R=A/D,S=(b+C)/D}else R=b/D,S=0;(_.isInFont||O.missingFile)&&(v.xcoords.push(v.x+R),et&&v.ycoords.push(-v.y+S),v.tspan.textContent+=k);const g=et?r*F-P*it:r*F+P*it;b+=g}v.tspan.setAttributeNS(null,"x",v.xcoords.map(e).join(" ")),et?v.tspan.setAttributeNS(null,"y",v.ycoords.map(e).join(" ")):v.tspan.setAttributeNS(null,"y",e(-v.y)),et?v.y-=b:v.x+=b*Q,v.tspan.setAttributeNS(null,"font-family",v.fontFamily),v.tspan.setAttributeNS(null,"font-size",`${e(v.fontSize)}px`),v.fontStyle!==I.fontStyle&&v.tspan.setAttributeNS(null,"font-style",v.fontStyle),v.fontWeight!==I.fontWeight&&v.tspan.setAttributeNS(null,"font-weight",v.fontWeight);const c=v.textRenderingMode&m.TextRenderingMode.FILL_STROKE_MASK;if(c===m.TextRenderingMode.FILL||c===m.TextRenderingMode.FILL_STROKE?(v.fillColor!==I.fillColor&&v.tspan.setAttributeNS(null,"fill",v.fillColor),v.fillAlpha<1&&v.tspan.setAttributeNS(null,"fill-opacity",v.fillAlpha)):v.textRenderingMode===m.TextRenderingMode.ADD_TO_PATH?v.tspan.setAttributeNS(null,"fill","transparent"):v.tspan.setAttributeNS(null,"fill","none"),c===m.TextRenderingMode.STROKE||c===m.TextRenderingMode.FILL_STROKE){const _=1/(v.textMatrixScale||1);this._setStrokeAttributes(v.tspan,_)}let h=v.textMatrix;v.textRise!==0&&(h=h.slice(),h[5]+=v.textRise),v.txtElement.setAttributeNS(null,"transform",`${d(h)} scale(${e(Q)}, -1)`),v.txtElement.setAttributeNS(x,"xml:space","preserve"),v.txtElement.append(v.tspan),v.txtgrp.append(v.txtElement),this._ensureTransformGroup().append(v.txtElement)}setLeadingMoveText(f,v){this.setLeading(-v),this.moveText(f,v)}addFontStyle(f){if(!f.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const v=t(f.data,f.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${f.loadedName}"; src: url(${v}); }
`}setFont(f){const v=this.current,O=this.commonObjs.get(f[0]);let H=f[1];v.font=O,this.embedFonts&&!O.missingFile&&!this.embeddedFonts[O.loadedName]&&(this.addFontStyle(O),this.embeddedFonts[O.loadedName]=O),v.fontMatrix=O.fontMatrix||m.FONT_IDENTITY_MATRIX;let D="normal";O.black?D="900":O.bold&&(D="bold");const G=O.italic?"italic":"normal";H<0?(H=-H,v.fontDirection=-1):v.fontDirection=1,v.fontSize=H,v.fontFamily=O.loadedName,v.fontWeight=D,v.fontStyle=G,v.tspan=this.svgFactory.createElement("svg:tspan"),v.tspan.setAttributeNS(null,"y",e(-v.y)),v.xcoords=[],v.ycoords=[]}endText(){const f=this.current;f.textRenderingMode&m.TextRenderingMode.ADD_TO_PATH_FLAG&&f.txtElement?.hasChildNodes()&&(f.element=f.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(f){f>0&&(this.current.lineWidth=f)}setLineCap(f){this.current.lineCap=U[f]}setLineJoin(f){this.current.lineJoin=s[f]}setMiterLimit(f){this.current.miterLimit=f}setStrokeAlpha(f){this.current.strokeAlpha=f}setStrokeRGBColor(f,v,O){this.current.strokeColor=m.Util.makeHexColor(f,v,O)}setFillAlpha(f){this.current.fillAlpha=f}setFillRGBColor(f,v,O){this.current.fillColor=m.Util.makeHexColor(f,v,O),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(f){this.current.strokeColor=this._makeColorN_Pattern(f)}setFillColorN(f){this.current.fillColor=this._makeColorN_Pattern(f)}shadingFill(f){const{width:v,height:O}=this.viewport,H=m.Util.inverseTransform(this.transformMatrix),[D,G,X,it]=m.Util.getAxialAlignedBoundingBox([0,0,v,O],H),Q=this.svgFactory.createElement("svg:rect");Q.setAttributeNS(null,"x",D),Q.setAttributeNS(null,"y",G),Q.setAttributeNS(null,"width",X-D),Q.setAttributeNS(null,"height",it-G),Q.setAttributeNS(null,"fill",this._makeShadingPattern(f)),this.current.fillAlpha<1&&Q.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Q)}_makeColorN_Pattern(f){return f[0]==="TilingPattern"?this._makeTilingPattern(f):this._makeShadingPattern(f)}_makeTilingPattern(f){const v=f[1],O=f[2],H=f[3]||m.IDENTITY_MATRIX,[D,G,X,it]=f[4],Q=f[5],et=f[6],nt=f[7],$=`shading${y++}`,[F,b,c,h]=m.Util.normalizeRect([...m.Util.applyTransform([D,G],H),...m.Util.applyTransform([X,it],H)]),[_,P]=m.Util.singularValueDecompose2dScale(H),k=Q*_,R=et*P,S=this.svgFactory.createElement("svg:pattern");S.setAttributeNS(null,"id",$),S.setAttributeNS(null,"patternUnits","userSpaceOnUse"),S.setAttributeNS(null,"width",k),S.setAttributeNS(null,"height",R),S.setAttributeNS(null,"x",`${F}`),S.setAttributeNS(null,"y",`${b}`);const r=this.svg,g=this.transformMatrix,A=this.current.fillColor,E=this.current.strokeColor,C=this.svgFactory.create(c-F,h-b);if(this.svg=C,this.transformMatrix=H,nt===2){const L=m.Util.makeHexColor(...v);this.current.fillColor=L,this.current.strokeColor=L}return this.executeOpTree(this.convertOpList(O)),this.svg=r,this.transformMatrix=g,this.current.fillColor=A,this.current.strokeColor=E,S.append(C.childNodes[0]),this.defs.append(S),`url(#${$})`}_makeShadingPattern(f){switch(typeof f=="string"&&(f=this.objs.get(f)),f[0]){case"RadialAxial":const v=`shading${y++}`,O=f[3];let H;switch(f[1]){case"axial":const D=f[4],G=f[5];H=this.svgFactory.createElement("svg:linearGradient"),H.setAttributeNS(null,"id",v),H.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),H.setAttributeNS(null,"x1",D[0]),H.setAttributeNS(null,"y1",D[1]),H.setAttributeNS(null,"x2",G[0]),H.setAttributeNS(null,"y2",G[1]);break;case"radial":const X=f[4],it=f[5],Q=f[6],et=f[7];H=this.svgFactory.createElement("svg:radialGradient"),H.setAttributeNS(null,"id",v),H.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),H.setAttributeNS(null,"cx",it[0]),H.setAttributeNS(null,"cy",it[1]),H.setAttributeNS(null,"r",et),H.setAttributeNS(null,"fx",X[0]),H.setAttributeNS(null,"fy",X[1]),H.setAttributeNS(null,"fr",Q);break;default:throw new Error(`Unknown RadialAxial type: ${f[1]}`)}for(const D of O){const G=this.svgFactory.createElement("svg:stop");G.setAttributeNS(null,"offset",D[0]),G.setAttributeNS(null,"stop-color",D[1]),H.append(G)}return this.defs.append(H),`url(#${v})`;case"Mesh":return(0,m.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${f[0]}`)}}setDash(f,v){this.current.dashArray=f,this.current.dashPhase=v}constructPath(f,v){const O=this.current;let H=O.x,D=O.y,G=[],X=0;for(const it of f)switch(it|0){case m.OPS.rectangle:H=v[X++],D=v[X++];const Q=v[X++],et=v[X++],nt=H+Q,$=D+et;G.push("M",e(H),e(D),"L",e(nt),e(D),"L",e(nt),e($),"L",e(H),e($),"Z");break;case m.OPS.moveTo:H=v[X++],D=v[X++],G.push("M",e(H),e(D));break;case m.OPS.lineTo:H=v[X++],D=v[X++],G.push("L",e(H),e(D));break;case m.OPS.curveTo:H=v[X+4],D=v[X+5],G.push("C",e(v[X]),e(v[X+1]),e(v[X+2]),e(v[X+3]),e(H),e(D)),X+=6;break;case m.OPS.curveTo2:G.push("C",e(H),e(D),e(v[X]),e(v[X+1]),e(v[X+2]),e(v[X+3])),H=v[X+2],D=v[X+3],X+=4;break;case m.OPS.curveTo3:H=v[X+2],D=v[X+3],G.push("C",e(v[X]),e(v[X+1]),e(H),e(D),e(H),e(D)),X+=4;break;case m.OPS.closePath:G.push("Z");break}G=G.join(" "),O.path&&f.length>0&&f[0]!==m.OPS.rectangle&&f[0]!==m.OPS.moveTo?G=O.path.getAttributeNS(null,"d")+G:(O.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(O.path)),O.path.setAttributeNS(null,"d",G),O.path.setAttributeNS(null,"fill","none"),O.element=O.path,O.setCurrentPoint(H,D)}endPath(){const f=this.current;if(f.path=null,!this.pendingClip)return;if(!f.element){this.pendingClip=null;return}const v=`clippath${p++}`,O=this.svgFactory.createElement("svg:clipPath");O.setAttributeNS(null,"id",v),O.setAttributeNS(null,"transform",d(this.transformMatrix));const H=f.element.cloneNode(!0);if(this.pendingClip==="evenodd"?H.setAttributeNS(null,"clip-rule","evenodd"):H.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,O.append(H),this.defs.append(O),f.activeClipUrl){f.clipGroup=null;for(const D of this.extraStack)D.clipGroup=null;O.setAttributeNS(null,"clip-path",f.activeClipUrl)}f.activeClipUrl=`url(#${v})`,this.tgrp=null}clip(f){this.pendingClip=f}closePath(){const f=this.current;if(f.path){const v=`${f.path.getAttributeNS(null,"d")}Z`;f.path.setAttributeNS(null,"d",v)}}setLeading(f){this.current.leading=-f}setTextRise(f){this.current.textRise=f}setTextRenderingMode(f){this.current.textRenderingMode=f}setHScale(f){this.current.textHScale=f/100}setRenderingIntent(f){}setFlatness(f){}setGState(f){for(const[v,O]of f)switch(v){case"LW":this.setLineWidth(O);break;case"LC":this.setLineCap(O);break;case"LJ":this.setLineJoin(O);break;case"ML":this.setMiterLimit(O);break;case"D":this.setDash(O[0],O[1]);break;case"RI":this.setRenderingIntent(O);break;case"FL":this.setFlatness(O);break;case"Font":this.setFont(O);break;case"CA":this.setStrokeAlpha(O);break;case"ca":this.setFillAlpha(O);break;default:(0,m.warn)(`Unimplemented graphic state operator ${v}`);break}}fill(){const f=this.current;f.element&&(f.element.setAttributeNS(null,"fill",f.fillColor),f.element.setAttributeNS(null,"fill-opacity",f.fillAlpha),this.endPath())}stroke(){const f=this.current;f.element&&(this._setStrokeAttributes(f.element),f.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(f,v=1){const O=this.current;let H=O.dashArray;v!==1&&H.length>0&&(H=H.map(function(D){return v*D})),f.setAttributeNS(null,"stroke",O.strokeColor),f.setAttributeNS(null,"stroke-opacity",O.strokeAlpha),f.setAttributeNS(null,"stroke-miterlimit",e(O.miterLimit)),f.setAttributeNS(null,"stroke-linecap",O.lineCap),f.setAttributeNS(null,"stroke-linejoin",O.lineJoin),f.setAttributeNS(null,"stroke-width",e(v*O.lineWidth)+"px"),f.setAttributeNS(null,"stroke-dasharray",H.map(e).join(" ")),f.setAttributeNS(null,"stroke-dashoffset",e(v*O.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const f=this.svgFactory.createElement("svg:rect");f.setAttributeNS(null,"x","0"),f.setAttributeNS(null,"y","0"),f.setAttributeNS(null,"width","1px"),f.setAttributeNS(null,"height","1px"),f.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(f)}paintImageXObject(f){const v=this.getObject(f);if(!v){(0,m.warn)(`Dependent image with object ID ${f} is not ready yet`);return}this.paintInlineImageXObject(v)}paintInlineImageXObject(f,v){const O=f.width,H=f.height,D=i(f,this.forceDataSchema,!!v),G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x","0"),G.setAttributeNS(null,"y","0"),G.setAttributeNS(null,"width",e(O)),G.setAttributeNS(null,"height",e(H)),this.current.element=G,this.clip("nonzero");const X=this.svgFactory.createElement("svg:image");X.setAttributeNS(B,"xlink:href",D),X.setAttributeNS(null,"x","0"),X.setAttributeNS(null,"y",e(-H)),X.setAttributeNS(null,"width",e(O)+"px"),X.setAttributeNS(null,"height",e(H)+"px"),X.setAttributeNS(null,"transform",`scale(${e(1/O)} ${e(-1/H)})`),v?v.append(X):this._ensureTransformGroup().append(X)}paintImageMaskXObject(f){const v=this.getObject(f.data,f);if(v.bitmap){(0,m.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const O=this.current,H=v.width,D=v.height,G=O.fillColor;O.maskId=`mask${o++}`;const X=this.svgFactory.createElement("svg:mask");X.setAttributeNS(null,"id",O.maskId);const it=this.svgFactory.createElement("svg:rect");it.setAttributeNS(null,"x","0"),it.setAttributeNS(null,"y","0"),it.setAttributeNS(null,"width",e(H)),it.setAttributeNS(null,"height",e(D)),it.setAttributeNS(null,"fill",G),it.setAttributeNS(null,"mask",`url(#${O.maskId})`),this.defs.append(X),this._ensureTransformGroup().append(it),this.paintInlineImageXObject(v,X)}paintFormXObjectBegin(f,v){if(Array.isArray(f)&&f.length===6&&this.transform(f[0],f[1],f[2],f[3],f[4],f[5]),v){const O=v[2]-v[0],H=v[3]-v[1],D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x",v[0]),D.setAttributeNS(null,"y",v[1]),D.setAttributeNS(null,"width",e(O)),D.setAttributeNS(null,"height",e(H)),this.current.element=D,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(f){const v=this.svgFactory.create(f.width,f.height),O=this.svgFactory.createElement("svg:defs");v.append(O),this.defs=O;const H=this.svgFactory.createElement("svg:g");return H.setAttributeNS(null,"transform",d(f.transform)),v.append(H),this.svg=H,v}_ensureClipGroup(){if(!this.current.clipGroup){const f=this.svgFactory.createElement("svg:g");f.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(f),this.current.clipGroup=f}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",d(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}n.SVGGraphics=M}),((N,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaText=void 0;class T{static textContent(m){const I=[],x={items:I,styles:Object.create(null)};function B(U){if(!U)return;let s=null;const t=U.name;if(t==="#text")s=U.value;else if(T.shouldBuildText(t))U?.attributes?.textContent?s=U.attributes.textContent:U.value&&(s=U.value);else return;if(s!==null&&I.push({str:s}),!!U.children)for(const i of U.children)B(i)}return B(m),x}static shouldBuildText(m){return!(m==="textarea"||m==="input"||m==="option"||m==="select")}}n.XfaText=T}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TextLayerRenderTask=void 0,n.renderTextLayer=d,n.updateTextLayer=p;var a=T(1),m=T(6);const I=1e5,x=30,B=.8,U=new Map;function s(o,y){let M;if(y&&a.FeatureTest.isOffscreenCanvasSupported)M=new OffscreenCanvas(o,o).getContext("2d",{alpha:!1});else{const w=document.createElement("canvas");w.width=w.height=o,M=w.getContext("2d",{alpha:!1})}return M}function t(o,y){const M=U.get(o);if(M)return M;const w=s(x,y);w.font=`${x}px ${o}`;const f=w.measureText("");let v=f.fontBoundingBoxAscent,O=Math.abs(f.fontBoundingBoxDescent);if(v){const D=v/(v+O);return U.set(o,D),w.canvas.width=w.canvas.height=0,D}w.strokeStyle="red",w.clearRect(0,0,x,x),w.strokeText("g",0,0);let H=w.getImageData(0,0,x,x).data;O=0;for(let D=H.length-1-3;D>=0;D-=4)if(H[D]>0){O=Math.ceil(D/4/x);break}w.clearRect(0,0,x,x),w.strokeText("A",0,x),H=w.getImageData(0,0,x,x).data,v=0;for(let D=0,G=H.length;D<G;D+=4)if(H[D]>0){v=x-Math.floor(D/4/x);break}if(w.canvas.width=w.canvas.height=0,v){const D=v/(v+O);return U.set(o,D),D}return U.set(o,B),B}function i(o,y,M){const w=document.createElement("span"),f={angle:0,canvasWidth:0,hasText:y.str!=="",hasEOL:y.hasEOL,fontSize:0};o._textDivs.push(w);const v=a.Util.transform(o._transform,y.transform);let O=Math.atan2(v[1],v[0]);const H=M[y.fontName];H.vertical&&(O+=Math.PI/2);const D=Math.hypot(v[2],v[3]),G=D*t(H.fontFamily,o._isOffscreenCanvasSupported);let X,it;O===0?(X=v[4],it=v[5]-G):(X=v[4]+G*Math.sin(O),it=v[5]-G*Math.cos(O));const Q="calc(var(--scale-factor)*",et=w.style;o._container===o._rootContainer?(et.left=`${(100*X/o._pageWidth).toFixed(2)}%`,et.top=`${(100*it/o._pageHeight).toFixed(2)}%`):(et.left=`${Q}${X.toFixed(2)}px)`,et.top=`${Q}${it.toFixed(2)}px)`),et.fontSize=`${Q}${D.toFixed(2)}px)`,et.fontFamily=H.fontFamily,f.fontSize=D,w.setAttribute("role","presentation"),w.textContent=y.str,w.dir=y.dir,o._fontInspectorEnabled&&(w.dataset.fontName=y.fontName),O!==0&&(f.angle=O*(180/Math.PI));let nt=!1;if(y.str.length>1)nt=!0;else if(y.str!==" "&&y.transform[0]!==y.transform[3]){const $=Math.abs(y.transform[0]),F=Math.abs(y.transform[3]);$!==F&&Math.max($,F)/Math.min($,F)>1.5&&(nt=!0)}nt&&(f.canvasWidth=H.vertical?y.height:y.width),o._textDivProperties.set(w,f),o._isReadableStream&&o._layoutText(w)}function u(o){const{div:y,scale:M,properties:w,ctx:f,prevFontSize:v,prevFontFamily:O}=o,{style:H}=y;let D="";if(w.canvasWidth!==0&&w.hasText){const{fontFamily:G}=H,{canvasWidth:X,fontSize:it}=w;(v!==it||O!==G)&&(f.font=`${it*M}px ${G}`,o.prevFontSize=it,o.prevFontFamily=G);const{width:Q}=f.measureText(y.textContent);Q>0&&(D=`scaleX(${X*M/Q})`)}w.angle!==0&&(D=`rotate(${w.angle}deg) ${D}`),D.length>0&&(H.transform=D)}function l(o){if(o._canceled)return;const y=o._textDivs,M=o._capability;if(y.length>I){M.resolve();return}if(!o._isReadableStream)for(const f of y)o._layoutText(f);M.resolve()}class e{constructor({textContentSource:y,container:M,viewport:w,textDivs:f,textDivProperties:v,textContentItemsStr:O,isOffscreenCanvasSupported:H}){this._textContentSource=y,this._isReadableStream=y instanceof ReadableStream,this._container=this._rootContainer=M,this._textDivs=f||[],this._textContentItemsStr=O||[],this._isOffscreenCanvasSupported=H,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=v||new WeakMap,this._canceled=!1,this._capability=new a.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:w.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:s(0,H)};const{pageWidth:D,pageHeight:G,pageX:X,pageY:it}=w.rawDims;this._transform=[1,0,0,-1,-X,it+G],this._pageWidth=D,this._pageHeight=G,(0,m.setLayerDimensions)(M,w),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new a.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new a.AbortException("TextLayer task cancelled."))}_processItems(y,M){for(const w of y){if(w.str===void 0){if(w.type==="beginMarkedContentProps"||w.type==="beginMarkedContent"){const f=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),w.id!==null&&this._container.setAttribute("id",`${w.id}`),f.append(this._container)}else w.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(w.str),i(this,w,M)}}_layoutText(y){const M=this._layoutTextParams.properties=this._textDivProperties.get(y);if(this._layoutTextParams.div=y,u(this._layoutTextParams),M.hasText&&this._container.append(y),M.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this._container.append(w)}}_render(){const y=new a.PromiseCapability;let M=Object.create(null);if(this._isReadableStream){const w=()=>{this._reader.read().then(({value:f,done:v})=>{if(v){y.resolve();return}Object.assign(M,f.styles),this._processItems(f.items,M),w()},y.reject)};this._reader=this._textContentSource.getReader(),w()}else if(this._textContentSource){const{items:w,styles:f}=this._textContentSource;this._processItems(w,f),y.resolve()}else throw new Error('No "textContentSource" parameter specified.');y.promise.then(()=>{M=null,l(this)},this._capability.reject)}}n.TextLayerRenderTask=e;function d(o){!o.textContentSource&&(o.textContent||o.textContentStream)&&((0,m.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),o.textContentSource=o.textContent||o.textContentStream);const{container:y,viewport:M}=o,w=getComputedStyle(y),f=w.getPropertyValue("visibility"),v=parseFloat(w.getPropertyValue("--scale-factor"));f==="visible"&&(!v||Math.abs(v-M.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const O=new e(o);return O._render(),O}function p({container:o,viewport:y,textDivs:M,textDivProperties:w,isOffscreenCanvasSupported:f,mustRotate:v=!0,mustRescale:O=!0}){if(v&&(0,m.setLayerDimensions)(o,{rotation:y.rotation}),O){const H=s(0,f),G={prevFontSize:null,prevFontFamily:null,div:null,scale:y.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:H};for(const X of M)G.properties=w.get(X),G.div=X,u(G)}}}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditorLayer=void 0;var a=T(1),m=T(4),I=T(28),x=T(33),B=T(6),U=T(34);class s{#t;#e=!1;#i=null;#s=this.pointerup.bind(this);#o=this.pointerdown.bind(this);#a=new Map;#r=!1;#l=!1;#c=!1;#n;static _initialized=!1;constructor({uiManager:i,pageIndex:u,div:l,accessibilityManager:e,annotationLayer:d,viewport:p,l10n:o}){const y=[I.FreeTextEditor,x.InkEditor,U.StampEditor];if(!s._initialized){s._initialized=!0;for(const M of y)M.initialize(o)}i.registerEditorTypes(y),this.#n=i,this.pageIndex=u,this.div=l,this.#t=e,this.#i=d,this.viewport=p,this.#n.addLayer(this)}get isEmpty(){return this.#a.size===0}updateToolbar(i){this.#n.updateToolbar(i)}updateMode(i=this.#n.getMode()){this.#p(),i===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),i!==a.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",i===a.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",i===a.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",i===a.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(i){if(!i&&this.#n.getMode()!==a.AnnotationEditorType.INK)return;if(!i){for(const l of this.#a.values())if(l.isEmpty()){l.setInBackground();return}}this.#d({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(i){this.#n.setEditingState(i)}addCommands(i){this.#n.addCommands(i)}enable(){this.div.style.pointerEvents="auto";const i=new Set;for(const l of this.#a.values())l.enableEditing(),l.annotationElementId&&i.add(l.annotationElementId);if(!this.#i)return;const u=this.#i.getEditableAnnotations();for(const l of u){if(l.hide(),this.#n.isDeletedAnnotationElement(l.data.id)||i.has(l.data.id))continue;const e=this.deserialize(l);e&&(this.addOrRebuild(e),e.enableEditing())}}disable(){this.#c=!0,this.div.style.pointerEvents="none";const i=new Set;for(const u of this.#a.values()){if(u.disableEditing(),!u.annotationElementId||u.serialize()!==null){i.add(u.annotationElementId);continue}this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}if(this.#i){const u=this.#i.getEditableAnnotations();for(const l of u){const{id:e}=l.data;i.has(e)||this.#n.isDeletedAnnotationElement(e)||l.show()}}this.#p(),this.isEmpty&&(this.div.hidden=!0),this.#c=!1}getEditableAnnotation(i){return this.#i?.getEditableAnnotation(i)||null}setActiveEditor(i){this.#n.getActive()!==i&&this.#n.setActiveEditor(i)}enableClick(){this.div.addEventListener("pointerdown",this.#o),this.div.addEventListener("pointerup",this.#s)}disableClick(){this.div.removeEventListener("pointerdown",this.#o),this.div.removeEventListener("pointerup",this.#s)}attach(i){this.#a.set(i.id,i);const{annotationElementId:u}=i;u&&this.#n.isDeletedAnnotationElement(u)&&this.#n.removeDeletedAnnotationElement(i)}detach(i){this.#a.delete(i.id),this.#t?.removePointerInTextLayer(i.contentDiv),!this.#c&&i.annotationElementId&&this.#n.addDeletedAnnotationElement(i)}remove(i){this.detach(i),this.#n.removeEditor(i),i.div.contains(document.activeElement)&&setTimeout(()=>{this.#n.focusMainContainer()},0),i.div.remove(),i.isAttachedToDOM=!1,this.#l||this.addInkEditorIfNeeded(!1)}changeParent(i){i.parent!==this&&(i.annotationElementId&&(this.#n.addDeletedAnnotationElement(i.annotationElementId),m.AnnotationEditor.deleteAnnotationElement(i),i.annotationElementId=null),this.attach(i),i.parent?.detach(i),i.setParent(this),i.div&&i.isAttachedToDOM&&(i.div.remove(),this.div.append(i.div)))}add(i){if(this.changeParent(i),this.#n.addEditor(i),this.attach(i),!i.isAttachedToDOM){const u=i.render();this.div.append(u),i.isAttachedToDOM=!0}i.fixAndSetPosition(),i.onceAdded(),this.#n.addToAnnotationStorage(i)}moveEditorInDOM(i){if(!i.isAttachedToDOM)return;const{activeElement:u}=document;i.div.contains(u)&&(i._focusEventsAllowed=!1,setTimeout(()=>{i.div.contains(document.activeElement)?i._focusEventsAllowed=!0:(i.div.addEventListener("focusin",()=>{i._focusEventsAllowed=!0},{once:!0}),u.focus())},0)),i._structTreeParentId=this.#t?.moveElementInDOM(this.div,i.div,i.contentDiv,!0)}addOrRebuild(i){i.needsToBeRebuilt()?i.rebuild():this.add(i)}addUndoableEditor(i){const u=()=>i._uiManager.rebuild(i),l=()=>{i.remove()};this.addCommands({cmd:u,undo:l,mustExec:!1})}getNextId(){return this.#n.getId()}#f(i){switch(this.#n.getMode()){case a.AnnotationEditorType.FREETEXT:return new I.FreeTextEditor(i);case a.AnnotationEditorType.INK:return new x.InkEditor(i);case a.AnnotationEditorType.STAMP:return new U.StampEditor(i)}return null}pasteEditor(i,u){this.#n.updateToolbar(i),this.#n.updateMode(i);const{offsetX:l,offsetY:e}=this.#u(),d=this.getNextId(),p=this.#f({parent:this,id:d,x:l,y:e,uiManager:this.#n,isCentered:!0,...u});p&&this.add(p)}deserialize(i){switch(i.annotationType??i.annotationEditorType){case a.AnnotationEditorType.FREETEXT:return I.FreeTextEditor.deserialize(i,this,this.#n);case a.AnnotationEditorType.INK:return x.InkEditor.deserialize(i,this,this.#n);case a.AnnotationEditorType.STAMP:return U.StampEditor.deserialize(i,this,this.#n)}return null}#d(i,u){const l=this.getNextId(),e=this.#f({parent:this,id:l,x:i.offsetX,y:i.offsetY,uiManager:this.#n,isCentered:u});return e&&this.add(e),e}#u(){const{x:i,y:u,width:l,height:e}=this.div.getBoundingClientRect(),d=Math.max(0,i),p=Math.max(0,u),o=Math.min(window.innerWidth,i+l),y=Math.min(window.innerHeight,u+e),M=(d+o)/2-i,w=(p+y)/2-u,[f,v]=this.viewport.rotation%180===0?[M,w]:[w,M];return{offsetX:f,offsetY:v}}addNewEditor(){this.#d(this.#u(),!0)}setSelected(i){this.#n.setSelected(i)}toggleSelected(i){this.#n.toggleSelected(i)}isSelected(i){return this.#n.isSelected(i)}unselect(i){this.#n.unselect(i)}pointerup(i){const{isMac:u}=a.FeatureTest.platform;if(!(i.button!==0||i.ctrlKey&&u)&&i.target===this.div&&this.#r){if(this.#r=!1,!this.#e){this.#e=!0;return}if(this.#n.getMode()===a.AnnotationEditorType.STAMP){this.#n.unselectAll();return}this.#d(i,!1)}}pointerdown(i){if(this.#r){this.#r=!1;return}const{isMac:u}=a.FeatureTest.platform;if(i.button!==0||i.ctrlKey&&u||i.target!==this.div)return;this.#r=!0;const l=this.#n.getActive();this.#e=!l||l.isEmpty()}findNewParent(i,u,l){const e=this.#n.findParent(u,l);return e===null||e===this?!1:(e.changeParent(i),!0)}destroy(){this.#n.getActive()?.parent===this&&(this.#n.commitOrRemove(),this.#n.setActiveEditor(null));for(const i of this.#a.values())this.#t?.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,this.#a.clear(),this.#n.removeLayer(this)}#p(){this.#l=!0;for(const i of this.#a.values())i.isEmpty()&&i.remove();this.#l=!1}render({viewport:i}){this.viewport=i,(0,B.setLayerDimensions)(this.div,i);for(const u of this.#n.getEditors(this.pageIndex))this.add(u);this.updateMode()}update({viewport:i}){this.#n.commitOrRemove(),this.viewport=i,(0,B.setLayerDimensions)(this.div,{rotation:i.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:i,pageHeight:u}=this.viewport.rawDims;return[i,u]}}n.AnnotationEditorLayer=s}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FreeTextEditor=void 0;var a=T(1),m=T(5),I=T(4),x=T(29);class B extends I.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#i=this.editorDivInput.bind(this);#s=this.editorDivKeydown.bind(this);#o;#a="";#r=`${this.id}-editor`;#l;#c=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const s=B.prototype,t=l=>l.isEmpty(),i=m.AnnotationEditorUIManager.TRANSLATE_SMALL,u=m.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new m.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],s.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],s.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],s._translateEmpty,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],s._translateEmpty,{args:[-u,0],checker:t}],[["ArrowRight","mac+ArrowRight"],s._translateEmpty,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],s._translateEmpty,{args:[u,0],checker:t}],[["ArrowUp","mac+ArrowUp"],s._translateEmpty,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],s._translateEmpty,{args:[0,-u],checker:t}],[["ArrowDown","mac+ArrowDown"],s._translateEmpty,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],s._translateEmpty,{args:[0,u],checker:t}]]))}static _type="freetext";constructor(s){super({...s,name:"freeTextEditor"}),this.#o=s.color||B._defaultColor||I.AnnotationEditor._defaultLineColor,this.#l=s.fontSize||B._defaultFontSize}static initialize(s){I.AnnotationEditor.initialize(s,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const t=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(t.getPropertyValue("--freetext-padding"))}static updateDefaultParams(s,t){switch(s){case a.AnnotationEditorParamsType.FREETEXT_SIZE:B._defaultFontSize=t;break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:B._defaultColor=t;break}}updateParams(s,t){switch(s){case a.AnnotationEditorParamsType.FREETEXT_SIZE:this.#n(t);break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:this.#f(t);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,B._defaultFontSize],[a.AnnotationEditorParamsType.FREETEXT_COLOR,B._defaultColor||I.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,this.#l],[a.AnnotationEditorParamsType.FREETEXT_COLOR,this.#o]]}#n(s){const t=u=>{this.editorDiv.style.fontSize=`calc(${u}px * var(--scale-factor))`,this.translate(0,-(u-this.#l)*this.parentScale),this.#l=u,this.#u()},i=this.#l;this.addCommands({cmd:()=>{t(s)},undo:()=>{t(i)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#f(s){const t=this.#o;this.addCommands({cmd:()=>{this.#o=this.editorDiv.style.color=s},undo:()=>{this.#o=this.editorDiv.style.color=t},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(s,t){this._uiManager.translateSelectedEditors(s,t,!0)}getInitialTranslation(){const s=this.parentScale;return[-B._internalPadding*s,-(B._internalPadding+this.#l)*s]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(a.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#s),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t),this.editorDiv.addEventListener("input",this.#i))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#r),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#s),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.editorDiv.removeEventListener("input",this.#i),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(s){this._focusEventsAllowed&&(super.focusin(s),s.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){this.#m();return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#d(){const s=this.editorDiv.getElementsByTagName("div");if(s.length===0)return this.editorDiv.innerText;const t=[];for(const i of s)t.push(i.innerText.replace(/\r\n?|\n/,""));return t.join(`
`)}#u(){const[s,t]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:u,div:l}=this,e=l.style.display;l.style.display="hidden",u.div.append(this.div),i=l.getBoundingClientRect(),l.remove(),l.style.display=e}this.rotation%180===this.parentRotation%180?(this.width=i.width/s,this.height=i.height/t):(this.width=i.height/s,this.height=i.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const s=this.#a,t=this.#a=this.#d().trimEnd();if(s===t)return;const i=u=>{if(this.#a=u,!u){this.remove();return}this.#p(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{i(t)},undo:()=>{i(s)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(s){this.enterInEditMode()}keydown(s){s.target===this.div&&s.key==="Enter"&&(this.enterInEditMode(),s.preventDefault())}editorDivKeydown(s){B._keyboardManager.exec(this,s)}editorDivFocus(s){this.isEditing=!0}editorDivBlur(s){this.isEditing=!1}editorDivInput(s){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let s,t;this.width&&(s=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#r),this.enableEditing(),I.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(u=>this.editorDiv?.setAttribute("aria-label",u)),I.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(u=>this.editorDiv?.setAttribute("default-content",u)),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#l}px * var(--scale-factor))`,i.color=this.#o,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,m.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[u,l]=this.parentDimensions;if(this.annotationElementId){const{position:e}=this.#c;let[d,p]=this.getInitialTranslation();[d,p]=this.pageTranslationToScreen(d,p);const[o,y]=this.pageDimensions,[M,w]=this.pageTranslation;let f,v;switch(this.rotation){case 0:f=s+(e[0]-M)/o,v=t+this.height-(e[1]-w)/y;break;case 90:f=s+(e[0]-M)/o,v=t-(e[1]-w)/y,[d,p]=[p,-d];break;case 180:f=s-this.width+(e[0]-M)/o,v=t-(e[1]-w)/y,[d,p]=[-d,-p];break;case 270:f=s+(e[0]-M-this.height*y)/o,v=t+(e[1]-w-this.width*o)/y,[d,p]=[-p,d];break}this.setAt(f*u,v*l,d,p)}else this.setAt(s*u,t*l,this.width*u,this.height*l);this.#p(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#p(){if(this.editorDiv.replaceChildren(),!!this.#a)for(const s of this.#a.split(`
`)){const t=document.createElement("div");t.append(s?document.createTextNode(s):document.createElement("br")),this.editorDiv.append(t)}}get contentDiv(){return this.editorDiv}static deserialize(s,t,i){let u=null;if(s instanceof x.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:e,fontColor:d},rect:p,rotation:o,id:y},textContent:M,textPosition:w,parent:{page:{pageNumber:f}}}=s;if(!M||M.length===0)return null;u=s={annotationType:a.AnnotationEditorType.FREETEXT,color:Array.from(d),fontSize:e,value:M.join(`
`),position:w,pageIndex:f-1,rect:p,rotation:o,id:y,deleted:!1}}const l=super.deserialize(s,t,i);return l.#l=s.fontSize,l.#o=a.Util.makeHexColor(...s.color),l.#a=s.value,l.annotationElementId=s.id||null,l.#c=u,l}serialize(s=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const t=B._internalPadding*this.parentScale,i=this.getRect(t,t),u=I.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#o),l={annotationType:a.AnnotationEditorType.FREETEXT,color:u,fontSize:this.#l,value:this.#a,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return s?l:this.annotationElementId&&!this.#b(l)?null:(l.id=this.annotationElementId,l)}#b(s){const{value:t,fontSize:i,color:u,rect:l,pageIndex:e}=this.#c;return s.value!==t||s.fontSize!==i||s.rect.some((d,p)=>Math.abs(d-l[p])>=1)||s.color.some((d,p)=>d!==u[p])||s.pageIndex!==e}#m(s=!1){if(!this.annotationElementId)return;if(this.#u(),!s&&(this.width===0||this.height===0)){setTimeout(()=>this.#m(!0),0);return}const t=B._internalPadding*this.parentScale;this.#c.rect=this.getRect(t,t)}}n.FreeTextEditor=B}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StampAnnotationElement=n.InkAnnotationElement=n.FreeTextAnnotationElement=n.AnnotationLayer=void 0;var a=T(1),m=T(6),I=T(3),x=T(30),B=T(31),U=T(32);const s=1e3,t=9,i=new WeakSet;function u(S){return{width:S[2]-S[0],height:S[3]-S[1]}}class l{static create(r){switch(r.data.annotationType){case a.AnnotationType.LINK:return new d(r);case a.AnnotationType.TEXT:return new p(r);case a.AnnotationType.WIDGET:switch(r.data.fieldType){case"Tx":return new y(r);case"Btn":return r.data.radioButton?new f(r):r.data.checkBox?new w(r):new v(r);case"Ch":return new O(r);case"Sig":return new M(r)}return new o(r);case a.AnnotationType.POPUP:return new H(r);case a.AnnotationType.FREETEXT:return new G(r);case a.AnnotationType.LINE:return new X(r);case a.AnnotationType.SQUARE:return new it(r);case a.AnnotationType.CIRCLE:return new Q(r);case a.AnnotationType.POLYLINE:return new et(r);case a.AnnotationType.CARET:return new $(r);case a.AnnotationType.INK:return new F(r);case a.AnnotationType.POLYGON:return new nt(r);case a.AnnotationType.HIGHLIGHT:return new b(r);case a.AnnotationType.UNDERLINE:return new c(r);case a.AnnotationType.SQUIGGLY:return new h(r);case a.AnnotationType.STRIKEOUT:return new _(r);case a.AnnotationType.STAMP:return new P(r);case a.AnnotationType.FILEATTACHMENT:return new k(r);default:return new e(r)}}}class e{#t=!1;constructor(r,{isRenderable:g=!1,ignoreBorder:A=!1,createQuadrilaterals:E=!1}={}){this.isRenderable=g,this.data=r.data,this.layer=r.layer,this.linkService=r.linkService,this.downloadManager=r.downloadManager,this.imageResourcesPath=r.imageResourcesPath,this.renderForms=r.renderForms,this.svgFactory=r.svgFactory,this.annotationStorage=r.annotationStorage,this.enableScripting=r.enableScripting,this.hasJSActions=r.hasJSActions,this._fieldObjects=r.fieldObjects,this.parent=r.parent,g&&(this.container=this._createContainer(A)),E&&this._createQuadrilaterals()}static _hasPopupData({titleObj:r,contentsObj:g,richText:A}){return!!(r?.str||g?.str||A?.str)}get hasPopupData(){return e._hasPopupData(this.data)}_createContainer(r){const{data:g,parent:{page:A,viewport:E}}=this,C=document.createElement("section");C.setAttribute("data-annotation-id",g.id),this instanceof o||(C.tabIndex=s),C.style.zIndex=this.parent.zIndex++,this.data.popupRef&&C.setAttribute("aria-haspopup","dialog"),g.noRotate&&C.classList.add("norotate");const{pageWidth:L,pageHeight:j,pageX:q,pageY:st}=E.rawDims;if(!g.rect||this instanceof H){const{rotation:Z}=g;return!g.hasOwnCanvas&&Z!==0&&this.setRotation(Z,C),C}const{width:V,height:Y}=u(g.rect),K=a.Util.normalizeRect([g.rect[0],A.view[3]-g.rect[1]+A.view[1],g.rect[2],A.view[3]-g.rect[3]+A.view[1]]);if(!r&&g.borderStyle.width>0){C.style.borderWidth=`${g.borderStyle.width}px`;const Z=g.borderStyle.horizontalCornerRadius,rt=g.borderStyle.verticalCornerRadius;if(Z>0||rt>0){const lt=`calc(${Z}px * var(--scale-factor)) / calc(${rt}px * var(--scale-factor))`;C.style.borderRadius=lt}else if(this instanceof f){const lt=`calc(${V}px * var(--scale-factor)) / calc(${Y}px * var(--scale-factor))`;C.style.borderRadius=lt}switch(g.borderStyle.style){case a.AnnotationBorderStyleType.SOLID:C.style.borderStyle="solid";break;case a.AnnotationBorderStyleType.DASHED:C.style.borderStyle="dashed";break;case a.AnnotationBorderStyleType.BEVELED:(0,a.warn)("Unimplemented border style: beveled");break;case a.AnnotationBorderStyleType.INSET:(0,a.warn)("Unimplemented border style: inset");break;case a.AnnotationBorderStyleType.UNDERLINE:C.style.borderBottomStyle="solid";break}const ot=g.borderColor||null;ot?(this.#t=!0,C.style.borderColor=a.Util.makeHexColor(ot[0]|0,ot[1]|0,ot[2]|0)):C.style.borderWidth=0}C.style.left=`${100*(K[0]-q)/L}%`,C.style.top=`${100*(K[1]-st)/j}%`;const{rotation:J}=g;return g.hasOwnCanvas||J===0?(C.style.width=`${100*V/L}%`,C.style.height=`${100*Y/j}%`):this.setRotation(J,C),C}setRotation(r,g=this.container){if(!this.data.rect)return;const{pageWidth:A,pageHeight:E}=this.parent.viewport.rawDims,{width:C,height:L}=u(this.data.rect);let j,q;r%180===0?(j=100*C/A,q=100*L/E):(j=100*L/A,q=100*C/E),g.style.width=`${j}%`,g.style.height=`${q}%`,g.setAttribute("data-main-rotation",(360-r)%360)}get _commonActions(){const r=(g,A,E)=>{const C=E.detail[g],L=C[0],j=C.slice(1);E.target.style[A]=x.ColorConverters[`${L}_HTML`](j),this.annotationStorage.setValue(this.data.id,{[A]:x.ColorConverters[`${L}_rgb`](j)})};return(0,a.shadow)(this,"_commonActions",{display:g=>{const{display:A}=g.detail,E=A%2===1;this.container.style.visibility=E?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:E,noPrint:A===1||A===2})},print:g=>{this.annotationStorage.setValue(this.data.id,{noPrint:!g.detail.print})},hidden:g=>{const{hidden:A}=g.detail;this.container.style.visibility=A?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:A,noView:A})},focus:g=>{setTimeout(()=>g.target.focus({preventScroll:!1}),0)},userName:g=>{g.target.title=g.detail.userName},readonly:g=>{g.target.disabled=g.detail.readonly},required:g=>{this._setRequired(g.target,g.detail.required)},bgColor:g=>{r("bgColor","backgroundColor",g)},fillColor:g=>{r("fillColor","backgroundColor",g)},fgColor:g=>{r("fgColor","color",g)},textColor:g=>{r("textColor","color",g)},borderColor:g=>{r("borderColor","borderColor",g)},strokeColor:g=>{r("strokeColor","borderColor",g)},rotation:g=>{const A=g.detail.rotation;this.setRotation(A),this.annotationStorage.setValue(this.data.id,{rotation:A})}})}_dispatchEventFromSandbox(r,g){const A=this._commonActions;for(const E of Object.keys(g.detail))(r[E]||A[E])?.(g)}_setDefaultPropertiesFromJS(r){if(!this.enableScripting)return;const g=this.annotationStorage.getRawValue(this.data.id);if(!g)return;const A=this._commonActions;for(const[E,C]of Object.entries(g)){const L=A[E];if(L){const j={detail:{[E]:C},target:r};L(j),delete g[E]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:r}=this.data;if(!r)return;const[g,A,E,C]=this.data.rect;if(r.length===1){const[,{x:rt,y:ot},{x:lt,y:ct}]=r[0];if(E===rt&&C===ot&&g===lt&&A===ct)return}const{style:L}=this.container;let j;if(this.#t){const{borderColor:rt,borderWidth:ot}=L;L.borderWidth=0,j=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${rt}" stroke-width="${ot}">`],this.container.classList.add("hasBorder")}const q=E-g,st=C-A,{svgFactory:V}=this,Y=V.createElement("svg");Y.classList.add("quadrilateralsContainer"),Y.setAttribute("width",0),Y.setAttribute("height",0);const K=V.createElement("defs");Y.append(K);const J=V.createElement("clipPath"),Z=`clippath_${this.data.id}`;J.setAttribute("id",Z),J.setAttribute("clipPathUnits","objectBoundingBox"),K.append(J);for(const[,{x:rt,y:ot},{x:lt,y:ct}]of r){const ht=V.createElement("rect"),ut=(lt-g)/q,At=(C-ot)/st,mt=(rt-lt)/q,wt=(ot-ct)/st;ht.setAttribute("x",ut),ht.setAttribute("y",At),ht.setAttribute("width",mt),ht.setAttribute("height",wt),J.append(ht),j?.push(`<rect vector-effect="non-scaling-stroke" x="${ut}" y="${At}" width="${mt}" height="${wt}"/>`)}this.#t&&(j.push("</g></svg>')"),L.backgroundImage=j.join("")),this.container.append(Y),this.container.style.clipPath=`url(#${Z})`}_createPopup(){const{container:r,data:g}=this;r.setAttribute("aria-haspopup","dialog");const A=new H({data:{color:g.color,titleObj:g.titleObj,modificationDate:g.modificationDate,contentsObj:g.contentsObj,richText:g.richText,parentRect:g.rect,borderStyle:0,id:`popup_${g.id}`,rotation:g.rotation},parent:this.parent,elements:[this]});this.parent.div.append(A.render())}render(){(0,a.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(r,g=null){const A=[];if(this._fieldObjects){const E=this._fieldObjects[r];if(E)for(const{page:C,id:L,exportValues:j}of E){if(C===-1||L===g)continue;const q=typeof j=="string"?j:null,st=document.querySelector(`[data-element-id="${L}"]`);if(st&&!i.has(st)){(0,a.warn)(`_getElementsByName - element not allowed: ${L}`);continue}A.push({id:L,exportValue:q,domElement:st})}return A}for(const E of document.getElementsByName(r)){const{exportValue:C}=E,L=E.getAttribute("data-element-id");L!==g&&i.has(E)&&A.push({id:L,exportValue:C,domElement:E})}return A}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const r=this.getElementsToTriggerPopup();if(Array.isArray(r))for(const g of r)g.classList.add("highlightArea");else r.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:r,data:{id:g}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:r,editId:g})})}}class d extends e{constructor(r,g=null){super(r,{isRenderable:!0,ignoreBorder:!!g?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=r.data.isTooltipOnly}render(){const{data:r,linkService:g}=this,A=document.createElement("a");A.setAttribute("data-element-id",r.id);let E=!1;return r.url?(g.addLinkAttributes(A,r.url,r.newWindow),E=!0):r.action?(this._bindNamedAction(A,r.action),E=!0):r.attachment?(this._bindAttachment(A,r.attachment),E=!0):r.setOCGState?(this.#e(A,r.setOCGState),E=!0):r.dest?(this._bindLink(A,r.dest),E=!0):(r.actions&&(r.actions.Action||r.actions["Mouse Up"]||r.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(A,r),E=!0),r.resetForm?(this._bindResetFormAction(A,r.resetForm),E=!0):this.isTooltipOnly&&!E&&(this._bindLink(A,""),E=!0)),this.container.classList.add("linkAnnotation"),E&&this.container.append(A),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(r,g){r.href=this.linkService.getDestinationHash(g),r.onclick=()=>(g&&this.linkService.goToDestination(g),!1),(g||g==="")&&this.#t()}_bindNamedAction(r,g){r.href=this.linkService.getAnchorUrl(""),r.onclick=()=>(this.linkService.executeNamedAction(g),!1),this.#t()}_bindAttachment(r,g){r.href=this.linkService.getAnchorUrl(""),r.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,g.content,g.filename),!1),this.#t()}#e(r,g){r.href=this.linkService.getAnchorUrl(""),r.onclick=()=>(this.linkService.executeSetOCGState(g),!1),this.#t()}_bindJSAction(r,g){r.href=this.linkService.getAnchorUrl("");const A=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const E of Object.keys(g.actions)){const C=A.get(E);C&&(r[C]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g.id,name:E}}),!1))}r.onclick||(r.onclick=()=>!1),this.#t()}_bindResetFormAction(r,g){const A=r.onclick;if(A||(r.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){(0,a.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),A||(r.onclick=()=>!1);return}r.onclick=()=>{A?.();const{fields:E,refs:C,include:L}=g,j=[];if(E.length!==0||C.length!==0){const V=new Set(C);for(const Y of E){const K=this._fieldObjects[Y]||[];for(const{id:J}of K)V.add(J)}for(const Y of Object.values(this._fieldObjects))for(const K of Y)V.has(K.id)===L&&j.push(K)}else for(const V of Object.values(this._fieldObjects))j.push(...V);const q=this.annotationStorage,st=[];for(const V of j){const{id:Y}=V;switch(st.push(Y),V.type){case"text":{const J=V.defaultValue||"";q.setValue(Y,{value:J});break}case"checkbox":case"radiobutton":{const J=V.defaultValue===V.exportValues;q.setValue(Y,{value:J});break}case"combobox":case"listbox":{const J=V.defaultValue||"";q.setValue(Y,{value:J});break}default:continue}const K=document.querySelector(`[data-element-id="${Y}"]`);if(K){if(!i.has(K)){(0,a.warn)(`_bindResetFormAction - element not allowed: ${Y}`);continue}}else continue;K.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:st,name:"ResetForm"}}),!1}}}class p extends e{constructor(r){super(r,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const r=document.createElement("img");return r.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",r.alt="[{{type}} Annotation]",r.dataset.l10nId="text_annotation_type",r.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(r),this.container}}class o extends e{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(r){this.data.hasOwnCanvas&&(r.previousSibling?.nodeName==="CANVAS"&&(r.previousSibling.hidden=!0),r.hidden=!1)}_getKeyModifier(r){const{isWin:g,isMac:A}=a.FeatureTest.platform;return g&&r.ctrlKey||A&&r.metaKey}_setEventListener(r,g,A,E,C){A.includes("mouse")?r.addEventListener(A,L=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:E,value:C(L),shift:L.shiftKey,modifier:this._getKeyModifier(L)}})}):r.addEventListener(A,L=>{if(A==="blur"){if(!g.focused||!L.relatedTarget)return;g.focused=!1}else if(A==="focus"){if(g.focused)return;g.focused=!0}C&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:E,value:C(L)}})})}_setEventListeners(r,g,A,E){for(const[C,L]of A)(L==="Action"||this.data.actions?.[L])&&((L==="Focus"||L==="Blur")&&(g||={focused:!1}),this._setEventListener(r,g,C,L,E),L==="Focus"&&!this.data.actions?.Blur?this._setEventListener(r,g,"blur","Blur",null):L==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(r,g,"focus","Focus",null))}_setBackgroundColor(r){const g=this.data.backgroundColor||null;r.style.backgroundColor=g===null?"transparent":a.Util.makeHexColor(g[0],g[1],g[2])}_setTextStyle(r){const g=["left","center","right"],{fontColor:A}=this.data.defaultAppearanceData,E=this.data.defaultAppearanceData.fontSize||t,C=r.style;let L;const j=2,q=st=>Math.round(10*st)/10;if(this.data.multiLine){const st=Math.abs(this.data.rect[3]-this.data.rect[1]-j),V=Math.round(st/(a.LINE_FACTOR*E))||1,Y=st/V;L=Math.min(E,q(Y/a.LINE_FACTOR))}else{const st=Math.abs(this.data.rect[3]-this.data.rect[1]-j);L=Math.min(E,q(st/a.LINE_FACTOR))}C.fontSize=`calc(${L}px * var(--scale-factor))`,C.color=a.Util.makeHexColor(A[0],A[1],A[2]),this.data.textAlignment!==null&&(C.textAlign=g[this.data.textAlignment])}_setRequired(r,g){g?r.setAttribute("required",!0):r.removeAttribute("required"),r.setAttribute("aria-required",g)}}class y extends o{constructor(r){const g=r.renderForms||!r.data.hasAppearance&&!!r.data.fieldValue;super(r,{isRenderable:g})}setPropertyOnSiblings(r,g,A,E){const C=this.annotationStorage;for(const L of this._getElementsByName(r.name,r.id))L.domElement&&(L.domElement[g]=A),C.setValue(L.id,{[E]:A})}render(){const r=this.annotationStorage,g=this.data.id;this.container.classList.add("textWidgetAnnotation");let A=null;if(this.renderForms){const E=r.getValue(g,{value:this.data.fieldValue});let C=E.value||"";const L=r.getValue(g,{charLimit:this.data.maxLen}).charLimit;L&&C.length>L&&(C=C.slice(0,L));let j=E.formattedValue||this.data.textContent?.join(`
`)||null;j&&this.data.comb&&(j=j.replaceAll(/\s+/g,""));const q={userValue:C,formattedValue:j,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(A=document.createElement("textarea"),A.textContent=j??C,this.data.doNotScroll&&(A.style.overflowY="hidden")):(A=document.createElement("input"),A.type="text",A.setAttribute("value",j??C),this.data.doNotScroll&&(A.style.overflowX="hidden")),this.data.hasOwnCanvas&&(A.hidden=!0),i.add(A),A.setAttribute("data-element-id",g),A.disabled=this.data.readOnly,A.name=this.data.fieldName,A.tabIndex=s,this._setRequired(A,this.data.required),L&&(A.maxLength=L),A.addEventListener("input",V=>{r.setValue(g,{value:V.target.value}),this.setPropertyOnSiblings(A,"value",V.target.value,"value"),q.formattedValue=null}),A.addEventListener("resetform",V=>{const Y=this.data.defaultFieldValue??"";A.value=q.userValue=Y,q.formattedValue=null});let st=V=>{const{formattedValue:Y}=q;Y!=null&&(V.target.value=Y),V.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){A.addEventListener("focus",Y=>{if(q.focused)return;const{target:K}=Y;q.userValue&&(K.value=q.userValue),q.lastCommittedValue=K.value,q.commitKey=1,q.focused=!0}),A.addEventListener("updatefromsandbox",Y=>{this.showElementAndHideCanvas(Y.target);const K={value(J){q.userValue=J.detail.value??"",r.setValue(g,{value:q.userValue.toString()}),J.target.value=q.userValue},formattedValue(J){const{formattedValue:Z}=J.detail;q.formattedValue=Z,Z!=null&&J.target!==document.activeElement&&(J.target.value=Z),r.setValue(g,{formattedValue:Z})},selRange(J){J.target.setSelectionRange(...J.detail.selRange)},charLimit:J=>{const{charLimit:Z}=J.detail,{target:rt}=J;if(Z===0){rt.removeAttribute("maxLength");return}rt.setAttribute("maxLength",Z);let ot=q.userValue;!ot||ot.length<=Z||(ot=ot.slice(0,Z),rt.value=q.userValue=ot,r.setValue(g,{value:ot}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:ot,willCommit:!0,commitKey:1,selStart:rt.selectionStart,selEnd:rt.selectionEnd}}))}};this._dispatchEventFromSandbox(K,Y)}),A.addEventListener("keydown",Y=>{q.commitKey=1;let K=-1;if(Y.key==="Escape"?K=0:Y.key==="Enter"&&!this.data.multiLine?K=2:Y.key==="Tab"&&(q.commitKey=3),K===-1)return;const{value:J}=Y.target;q.lastCommittedValue!==J&&(q.lastCommittedValue=J,q.userValue=J,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:J,willCommit:!0,commitKey:K,selStart:Y.target.selectionStart,selEnd:Y.target.selectionEnd}}))});const V=st;st=null,A.addEventListener("blur",Y=>{if(!q.focused||!Y.relatedTarget)return;q.focused=!1;const{value:K}=Y.target;q.userValue=K,q.lastCommittedValue!==K&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:K,willCommit:!0,commitKey:q.commitKey,selStart:Y.target.selectionStart,selEnd:Y.target.selectionEnd}}),V(Y)}),this.data.actions?.Keystroke&&A.addEventListener("beforeinput",Y=>{q.lastCommittedValue=null;const{data:K,target:J}=Y,{value:Z,selectionStart:rt,selectionEnd:ot}=J;let lt=rt,ct=ot;switch(Y.inputType){case"deleteWordBackward":{const ht=Z.substring(0,rt).match(/\w*[^\w]*$/);ht&&(lt-=ht[0].length);break}case"deleteWordForward":{const ht=Z.substring(rt).match(/^[^\w]*\w*/);ht&&(ct+=ht[0].length);break}case"deleteContentBackward":rt===ot&&(lt-=1);break;case"deleteContentForward":rt===ot&&(ct+=1);break}Y.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:Z,change:K||"",willCommit:!1,selStart:lt,selEnd:ct}})}),this._setEventListeners(A,q,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Y=>Y.target.value)}if(st&&A.addEventListener("blur",st),this.data.comb){const Y=(this.data.rect[2]-this.data.rect[0])/L;A.classList.add("comb"),A.style.letterSpacing=`calc(${Y}px * var(--scale-factor) - 1ch)`}}else A=document.createElement("div"),A.textContent=this.data.fieldValue,A.style.verticalAlign="middle",A.style.display="table-cell";return this._setTextStyle(A),this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.append(A),this.container}}class M extends o{constructor(r){super(r,{isRenderable:!!r.data.hasOwnCanvas})}}class w extends o{constructor(r){super(r,{isRenderable:r.renderForms})}render(){const r=this.annotationStorage,g=this.data,A=g.id;let E=r.getValue(A,{value:g.exportValue===g.fieldValue}).value;typeof E=="string"&&(E=E!=="Off",r.setValue(A,{value:E})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const C=document.createElement("input");return i.add(C),C.setAttribute("data-element-id",A),C.disabled=g.readOnly,this._setRequired(C,this.data.required),C.type="checkbox",C.name=g.fieldName,E&&C.setAttribute("checked",!0),C.setAttribute("exportValue",g.exportValue),C.tabIndex=s,C.addEventListener("change",L=>{const{name:j,checked:q}=L.target;for(const st of this._getElementsByName(j,A)){const V=q&&st.exportValue===g.exportValue;st.domElement&&(st.domElement.checked=V),r.setValue(st.id,{value:V})}r.setValue(A,{value:q})}),C.addEventListener("resetform",L=>{const j=g.defaultFieldValue||"Off";L.target.checked=j===g.exportValue}),this.enableScripting&&this.hasJSActions&&(C.addEventListener("updatefromsandbox",L=>{const j={value(q){q.target.checked=q.detail.value!=="Off",r.setValue(A,{value:q.target.checked})}};this._dispatchEventFromSandbox(j,L)}),this._setEventListeners(C,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],L=>L.target.checked)),this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}class f extends o{constructor(r){super(r,{isRenderable:r.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const r=this.annotationStorage,g=this.data,A=g.id;let E=r.getValue(A,{value:g.fieldValue===g.buttonValue}).value;typeof E=="string"&&(E=E!==g.buttonValue,r.setValue(A,{value:E}));const C=document.createElement("input");if(i.add(C),C.setAttribute("data-element-id",A),C.disabled=g.readOnly,this._setRequired(C,this.data.required),C.type="radio",C.name=g.fieldName,E&&C.setAttribute("checked",!0),C.tabIndex=s,C.addEventListener("change",L=>{const{name:j,checked:q}=L.target;for(const st of this._getElementsByName(j,A))r.setValue(st.id,{value:!1});r.setValue(A,{value:q})}),C.addEventListener("resetform",L=>{const j=g.defaultFieldValue;L.target.checked=j!=null&&j===g.buttonValue}),this.enableScripting&&this.hasJSActions){const L=g.buttonValue;C.addEventListener("updatefromsandbox",j=>{const q={value:st=>{const V=L===st.detail.value;for(const Y of this._getElementsByName(st.target.name)){const K=V&&Y.id===A;Y.domElement&&(Y.domElement.checked=K),r.setValue(Y.id,{value:K})}}};this._dispatchEventFromSandbox(q,j)}),this._setEventListeners(C,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],j=>j.target.checked)}return this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}class v extends d{constructor(r){super(r,{ignoreBorder:r.data.hasAppearance})}render(){const r=super.render();r.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(r.title=this.data.alternativeText);const g=r.lastChild;return this.enableScripting&&this.hasJSActions&&g&&(this._setDefaultPropertiesFromJS(g),g.addEventListener("updatefromsandbox",A=>{this._dispatchEventFromSandbox({},A)})),r}}class O extends o{constructor(r){super(r,{isRenderable:r.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const r=this.annotationStorage,g=this.data.id,A=r.getValue(g,{value:this.data.fieldValue}),E=document.createElement("select");i.add(E),E.setAttribute("data-element-id",g),E.disabled=this.data.readOnly,this._setRequired(E,this.data.required),E.name=this.data.fieldName,E.tabIndex=s;let C=this.data.combo&&this.data.options.length>0;this.data.combo||(E.size=this.data.options.length,this.data.multiSelect&&(E.multiple=!0)),E.addEventListener("resetform",V=>{const Y=this.data.defaultFieldValue;for(const K of E.options)K.selected=K.value===Y});for(const V of this.data.options){const Y=document.createElement("option");Y.textContent=V.displayValue,Y.value=V.exportValue,A.value.includes(V.exportValue)&&(Y.setAttribute("selected",!0),C=!1),E.append(Y)}let L=null;if(C){const V=document.createElement("option");V.value=" ",V.setAttribute("hidden",!0),V.setAttribute("selected",!0),E.prepend(V),L=()=>{V.remove(),E.removeEventListener("input",L),L=null},E.addEventListener("input",L)}const j=V=>{const Y=V?"value":"textContent",{options:K,multiple:J}=E;return J?Array.prototype.filter.call(K,Z=>Z.selected).map(Z=>Z[Y]):K.selectedIndex===-1?null:K[K.selectedIndex][Y]};let q=j(!1);const st=V=>{const Y=V.target.options;return Array.prototype.map.call(Y,K=>({displayValue:K.textContent,exportValue:K.value}))};return this.enableScripting&&this.hasJSActions?(E.addEventListener("updatefromsandbox",V=>{const Y={value(K){L?.();const J=K.detail.value,Z=new Set(Array.isArray(J)?J:[J]);for(const rt of E.options)rt.selected=Z.has(rt.value);r.setValue(g,{value:j(!0)}),q=j(!1)},multipleSelection(K){E.multiple=!0},remove(K){const J=E.options,Z=K.detail.remove;J[Z].selected=!1,E.remove(Z),J.length>0&&Array.prototype.findIndex.call(J,ot=>ot.selected)===-1&&(J[0].selected=!0),r.setValue(g,{value:j(!0),items:st(K)}),q=j(!1)},clear(K){for(;E.length!==0;)E.remove(0);r.setValue(g,{value:null,items:[]}),q=j(!1)},insert(K){const{index:J,displayValue:Z,exportValue:rt}=K.detail.insert,ot=E.children[J],lt=document.createElement("option");lt.textContent=Z,lt.value=rt,ot?ot.before(lt):E.append(lt),r.setValue(g,{value:j(!0),items:st(K)}),q=j(!1)},items(K){const{items:J}=K.detail;for(;E.length!==0;)E.remove(0);for(const Z of J){const{displayValue:rt,exportValue:ot}=Z,lt=document.createElement("option");lt.textContent=rt,lt.value=ot,E.append(lt)}E.options.length>0&&(E.options[0].selected=!0),r.setValue(g,{value:j(!0),items:st(K)}),q=j(!1)},indices(K){const J=new Set(K.detail.indices);for(const Z of K.target.options)Z.selected=J.has(Z.index);r.setValue(g,{value:j(!0)}),q=j(!1)},editable(K){K.target.disabled=!K.detail.editable}};this._dispatchEventFromSandbox(Y,V)}),E.addEventListener("input",V=>{const Y=j(!0);r.setValue(g,{value:Y}),V.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:q,changeEx:Y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(E,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],V=>V.target.value)):E.addEventListener("input",function(V){r.setValue(g,{value:j(!0)})}),this.data.combo&&this._setTextStyle(E),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class H extends e{constructor(r){const{data:g,elements:A}=r;super(r,{isRenderable:e._hasPopupData(g)}),this.elements=A}render(){this.container.classList.add("popupAnnotation");const r=new D({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),g=[];for(const A of this.elements)A.popup=r,g.push(A.data.id),A.addHighlightArea();return this.container.setAttribute("aria-controls",g.map(A=>`${a.AnnotationPrefix}${A}`).join(",")),this.container}}class D{#t=null;#e=this.#h.bind(this);#i=this.#S.bind(this);#s=this.#E.bind(this);#o=this.#_.bind(this);#a=null;#r=null;#l=null;#c=null;#n=null;#f=null;#d=!1;#u=null;#p=null;#b=null;#m=null;#g=!1;constructor({container:r,color:g,elements:A,titleObj:E,modificationDate:C,contentsObj:L,richText:j,parent:q,rect:st,parentRect:V,open:Y}){this.#r=r,this.#m=E,this.#l=L,this.#b=j,this.#n=q,this.#a=g,this.#p=st,this.#f=V,this.#c=A;const K=m.PDFDateString.toDateObject(C);K&&(this.#t=q.l10n.get("annotation_date_string",{date:K.toLocaleDateString(),time:K.toLocaleTimeString()})),this.trigger=A.flatMap(J=>J.getElementsToTriggerPopup());for(const J of this.trigger)J.addEventListener("click",this.#o),J.addEventListener("mouseenter",this.#s),J.addEventListener("mouseleave",this.#i),J.classList.add("popupTriggerArea");for(const J of A)J.container?.addEventListener("keydown",this.#e);this.#r.hidden=!0,Y&&this.#_()}render(){if(this.#u)return;const{page:{view:r},viewport:{rawDims:{pageWidth:g,pageHeight:A,pageX:E,pageY:C}}}=this.#n,L=this.#u=document.createElement("div");if(L.className="popup",this.#a){const ht=L.style.outlineColor=a.Util.makeHexColor(...this.#a);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?L.style.backgroundColor=`color-mix(in srgb, ${ht} 30%, white)`:L.style.backgroundColor=a.Util.makeHexColor(...this.#a.map(At=>Math.floor(.7*(255-At)+At)))}const j=document.createElement("span");j.className="header";const q=document.createElement("h1");if(j.append(q),{dir:q.dir,str:q.textContent}=this.#m,L.append(j),this.#t){const ht=document.createElement("span");ht.classList.add("popupDate"),this.#t.then(ut=>{ht.textContent=ut}),j.append(ht)}const st=this.#l,V=this.#b;if(V?.str&&(!st?.str||st.str===V.str))U.XfaLayer.render({xfaHtml:V.html,intent:"richText",div:L}),L.lastChild.classList.add("richText","popupContent");else{const ht=this._formatContents(st);L.append(ht)}let Y=!!this.#f,K=Y?this.#f:this.#p;for(const ht of this.#c)if(!K||a.Util.intersect(ht.data.rect,K)!==null){K=ht.data.rect,Y=!0;break}const J=a.Util.normalizeRect([K[0],r[3]-K[1]+r[1],K[2],r[3]-K[3]+r[1]]),rt=Y?K[2]-K[0]+5:0,ot=J[0]+rt,lt=J[1],{style:ct}=this.#r;ct.left=`${100*(ot-E)/g}%`,ct.top=`${100*(lt-C)/A}%`,this.#r.append(L)}_formatContents({str:r,dir:g}){const A=document.createElement("p");A.classList.add("popupContent"),A.dir=g;const E=r.split(/(?:\r\n?|\n)/);for(let C=0,L=E.length;C<L;++C){const j=E[C];A.append(document.createTextNode(j)),C<L-1&&A.append(document.createElement("br"))}return A}#h(r){r.altKey||r.shiftKey||r.ctrlKey||r.metaKey||(r.key==="Enter"||r.key==="Escape"&&this.#d)&&this.#_()}#_(){this.#d=!this.#d,this.#d?(this.#E(),this.#r.addEventListener("click",this.#o),this.#r.addEventListener("keydown",this.#e)):(this.#S(),this.#r.removeEventListener("click",this.#o),this.#r.removeEventListener("keydown",this.#e))}#E(){this.#u||this.render(),this.isVisible?this.#d&&this.#r.classList.add("focused"):(this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#S(){this.#r.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#g=this.isVisible,this.#g&&(this.#r.hidden=!0)}maybeShow(){this.#g&&(this.#g=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class G extends e{constructor(r){super(r,{isRenderable:!0,ignoreBorder:!0}),this.textContent=r.data.textContent,this.textPosition=r.data.textPosition,this.annotationEditorType=a.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const r=document.createElement("div");r.classList.add("annotationTextContent"),r.setAttribute("role","comment");for(const g of this.textContent){const A=document.createElement("span");A.textContent=g,r.append(A)}this.container.append(r)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}n.FreeTextAnnotationElement=G;class X extends e{#t=null;constructor(r){super(r,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const r=this.data,{width:g,height:A}=u(r.rect),E=this.svgFactory.create(g,A,!0),C=this.#t=this.svgFactory.createElement("svg:line");return C.setAttribute("x1",r.rect[2]-r.lineCoordinates[0]),C.setAttribute("y1",r.rect[3]-r.lineCoordinates[1]),C.setAttribute("x2",r.rect[2]-r.lineCoordinates[2]),C.setAttribute("y2",r.rect[3]-r.lineCoordinates[3]),C.setAttribute("stroke-width",r.borderStyle.width||1),C.setAttribute("stroke","transparent"),C.setAttribute("fill","transparent"),E.append(C),this.container.append(E),!r.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class it extends e{#t=null;constructor(r){super(r,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const r=this.data,{width:g,height:A}=u(r.rect),E=this.svgFactory.create(g,A,!0),C=r.borderStyle.width,L=this.#t=this.svgFactory.createElement("svg:rect");return L.setAttribute("x",C/2),L.setAttribute("y",C/2),L.setAttribute("width",g-C),L.setAttribute("height",A-C),L.setAttribute("stroke-width",C||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),E.append(L),this.container.append(E),!r.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Q extends e{#t=null;constructor(r){super(r,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const r=this.data,{width:g,height:A}=u(r.rect),E=this.svgFactory.create(g,A,!0),C=r.borderStyle.width,L=this.#t=this.svgFactory.createElement("svg:ellipse");return L.setAttribute("cx",g/2),L.setAttribute("cy",A/2),L.setAttribute("rx",g/2-C/2),L.setAttribute("ry",A/2-C/2),L.setAttribute("stroke-width",C||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),E.append(L),this.container.append(E),!r.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class et extends e{#t=null;constructor(r){super(r,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const r=this.data,{width:g,height:A}=u(r.rect),E=this.svgFactory.create(g,A,!0);let C=[];for(const j of r.vertices){const q=j.x-r.rect[0],st=r.rect[3]-j.y;C.push(q+","+st)}C=C.join(" ");const L=this.#t=this.svgFactory.createElement(this.svgElementName);return L.setAttribute("points",C),L.setAttribute("stroke-width",r.borderStyle.width||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),E.append(L),this.container.append(E),!r.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class nt extends et{constructor(r){super(r),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class $ extends e{constructor(r){super(r,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class F extends e{#t=[];constructor(r){super(r,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=a.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const r=this.data,{width:g,height:A}=u(r.rect),E=this.svgFactory.create(g,A,!0);for(const C of r.inkLists){let L=[];for(const q of C){const st=q.x-r.rect[0],V=r.rect[3]-q.y;L.push(`${st},${V}`)}L=L.join(" ");const j=this.svgFactory.createElement(this.svgElementName);this.#t.push(j),j.setAttribute("points",L),j.setAttribute("stroke-width",r.borderStyle.width||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),!r.popupRef&&this.hasPopupData&&this._createPopup(),E.append(j)}return this.container.append(E),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}n.InkAnnotationElement=F;class b extends e{constructor(r){super(r,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class c extends e{constructor(r){super(r,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class h extends e{constructor(r){super(r,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class _ extends e{constructor(r){super(r,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class P extends e{constructor(r){super(r,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}n.StampAnnotationElement=P;class k extends e{#t=null;constructor(r){super(r,{isRenderable:!0});const{filename:g,content:A}=this.data.file;this.filename=(0,m.getFilenameFromUrl)(g,!0),this.content=A,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:g,content:A})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:r,data:g}=this;let A;g.hasAppearance||g.fillAlpha===0?A=document.createElement("div"):(A=document.createElement("img"),A.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(g.name)?"paperclip":"pushpin"}.svg`,g.fillAlpha&&g.fillAlpha<1&&(A.style=`filter: opacity(${Math.round(g.fillAlpha*100)}%);`)),A.addEventListener("dblclick",this.#e.bind(this)),this.#t=A;const{isMac:E}=a.FeatureTest.platform;return r.addEventListener("keydown",C=>{C.key==="Enter"&&(E?C.metaKey:C.ctrlKey)&&this.#e()}),!g.popupRef&&this.hasPopupData?this._createPopup():A.classList.add("popupTriggerArea"),r.append(A),r}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class R{#t=null;#e=null;#i=new Map;constructor({div:r,accessibilityManager:g,annotationCanvasMap:A,l10n:E,page:C,viewport:L}){this.div=r,this.#t=g,this.#e=A,this.l10n=E,this.page=C,this.viewport=L,this.zIndex=0,this.l10n||=B.NullL10n}#s(r,g){const A=r.firstChild||r;A.id=`${a.AnnotationPrefix}${g}`,this.div.append(r),this.#t?.moveElementInDOM(this.div,r,A,!1)}async render(r){const{annotations:g}=r,A=this.div;(0,m.setLayerDimensions)(A,this.viewport);const E=new Map,C={data:null,layer:A,linkService:r.linkService,downloadManager:r.downloadManager,imageResourcesPath:r.imageResourcesPath||"",renderForms:r.renderForms!==!1,svgFactory:new m.DOMSVGFactory,annotationStorage:r.annotationStorage||new I.AnnotationStorage,enableScripting:r.enableScripting===!0,hasJSActions:r.hasJSActions,fieldObjects:r.fieldObjects,parent:this,elements:null};for(const L of g){if(L.noHTML)continue;const j=L.annotationType===a.AnnotationType.POPUP;if(j){const V=E.get(L.id);if(!V)continue;C.elements=V}else{const{width:V,height:Y}=u(L.rect);if(V<=0||Y<=0)continue}C.data=L;const q=l.create(C);if(!q.isRenderable)continue;if(!j&&L.popupRef){const V=E.get(L.popupRef);V?V.push(q):E.set(L.popupRef,[q])}q.annotationEditorType>0&&this.#i.set(q.data.id,q);const st=q.render();L.hidden&&(st.style.visibility="hidden"),this.#s(st,L.id)}this.#o(),await this.l10n.translate(A)}update({viewport:r}){const g=this.div;this.viewport=r,(0,m.setLayerDimensions)(g,{rotation:r.rotation}),this.#o(),g.hidden=!1}#o(){if(!this.#e)return;const r=this.div;for(const[g,A]of this.#e){const E=r.querySelector(`[data-annotation-id="${g}"]`);if(!E)continue;const{firstChild:C}=E;C?C.nodeName==="CANVAS"?C.replaceWith(A):C.before(A):E.append(A)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(r){return this.#i.get(r)}}n.AnnotationLayer=R}),((N,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function T(I){return Math.floor(Math.max(0,Math.min(1,I))*255).toString(16).padStart(2,"0")}function a(I){return Math.max(0,Math.min(255,255*I))}class m{static CMYK_G([x,B,U,s]){return["G",1-Math.min(1,.3*x+.59*U+.11*B+s)]}static G_CMYK([x]){return["CMYK",0,0,0,1-x]}static G_RGB([x]){return["RGB",x,x,x]}static G_rgb([x]){return x=a(x),[x,x,x]}static G_HTML([x]){const B=T(x);return`#${B}${B}${B}`}static RGB_G([x,B,U]){return["G",.3*x+.59*B+.11*U]}static RGB_rgb(x){return x.map(a)}static RGB_HTML(x){return`#${x.map(T).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([x,B,U,s]){return["RGB",1-Math.min(1,x+s),1-Math.min(1,U+s),1-Math.min(1,B+s)]}static CMYK_rgb([x,B,U,s]){return[a(1-Math.min(1,x+s)),a(1-Math.min(1,U+s)),a(1-Math.min(1,B+s))]}static CMYK_HTML(x){const B=this.CMYK_RGB(x).slice(1);return this.RGB_HTML(B)}static RGB_CMYK([x,B,U]){const s=1-x,t=1-B,i=1-U,u=Math.min(s,t,i);return["CMYK",s,t,i,u]}}n.ColorConverters=m}),((N,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NullL10n=void 0,n.getL10nFallback=a;const T={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};T.print_progress_percent="{{progress}}%";function a(x,B){switch(x){case"find_match_count":x=`find_match_count[${B.total===1?"one":"other"}]`;break;case"find_match_count_limit":x=`find_match_count_limit[${B.limit===1?"one":"other"}]`;break}return T[x]||""}function m(x,B){return B?x.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(U,s)=>s in B?B[s]:"{{"+s+"}}"):x}const I={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(x,B=null,U=a(x,B)){return m(U,B)},async translate(x){}};n.NullL10n=I}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;var a=T(25);class m{static setupStorage(x,B,U,s,t){const i=s.getValue(B,{value:null});switch(U.name){case"textarea":if(i.value!==null&&(x.textContent=i.value),t==="print")break;x.addEventListener("input",u=>{s.setValue(B,{value:u.target.value})});break;case"input":if(U.attributes.type==="radio"||U.attributes.type==="checkbox"){if(i.value===U.attributes.xfaOn?x.setAttribute("checked",!0):i.value===U.attributes.xfaOff&&x.removeAttribute("checked"),t==="print")break;x.addEventListener("change",u=>{s.setValue(B,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(i.value!==null&&x.setAttribute("value",i.value),t==="print")break;x.addEventListener("input",u=>{s.setValue(B,{value:u.target.value})})}break;case"select":if(i.value!==null){x.setAttribute("value",i.value);for(const u of U.children)u.attributes.value===i.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}x.addEventListener("input",u=>{const l=u.target.options,e=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(B,{value:e})});break}}static setAttributes({html:x,element:B,storage:U=null,intent:s,linkService:t}){const{attributes:i}=B,u=x instanceof HTMLAnchorElement;i.type==="radio"&&(i.name=`${i.name}-${s}`);for(const[l,e]of Object.entries(i))if(e!=null)switch(l){case"class":e.length&&x.setAttribute(l,e.join(" "));break;case"dataId":break;case"id":x.setAttribute("data-element-id",e);break;case"style":Object.assign(x.style,e);break;case"textContent":x.textContent=e;break;default:(!u||l!=="href"&&l!=="newWindow")&&x.setAttribute(l,e)}u&&t.addLinkAttributes(x,i.href,i.newWindow),U&&i.dataId&&this.setupStorage(x,i.dataId,B,U)}static render(x){const B=x.annotationStorage,U=x.linkService,s=x.xfaHtml,t=x.intent||"display",i=document.createElement(s.name);s.attributes&&this.setAttributes({html:i,element:s,intent:t,linkService:U});const u=[[s,-1,i]],l=x.div;if(l.append(i),x.viewport){const d=`matrix(${x.viewport.transform.join(",")})`;l.style.transform=d}t!=="richText"&&l.setAttribute("class","xfaLayer xfaFont");const e=[];for(;u.length>0;){const[d,p,o]=u.at(-1);if(p+1===d.children.length){u.pop();continue}const y=d.children[++u.at(-1)[1]];if(y===null)continue;const{name:M}=y;if(M==="#text"){const f=document.createTextNode(y.value);e.push(f),o.append(f);continue}const w=y?.attributes?.xmlns?document.createElementNS(y.attributes.xmlns,M):document.createElement(M);if(o.append(w),y.attributes&&this.setAttributes({html:w,element:y,storage:B,intent:t,linkService:U}),y.children&&y.children.length>0)u.push([y,-1,w]);else if(y.value){const f=document.createTextNode(y.value);a.XfaText.shouldBuildText(M)&&e.push(f),w.append(f)}}for(const d of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:e}}static update(x){const B=`matrix(${x.viewport.transform.join(",")})`;x.div.style.transform=B,x.div.hidden=!1}}n.XfaLayer=m}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.InkEditor=void 0;var a=T(1),m=T(4),I=T(29),x=T(6),B=T(5);class U extends m.AnnotationEditor{#t=0;#e=0;#i=this.canvasPointermove.bind(this);#s=this.canvasPointerleave.bind(this);#o=this.canvasPointerup.bind(this);#a=this.canvasPointerdown.bind(this);#r=new Path2D;#l=!1;#c=!1;#n=!1;#f=null;#d=0;#u=0;#p=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(t){super({...t,name:"inkEditor"}),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t){m.AnnotationEditor.initialize(t,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(t,i){switch(t){case a.AnnotationEditorParamsType.INK_THICKNESS:U._defaultThickness=i;break;case a.AnnotationEditorParamsType.INK_COLOR:U._defaultColor=i;break;case a.AnnotationEditorParamsType.INK_OPACITY:U._defaultOpacity=i/100;break}}updateParams(t,i){switch(t){case a.AnnotationEditorParamsType.INK_THICKNESS:this.#b(i);break;case a.AnnotationEditorParamsType.INK_COLOR:this.#m(i);break;case a.AnnotationEditorParamsType.INK_OPACITY:this.#g(i);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,U._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,U._defaultColor||m.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(U._defaultOpacity*100)]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||U._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,this.color||U._defaultColor||m.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??U._defaultOpacity))]]}#b(t){const i=this.thickness;this.addCommands({cmd:()=>{this.thickness=t,this.#C()},undo:()=>{this.thickness=i,this.#C()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#m(t){const i=this.color;this.addCommands({cmd:()=>{this.color=t,this.#A()},undo:()=>{this.color=i,this.#A()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#g(t){t/=100;const i=this.opacity;this.addCommands({cmd:()=>{this.opacity=t,this.#A()},undo:()=>{this.opacity=i,this.#A()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#k(),this.#M()),this.isAttachedToDOM||(this.parent.add(this),this.#y()),this.#C()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#f.disconnect(),this.#f=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&t===null&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,i]=this.parentDimensions,u=this.width*t,l=this.height*i;this.setDimensions(u,l)}enableEditMode(){this.#l||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#a))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#a))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#h(){const{parentRotation:t,parentDimensions:[i,u]}=this;switch(t){case 90:return[0,u,u,i];case 180:return[i,u,i,u];case 270:return[i,0,u,i];default:return[0,0,i,u]}}#_(){const{ctx:t,color:i,opacity:u,thickness:l,parentScale:e,scaleFactor:d}=this;t.lineWidth=l*e/d,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${i}${(0,B.opacityToHex)(u)}`}#E(t,i){this.canvas.addEventListener("contextmenu",x.noContextMenu),this.canvas.addEventListener("pointerleave",this.#s),this.canvas.addEventListener("pointermove",this.#i),this.canvas.addEventListener("pointerup",this.#o),this.canvas.removeEventListener("pointerdown",this.#a),this.isEditing=!0,this.#n||(this.#n=!0,this.#y(),this.thickness||=U._defaultThickness,this.color||=U._defaultColor||m.AnnotationEditor._defaultLineColor,this.opacity??=U._defaultOpacity),this.currentPath.push([t,i]),this.#c=!1,this.#_(),this.#p=()=>{this.#I(),this.#p&&window.requestAnimationFrame(this.#p)},window.requestAnimationFrame(this.#p)}#S(t,i){const[u,l]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===u&&i===l)return;const e=this.currentPath;let d=this.#r;if(e.push([t,i]),this.#c=!0,e.length<=2){d.moveTo(...e[0]),d.lineTo(t,i);return}e.length===3&&(this.#r=d=new Path2D,d.moveTo(...e[0])),this.#L(d,...e.at(-3),...e.at(-2),t,i)}#T(){if(this.currentPath.length===0)return;const t=this.currentPath.at(-1);this.#r.lineTo(...t)}#x(t,i){this.#p=null,t=Math.min(Math.max(t,0),this.canvas.width),i=Math.min(Math.max(i,0),this.canvas.height),this.#S(t,i),this.#T();let u;if(this.currentPath.length!==1)u=this.#O();else{const o=[t,i];u=[[o,o.slice(),o.slice(),o]]}const l=this.#r,e=this.currentPath;this.currentPath=[],this.#r=new Path2D;const d=()=>{this.allRawPaths.push(e),this.paths.push(u),this.bezierPath2D.push(l),this.rebuild()},p=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#k(),this.#M()),this.#C())};this.addCommands({cmd:d,undo:p,mustExec:!0})}#I(){if(!this.#c)return;this.#c=!1;const t=Math.ceil(this.thickness*this.parentScale),i=this.currentPath.slice(-3),u=i.map(d=>d[0]),l=i.map(d=>d[1]);Math.min(...u)-t,Math.max(...u)+t,Math.min(...l)-t,Math.max(...l)+t;const{ctx:e}=this;e.save(),e.clearRect(0,0,this.canvas.width,this.canvas.height);for(const d of this.bezierPath2D)e.stroke(d);e.stroke(this.#r),e.restore()}#L(t,i,u,l,e,d,p){const o=(i+l)/2,y=(u+e)/2,M=(l+d)/2,w=(e+p)/2;t.bezierCurveTo(o+2*(l-o)/3,y+2*(e-y)/3,M+2*(l-M)/3,w+2*(e-w)/3,M,w)}#O(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const i=[];let u,[l,e]=t[0];for(u=1;u<t.length-2;u++){const[f,v]=t[u],[O,H]=t[u+1],D=(f+O)/2,G=(v+H)/2,X=[l+2*(f-l)/3,e+2*(v-e)/3],it=[D+2*(f-D)/3,G+2*(v-G)/3];i.push([[l,e],X,it,[D,G]]),[l,e]=[D,G]}const[d,p]=t[u],[o,y]=t[u+1],M=[l+2*(d-l)/3,e+2*(p-e)/3],w=[o+2*(d-o)/3,y+2*(p-y)/3];return i.push([[l,e],M,w,[o,y]]),i}#A(){if(this.isEmpty()){this.#w();return}this.#_();const{canvas:t,ctx:i}=this;i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,t.width,t.height),this.#w();for(const u of this.bezierPath2D)i.stroke(u)}commit(){this.#l||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#l=!0,this.div.classList.add("disabled"),this.#C(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}canvasPointerdown(t){t.button!==0||!this.isInEditMode()||this.#l||(this.setInForeground(),t.preventDefault(),t.type!=="mouse"&&this.div.focus(),this.#E(t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),this.#S(t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),this.#D(t)}canvasPointerleave(t){this.#D(t)}#D(t){this.canvas.removeEventListener("pointerleave",this.#s),this.canvas.removeEventListener("pointermove",this.#i),this.canvas.removeEventListener("pointerup",this.#o),this.canvas.addEventListener("pointerdown",this.#a),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",x.noContextMenu)},10),this.#x(t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#k(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",m.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(t=>this.canvas?.setAttribute("aria-label",t)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#M(){this.#f=new ResizeObserver(t=>{const i=t[0].contentRect;i.width&&i.height&&this.setDimensions(i.width,i.height)}),this.#f.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#l}render(){if(this.div)return this.div;let t,i;this.width&&(t=this.x,i=this.y),super.render(),m.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(p=>this.div?.setAttribute("aria-label",p));const[u,l,e,d]=this.#h();if(this.setAt(u,l,0,0),this.setDims(e,d),this.#k(),this.width){const[p,o]=this.parentDimensions;this.setAspectRatio(this.width*p,this.height*o),this.setAt(t*p,i*o,this.width*p,this.height*o),this.#n=!0,this.#y(),this.setDims(this.width*p,this.height*o),this.#A(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#M(),this.div}#y(){if(!this.#n)return;const[t,i]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*i),this.#w()}setDimensions(t,i){const u=Math.round(t),l=Math.round(i);if(this.#d===u&&this.#u===l)return;this.#d=u,this.#u=l,this.canvas.style.visibility="hidden";const[e,d]=this.parentDimensions;this.width=t/e,this.height=i/d,this.fixAndSetPosition(),this.#l&&this.#P(t,i),this.#y(),this.#A(),this.canvas.style.visibility="visible",this.fixDims()}#P(t,i){const u=this.#R(),l=(t-u)/this.#e,e=(i-u)/this.#t;this.scaleFactor=Math.min(l,e)}#w(){const t=this.#R()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#N(t){const i=new Path2D;for(let u=0,l=t.length;u<l;u++){const[e,d,p,o]=t[u];u===0&&i.moveTo(...e),i.bezierCurveTo(d[0],d[1],p[0],p[1],o[0],o[1])}return i}static#B(t,i,u){const[l,e,d,p]=i;switch(u){case 0:for(let o=0,y=t.length;o<y;o+=2)t[o]+=l,t[o+1]=p-t[o+1];break;case 90:for(let o=0,y=t.length;o<y;o+=2){const M=t[o];t[o]=t[o+1]+l,t[o+1]=M+e}break;case 180:for(let o=0,y=t.length;o<y;o+=2)t[o]=d-t[o],t[o+1]+=e;break;case 270:for(let o=0,y=t.length;o<y;o+=2){const M=t[o];t[o]=d-t[o+1],t[o+1]=p-M}break;default:throw new Error("Invalid rotation")}return t}static#U(t,i,u){const[l,e,d,p]=i;switch(u){case 0:for(let o=0,y=t.length;o<y;o+=2)t[o]-=l,t[o+1]=p-t[o+1];break;case 90:for(let o=0,y=t.length;o<y;o+=2){const M=t[o];t[o]=t[o+1]-e,t[o+1]=M-l}break;case 180:for(let o=0,y=t.length;o<y;o+=2)t[o]=d-t[o],t[o+1]-=e;break;case 270:for(let o=0,y=t.length;o<y;o+=2){const M=t[o];t[o]=p-t[o+1],t[o+1]=d-M}break;default:throw new Error("Invalid rotation")}return t}#j(t,i,u,l){const e=[],d=this.thickness/2,p=t*i+d,o=t*u+d;for(const y of this.paths){const M=[],w=[];for(let f=0,v=y.length;f<v;f++){const[O,H,D,G]=y[f],X=t*O[0]+p,it=t*O[1]+o,Q=t*H[0]+p,et=t*H[1]+o,nt=t*D[0]+p,$=t*D[1]+o,F=t*G[0]+p,b=t*G[1]+o;f===0&&(M.push(X,it),w.push(X,it)),M.push(Q,et,nt,$,F,b),w.push(Q,et),f===v-1&&w.push(F,b)}e.push({bezier:U.#B(M,l,this.rotation),points:U.#B(w,l,this.rotation)})}return e}#F(){let t=1/0,i=-1/0,u=1/0,l=-1/0;for(const e of this.paths)for(const[d,p,o,y]of e){const M=a.Util.bezierBoundingBox(...d,...p,...o,...y);t=Math.min(t,M[0]),u=Math.min(u,M[1]),i=Math.max(i,M[2]),l=Math.max(l,M[3])}return[t,u,i,l]}#R(){return this.#l?Math.ceil(this.thickness*this.parentScale):0}#C(t=!1){if(this.isEmpty())return;if(!this.#l){this.#A();return}const i=this.#F(),u=this.#R();this.#e=Math.max(m.AnnotationEditor.MIN_SIZE,i[2]-i[0]),this.#t=Math.max(m.AnnotationEditor.MIN_SIZE,i[3]-i[1]);const l=Math.ceil(u+this.#e*this.scaleFactor),e=Math.ceil(u+this.#t*this.scaleFactor),[d,p]=this.parentDimensions;this.width=l/d,this.height=e/p,this.setAspectRatio(l,e);const o=this.translationX,y=this.translationY;this.translationX=-i[0],this.translationY=-i[1],this.#y(),this.#A(),this.#d=l,this.#u=e,this.setDims(l,e);const M=t?u/this.scaleFactor/2:0;this.translate(o-this.translationX-M,y-this.translationY-M)}static deserialize(t,i,u){if(t instanceof I.InkAnnotationElement)return null;const l=super.deserialize(t,i,u);l.thickness=t.thickness,l.color=a.Util.makeHexColor(...t.color),l.opacity=t.opacity;const[e,d]=l.pageDimensions,p=l.width*e,o=l.height*d,y=l.parentScale,M=t.thickness/2;l.#l=!0,l.#d=Math.round(p),l.#u=Math.round(o);const{paths:w,rect:f,rotation:v}=t;for(let{bezier:H}of w){H=U.#U(H,f,v);const D=[];l.paths.push(D);let G=y*(H[0]-M),X=y*(H[1]-M);for(let Q=2,et=H.length;Q<et;Q+=6){const nt=y*(H[Q]-M),$=y*(H[Q+1]-M),F=y*(H[Q+2]-M),b=y*(H[Q+3]-M),c=y*(H[Q+4]-M),h=y*(H[Q+5]-M);D.push([[G,X],[nt,$],[F,b],[c,h]]),G=c,X=h}const it=this.#N(D);l.bezierPath2D.push(it)}const O=l.#F();return l.#e=Math.max(m.AnnotationEditor.MIN_SIZE,O[2]-O[0]),l.#t=Math.max(m.AnnotationEditor.MIN_SIZE,O[3]-O[1]),l.#P(p,o),l}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),i=m.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:a.AnnotationEditorType.INK,color:i,thickness:this.thickness,opacity:this.opacity,paths:this.#j(this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}n.InkEditor=U}),((N,n,T)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StampEditor=void 0;var a=T(1),m=T(4),I=T(6),x=T(29);class B extends m.AnnotationEditor{#t=null;#e=null;#i=null;#s=null;#o=null;#a=null;#r=null;#l=null;#c=!1;#n=!1;static _type="stamp";constructor(s){super({...s,name:"stampEditor"}),this.#s=s.bitmapUrl,this.#o=s.bitmapFile}static initialize(s){m.AnnotationEditor.initialize(s)}static get supportedTypes(){const s=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,a.shadow)(this,"supportedTypes",s.map(t=>`image/${t}`))}static get supportedTypesStr(){return(0,a.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(s){return this.supportedTypes.includes(s)}static paste(s,t){t.pasteEditor(a.AnnotationEditorType.STAMP,{bitmapFile:s.getAsFile()})}#f(s,t=!1){if(!s){this.remove();return}this.#t=s.bitmap,t||(this.#e=s.id,this.#c=s.isSvg),this.#p()}#d(){this.#i=null,this._uiManager.enableWaiting(!1),this.#a&&this.div.focus()}#u(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(t=>this.#f(t,!0)).finally(()=>this.#d());return}if(this.#s){const t=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(t).then(i=>this.#f(i)).finally(()=>this.#d());return}if(this.#o){const t=this.#o;this.#o=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(t).then(i=>this.#f(i)).finally(()=>this.#d());return}const s=document.createElement("input");s.type="file",s.accept=B.supportedTypesStr,this.#i=new Promise(t=>{s.addEventListener("change",async()=>{if(!s.files||s.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(s.files[0]);this.#f(i)}t()}),s.addEventListener("cancel",()=>{this.remove(),t()})}).finally(()=>this.#d()),s.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#r?.disconnect(),this.#r=null),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#u();return}super.rebuild(),this.div!==null&&(this.#e&&this.#u(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#s||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let s,t;if(this.width&&(s=this.x,t=this.y),super.render(),this.div.hidden=!0,this.#t?this.#p():this.#u(),this.width){const[i,u]=this.parentDimensions;this.setAt(s*i,t*u,this.width*i,this.height*u)}return this.div}#p(){const{div:s}=this;let{width:t,height:i}=this.#t;const[u,l]=this.pageDimensions,e=.75;if(this.width)t=this.width*u,i=this.height*l;else if(t>e*u||i>e*l){const y=Math.min(e*u/t,e*l/i);t*=y,i*=y}const[d,p]=this.parentDimensions;this.setDims(t*d/u,i*p/l),this._uiManager.enableWaiting(!1);const o=this.#a=document.createElement("canvas");s.append(o),s.hidden=!1,this.#g(t,i),this.#_(),this.#n||(this.parent.addUndoableEditor(this),this.#n=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#b(s,t){const[i,u]=this.parentDimensions;this.width=s/i,this.height=t/u,this.setDims(s,t),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#l!==null&&clearTimeout(this.#l);const l=200;this.#l=setTimeout(()=>{this.#l=null,this.#g(s,t)},l)}#m(s,t){const{width:i,height:u}=this.#t;let l=i,e=u,d=this.#t;for(;l>2*s||e>2*t;){const p=l,o=e;l>2*s&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),e>2*t&&(e=e>=16384?Math.floor(e/2)-1:Math.ceil(e/2));const y=new OffscreenCanvas(l,e);y.getContext("2d").drawImage(d,0,0,p,o,0,0,l,e),d=y.transferToImageBitmap()}return d}#g(s,t){s=Math.ceil(s),t=Math.ceil(t);const i=this.#a;if(!i||i.width===s&&i.height===t)return;i.width=s,i.height=t;const u=this.#c?this.#t:this.#m(s,t),l=i.getContext("2d");l.filter=this._uiManager.hcmFilter,l.drawImage(u,0,0,u.width,u.height,0,0,s,t)}#h(s){if(s){if(this.#c){const u=this._uiManager.imageManager.getSvgUrl(this.#e);if(u)return u}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#t,t.getContext("2d").drawImage(this.#t,0,0),t.toDataURL()}if(this.#c){const[t,i]=this.pageDimensions,u=Math.round(this.width*t*I.PixelsPerInch.PDF_TO_CSS_UNITS),l=Math.round(this.height*i*I.PixelsPerInch.PDF_TO_CSS_UNITS),e=new OffscreenCanvas(u,l);return e.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,u,l),e.transferToImageBitmap()}return structuredClone(this.#t)}#_(){this.#r=new ResizeObserver(s=>{const t=s[0].contentRect;t.width&&t.height&&this.#b(t.width,t.height)}),this.#r.observe(this.div)}static deserialize(s,t,i){if(s instanceof x.StampAnnotationElement)return null;const u=super.deserialize(s,t,i),{rect:l,bitmapUrl:e,bitmapId:d,isSvg:p,accessibilityData:o}=s;d&&i.imageManager.isValidId(d)?u.#e=d:u.#s=e,u.#c=p;const[y,M]=u.pageDimensions;return u.width=(l[2]-l[0])/y,u.height=(l[3]-l[1])/M,o&&(u.altTextData=o),u}serialize(s=!1,t=null){if(this.isEmpty())return null;const i={annotationType:a.AnnotationEditorType.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(s)return i.bitmapUrl=this.#h(!0),i.accessibilityData=this.altTextData,i;const{decorative:u,altText:l}=this.altTextData;if(!u&&l&&(i.accessibilityData={type:"Figure",alt:l}),t===null)return i;t.stamps||=new Map;const e=this.#c?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!t.stamps.has(this.#e))t.stamps.set(this.#e,{area:e,serialized:i}),i.bitmap=this.#h(!1);else if(this.#c){const d=t.stamps.get(this.#e);e>d.area&&(d.area=e,d.serialized.bitmap.close(),d.serialized.bitmap=this.#h(!1))}return i}}n.StampEditor=B})],__webpack_module_cache__={};function __w_pdfjs_require__(N){var n=__webpack_module_cache__[N];if(n!==void 0)return n.exports;var T=__webpack_module_cache__[N]={exports:{}};return __webpack_modules__[N](T,T.exports,__w_pdfjs_require__),T.exports}var __webpack_exports__={};return(()=>{var N=__webpack_exports__;Object.defineProperty(N,"__esModule",{value:!0}),Object.defineProperty(N,"AbortException",{enumerable:!0,get:function(){return n.AbortException}}),Object.defineProperty(N,"AnnotationEditorLayer",{enumerable:!0,get:function(){return I.AnnotationEditorLayer}}),Object.defineProperty(N,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return n.AnnotationEditorParamsType}}),Object.defineProperty(N,"AnnotationEditorType",{enumerable:!0,get:function(){return n.AnnotationEditorType}}),Object.defineProperty(N,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return x.AnnotationEditorUIManager}}),Object.defineProperty(N,"AnnotationLayer",{enumerable:!0,get:function(){return B.AnnotationLayer}}),Object.defineProperty(N,"AnnotationMode",{enumerable:!0,get:function(){return n.AnnotationMode}}),Object.defineProperty(N,"CMapCompressionType",{enumerable:!0,get:function(){return n.CMapCompressionType}}),Object.defineProperty(N,"DOMSVGFactory",{enumerable:!0,get:function(){return a.DOMSVGFactory}}),Object.defineProperty(N,"FeatureTest",{enumerable:!0,get:function(){return n.FeatureTest}}),Object.defineProperty(N,"GlobalWorkerOptions",{enumerable:!0,get:function(){return U.GlobalWorkerOptions}}),Object.defineProperty(N,"ImageKind",{enumerable:!0,get:function(){return n.ImageKind}}),Object.defineProperty(N,"InvalidPDFException",{enumerable:!0,get:function(){return n.InvalidPDFException}}),Object.defineProperty(N,"MissingPDFException",{enumerable:!0,get:function(){return n.MissingPDFException}}),Object.defineProperty(N,"OPS",{enumerable:!0,get:function(){return n.OPS}}),Object.defineProperty(N,"PDFDataRangeTransport",{enumerable:!0,get:function(){return T.PDFDataRangeTransport}}),Object.defineProperty(N,"PDFDateString",{enumerable:!0,get:function(){return a.PDFDateString}}),Object.defineProperty(N,"PDFWorker",{enumerable:!0,get:function(){return T.PDFWorker}}),Object.defineProperty(N,"PasswordResponses",{enumerable:!0,get:function(){return n.PasswordResponses}}),Object.defineProperty(N,"PermissionFlag",{enumerable:!0,get:function(){return n.PermissionFlag}}),Object.defineProperty(N,"PixelsPerInch",{enumerable:!0,get:function(){return a.PixelsPerInch}}),Object.defineProperty(N,"PromiseCapability",{enumerable:!0,get:function(){return n.PromiseCapability}}),Object.defineProperty(N,"RenderingCancelledException",{enumerable:!0,get:function(){return a.RenderingCancelledException}}),Object.defineProperty(N,"SVGGraphics",{enumerable:!0,get:function(){return T.SVGGraphics}}),Object.defineProperty(N,"UnexpectedResponseException",{enumerable:!0,get:function(){return n.UnexpectedResponseException}}),Object.defineProperty(N,"Util",{enumerable:!0,get:function(){return n.Util}}),Object.defineProperty(N,"VerbosityLevel",{enumerable:!0,get:function(){return n.VerbosityLevel}}),Object.defineProperty(N,"XfaLayer",{enumerable:!0,get:function(){return s.XfaLayer}}),Object.defineProperty(N,"build",{enumerable:!0,get:function(){return T.build}}),Object.defineProperty(N,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return n.createValidAbsoluteUrl}}),Object.defineProperty(N,"getDocument",{enumerable:!0,get:function(){return T.getDocument}}),Object.defineProperty(N,"getFilenameFromUrl",{enumerable:!0,get:function(){return a.getFilenameFromUrl}}),Object.defineProperty(N,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return a.getPdfFilenameFromUrl}}),Object.defineProperty(N,"getXfaPageViewport",{enumerable:!0,get:function(){return a.getXfaPageViewport}}),Object.defineProperty(N,"isDataScheme",{enumerable:!0,get:function(){return a.isDataScheme}}),Object.defineProperty(N,"isPdfFile",{enumerable:!0,get:function(){return a.isPdfFile}}),Object.defineProperty(N,"loadScript",{enumerable:!0,get:function(){return a.loadScript}}),Object.defineProperty(N,"noContextMenu",{enumerable:!0,get:function(){return a.noContextMenu}}),Object.defineProperty(N,"normalizeUnicode",{enumerable:!0,get:function(){return n.normalizeUnicode}}),Object.defineProperty(N,"renderTextLayer",{enumerable:!0,get:function(){return m.renderTextLayer}}),Object.defineProperty(N,"setLayerDimensions",{enumerable:!0,get:function(){return a.setLayerDimensions}}),Object.defineProperty(N,"shadow",{enumerable:!0,get:function(){return n.shadow}}),Object.defineProperty(N,"updateTextLayer",{enumerable:!0,get:function(){return m.updateTextLayer}}),Object.defineProperty(N,"version",{enumerable:!0,get:function(){return T.version}});var n=__w_pdfjs_require__(1),T=__w_pdfjs_require__(2),a=__w_pdfjs_require__(6),m=__w_pdfjs_require__(26),I=__w_pdfjs_require__(27),x=__w_pdfjs_require__(5),B=__w_pdfjs_require__(29),U=__w_pdfjs_require__(14),s=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$2)),pdf$2.exports}var pdfExports=requirePdf();const pdf=getDefaultExportFromCjs(pdfExports),pdf$1=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]);export{pdf$1 as p};
